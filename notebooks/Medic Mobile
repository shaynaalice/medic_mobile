{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Load Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from datetime import datetime\n",
    "from datetime import date\n",
    "import numpy as np\n",
    "\n",
    "HOME_PATH = '/Users/shaynaanderson-hill/medic_mobile/20190402-Data Scientist Interview Exercises Datasets/'\n",
    "\n",
    "#Load Datasets\n",
    "assessment_follow_up_df = pd.read_csv(\n",
    "    HOME_PATH + 'assessment_follow_up.csv',\n",
    "    header=0, \n",
    "    dtype={'width': int, 'column_name': str, 'variable_type': str}\n",
    ")\n",
    "\n",
    "assessments_df = pd.read_csv(\n",
    "    HOME_PATH + 'assessments.csv',\n",
    "    header=0, \n",
    "    dtype={'width': int, 'column_name': str, 'variable_type': str}\n",
    ")\n",
    "\n",
    "delivery_df = pd.read_csv(\n",
    "    HOME_PATH + 'delivery.csv',\n",
    "    header=0, \n",
    "    dtype={'width': int, 'column_name': str, 'variable_type': str}\n",
    ")\n",
    "\n",
    "family_survey_df = pd.read_csv(\n",
    "    HOME_PATH + 'family_survey.csv',\n",
    "    header=0, \n",
    "    dtype={'width': int, 'column_name': str, 'variable_type': str}\n",
    ")\n",
    "\n",
    "person_df = pd.read_csv(\n",
    "    HOME_PATH + 'person.csv',\n",
    "    header=0, \n",
    "    dtype={'width': int, 'column_name': str, 'variable_type': str}\n",
    ")\n",
    "\n",
    "pregnancy_df = pd.read_csv(\n",
    "    HOME_PATH + 'pregnancy.csv',\n",
    "    header=0, \n",
    "    dtype={'width': int, 'column_name': str, 'variable_type': str}\n",
    ")\n",
    "\n",
    "pregnancy_visit_df = pd.read_csv(\n",
    "    HOME_PATH + 'pregnancy_visit.csv',\n",
    "    header=0, \n",
    "    dtype={'width': int, 'column_name': str, 'variable_type': str}\n",
    ")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Rename Columns "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Add table prefixes to avoid confusion\n",
    "#person_df = person_df.add_prefix('person_')\n",
    "#family_survey_df = family_survey_df.add_prefix('family_survey_')\n",
    "assessments_df = assessments_df.add_prefix('assessment_')\n",
    "assessment_follow_up_df = assessment_follow_up_df.add_prefix('assessment_follow_up_')\n",
    "pregnancy_df = pregnancy_df.add_prefix('pregnancy_')\n",
    "pregnancy_visit_df = pregnancy_visit_df.add_prefix('pregnancy_visit_')\n",
    "delivery_df = delivery_df.add_prefix('delivery_')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "%%capture\n",
    "#Remove redundant prefixes\n",
    "\n",
    "assessments_df.rename(index=str, columns={'assessment_assessment_id': 'assessment_id', 'assessment_assessment_date_time_submitted': 'assessment_date_time_submitted'}, inplace=True) \n",
    "assessment_follow_up_df.rename(index=str, columns={'assessment_follow_up_assessment_follow_up_id': 'assessment_follow_up_id', 'assessment_follow_up_assessment_follow_up_date_time_submitted': 'assessment_follow_up_date_time_submitted'}, inplace=True) \n",
    "pregnancy_df.rename(index=str, columns={'pregnancy_pregnancy_form_id': 'pregnancy_form_id'}, inplace=True)\n",
    "pregnancy_visit_df.rename(index=str, columns={'pregnancy_visit_pregnancy_visit_form_id': 'pregnancy_visit_form_id'}, inplace=True) \n",
    "delivery_df.rename(index=str, columns={'delivery_delivery_id': 'delivery_id', 'delivery_delivery_date_time_submitted': 'delivery_date_time_submitted', 'delivery_facility_delivery': 'facility_delivery', 'delivery_danger_signs_at_delivery': 'danger_signs_at_delivery'}, inplace=True) \n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Converting Data Types"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Date of birth\n",
    "\n",
    "#Fix broken dates\n",
    "#Assumption: date_of_birth = '1007-10-08' is supposed to be '2007-10-08'\n",
    "person_df.loc[person_df.date_of_birth == '1007-10-08', 'date_of_birth'] = '2007-10-08'\n",
    "\n",
    "#Assumption: date_of_birth = '1563-11-04' is supposed to be '1963-11-04'\n",
    "person_df.loc[person_df.date_of_birth == '1563-11-04', 'date_of_birth'] = '1963-11-04'\n",
    "\n",
    "#Assumption: date_of_birth = '1263-12-05 is supposed to be '1963-12-05'\n",
    "person_df.loc[person_df.date_of_birth == '1263-12-05', 'date_of_birth'] = '1963-12-05'\n",
    "\n",
    "#convert date strings to date objects\n",
    "person_df['date_of_birth'] = pd.to_datetime(person_df['date_of_birth'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Last menstrual period\n",
    "pregnancy_df['pregnancy_last_menstrual_period_date'] = pd.to_datetime(pregnancy_df['pregnancy_last_menstrual_period_date'])\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Expected due date\n",
    "pregnancy_df['pregnancy_expected_due_date'] = pd.to_datetime(pregnancy_df['pregnancy_expected_due_date'])          \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Pregnancy registration submission\n",
    "#First remove timezone\n",
    "def remove_tz(date_str):\n",
    "    return str(date_str[:(date_str.find(\"T\"))])\n",
    "\n",
    "pregnancy_df['pregnancy_date_time_submitted'] = pregnancy_df['pregnancy_date_time_submitted'].apply(remove_tz)\n",
    "\n",
    "pregnancy_df['pregnancy_date_time_submitted'] = pd.to_datetime(pregnancy_df['pregnancy_date_time_submitted'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Pregnancy visit submission\n",
    "pregnancy_visit_df['pregnancy_visit_date_time_submitted'] = pregnancy_visit_df['pregnancy_visit_date_time_submitted'].apply(remove_tz)\n",
    "\n",
    "pregnancy_visit_df['pregnancy_visit_date_time_submitted'] = pd.to_datetime(pregnancy_visit_df['pregnancy_visit_date_time_submitted'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Delivery submission\n",
    "#Proxy for delivery date\n",
    "delivery_df['delivery_date_time_submitted'] = pd.to_datetime(delivery_df['delivery_date_time_submitted'])        \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Parse Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "#placeholder new data frame with split value columns \n",
    "new = pregnancy_df[\"pregnancy_risk_factors\"].str.split(\" \", n=6, expand = True) \n",
    "\n",
    "new[\"r1\"] = \"\"\n",
    "new[\"r2\"] = \"\"\n",
    "new[\"r3\"] = \"\"\n",
    "new[\"r4\"] = \"\"\n",
    "new[\"r5\"] = \"\"\n",
    "new[\"r6\"] = \"\"\n",
    "\n",
    "for index, row in new.iterrows():\n",
    "    if row[0] == 'r1' or row[1] == 'r1' or row[2] == 'r1' or row[3] == 'r1' or row[4] == 'r1' or row[5]=='r1':\n",
    "        row['r1'] = True\n",
    "    else: row['r1'] = False\n",
    "    if row[0] == 'r2' or row[1] == 'r2' or row[2] == 'r2' or row[3] == 'r2' or row[4] == 'r2' or row[5]=='r2':\n",
    "        row['r2'] = True\n",
    "    else: row['r2'] = False\n",
    "    if row[0] == 'r3' or row[1] == 'r3' or row[2] == 'r3' or row[3] == 'r3' or row[4] == 'r3' or row[5]=='r3':\n",
    "        row['r3'] = True\n",
    "    else: row['r3'] = False\n",
    "    if row[0] == 'r4' or row[1] == 'r4' or row[2] == 'r4' or row[3] == 'r4' or row[4] == 'r4' or row[5]=='r4':\n",
    "        row['r4'] = True\n",
    "    else: row['r4'] = False\n",
    "    if row[0] == 'r5' or row[1] == 'r5' or row[2] == 'r5' or row[3] == 'r5' or row[4] == 'r5' or row[5]=='r5':\n",
    "        row['r5'] = True\n",
    "    else: row['r5'] = False\n",
    "    if row[0] == 'r6' or row[1] == 'r6' or row[2] == 'r6' or row[3] == 'r6' or row[4] == 'r6' or row[5]=='r6':\n",
    "        row['r6'] = True\n",
    "    else: row['r6'] = False\n",
    "\n",
    "# making seperate risk factor columns from new data frame \n",
    "pregnancy_df[\"pregnancy_risk_factor_1\"]= new['r1'] \n",
    "pregnancy_df[\"pregnancy_risk_factor_2\"]= new['r2'] \n",
    "pregnancy_df[\"pregnancy_risk_factor_3\"]= new['r3'] \n",
    "pregnancy_df[\"pregnancy_risk_factor_4\"]= new['r4'] \n",
    "pregnancy_df[\"pregnancy_risk_factor_5\"]= new['r5']  \n",
    "pregnancy_df[\"pregnancy_risk_factor_6\"]= new['r6'] \n",
    "  \n",
    "# Dropping old Name columns \n",
    "#pregnancy_df.drop(columns =[\"pregnancy_risk_factors\"], inplace = True) \n",
    "  \n",
    "# df display \n",
    "#pregnancy_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "#placeholder new data frame with split value columns \n",
    "new = pregnancy_df[\"pregnancy_danger_signs\"].str.split(\" \", n=9, expand = True) \n",
    "\n",
    "new[\"d1\"] = \"\"\n",
    "new[\"d2\"] = \"\"\n",
    "new[\"d3\"] = \"\"\n",
    "new[\"d4\"] = \"\"\n",
    "new[\"d5\"] = \"\"\n",
    "new[\"d6\"] = \"\"\n",
    "new[\"d7\"] = \"\"\n",
    "new[\"d8\"] = \"\"\n",
    "new[\"d9\"] = \"\"\n",
    "\n",
    "for index, row in new.iterrows():\n",
    "    if row[0] == 'd1' or row[1] == 'd1' or row[2] == 'd1' or row[3] == 'd1' or row[4] == 'd1' or row[5]=='d1':\n",
    "        row['d1'] = True\n",
    "    else: row['d1'] = False\n",
    "    if row[0] == 'd2' or row[1] == 'd2' or row[2] == 'd2' or row[3] == 'd2' or row[4] == 'd2' or row[5]=='d2':\n",
    "        row['d2'] = True\n",
    "    else: row['d2'] = False\n",
    "    if row[0] == 'd3' or row[1] == 'd3' or row[2] == 'd3' or row[3] == 'd3' or row[4] == 'd3' or row[5]=='d3':\n",
    "        row['d3'] = True\n",
    "    else: row['d3'] = False\n",
    "    if row[0] == 'd4' or row[1] == 'd4' or row[2] == 'd4' or row[3] == 'd4' or row[4] == 'd4' or row[5]=='d4':\n",
    "        row['d4'] = True\n",
    "    else: row['d4'] = False\n",
    "    if row[0] == 'd5' or row[1] == 'd5' or row[2] == 'd5' or row[3] == 'd5' or row[4] == 'd5' or row[5]=='d5':\n",
    "        row['d5'] = True\n",
    "    else: row['d5'] = False\n",
    "    if row[0] == 'd6' or row[1] == 'd6' or row[2] == 'd6' or row[3] == 'd6' or row[4] == 'd6' or row[5]=='d6':\n",
    "        row['d6'] = True\n",
    "    else: row['d6'] = False\n",
    "    if row[0] == 'd7' or row[1] == 'd7' or row[2] == 'd7' or row[3] == 'd7' or row[4] == 'd7' or row[5]=='d7':\n",
    "        row['d7'] = True\n",
    "    else: row['d7'] = False\n",
    "    if row[0] == 'd8' or row[1] == 'd8' or row[2] == 'd8' or row[3] == 'd8' or row[4] == 'd8' or row[5]=='d8':\n",
    "        row['d8'] = True\n",
    "    else: row['d8'] = False\n",
    "    if row[0] == 'd9' or row[1] == 'd9' or row[2] == 'd9' or row[3] == 'd9' or row[4] == 'd9' or row[5]=='d9':\n",
    "        row['d9'] = True\n",
    "    else: row['d9'] = False\n",
    "\n",
    "# making seperate danger signs from new data frame \n",
    "pregnancy_df[\"pregnancy_danger_signs_1\"]= new['d1'] \n",
    "pregnancy_df[\"pregnancy_danger_signs_2\"]= new['d2'] \n",
    "pregnancy_df[\"pregnancy_danger_signs_3\"]= new['d3'] \n",
    "pregnancy_df[\"pregnancy_danger_signs_4\"]= new['d4'] \n",
    "pregnancy_df[\"pregnancy_danger_signs_5\"]= new['d5']  \n",
    "pregnancy_df[\"pregnancy_danger_signs_6\"]= new['d6']  \n",
    "pregnancy_df[\"pregnancy_danger_signs_7\"]= new['d7']  \n",
    "pregnancy_df[\"pregnancy_danger_signs_8\"]= new['d8'] \n",
    "pregnancy_df[\"pregnancy_danger_signs_9\"]= new['d9'] \n",
    "\n",
    "# Dropping old Name columns \n",
    "#pregnancy_df.drop(columns =[\"pregnancy_danger_signs\"], inplace = True) \n",
    "  \n",
    "# df display \n",
    "#pregnancy_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "#placeholder new data frame with split value columns \n",
    "new = pregnancy_visit_df[\"pregnancy_visit_danger_signs\"].str.split(\" \", n=9, expand = True) \n",
    "\n",
    "new[\"d1\"] = \"\"\n",
    "new[\"d2\"] = \"\"\n",
    "new[\"d3\"] = \"\"\n",
    "new[\"d4\"] = \"\"\n",
    "new[\"d5\"] = \"\"\n",
    "new[\"d6\"] = \"\"\n",
    "new[\"d7\"] = \"\"\n",
    "new[\"d8\"] = \"\"\n",
    "new[\"d9\"] = \"\"\n",
    "\n",
    "for index, row in new.iterrows():\n",
    "    if row[0] == 'd1' or row[1] == 'd1' or row[2] == 'd1' or row[3] == 'd1' or row[4] == 'd1' or row[5]=='d1':\n",
    "        row['d1'] = True\n",
    "    else: row['d1'] = False\n",
    "    if row[0] == 'd2' or row[1] == 'd2' or row[2] == 'd2' or row[3] == 'd2' or row[4] == 'd2' or row[5]=='d2':\n",
    "        row['d2'] = True\n",
    "    else: row['d2'] = False\n",
    "    if row[0] == 'd3' or row[1] == 'd3' or row[2] == 'd3' or row[3] == 'd3' or row[4] == 'd3' or row[5]=='d3':\n",
    "        row['d3'] = True\n",
    "    else: row['d3'] = False\n",
    "    if row[0] == 'd4' or row[1] == 'd4' or row[2] == 'd4' or row[3] == 'd4' or row[4] == 'd4' or row[5]=='d4':\n",
    "        row['d4'] = True\n",
    "    else: row['d4'] = False\n",
    "    if row[0] == 'd5' or row[1] == 'd5' or row[2] == 'd5' or row[3] == 'd5' or row[4] == 'd5' or row[5]=='d5':\n",
    "        row['d5'] = True\n",
    "    else: row['d5'] = False\n",
    "    if row[0] == 'd6' or row[1] == 'd6' or row[2] == 'd6' or row[3] == 'd6' or row[4] == 'd6' or row[5]=='d6':\n",
    "        row['d6'] = True\n",
    "    else: row['d6'] = False\n",
    "    if row[0] == 'd7' or row[1] == 'd7' or row[2] == 'd7' or row[3] == 'd7' or row[4] == 'd7' or row[5]=='d7':\n",
    "        row['d7'] = True\n",
    "    else: row['d7'] = False\n",
    "    if row[0] == 'd8' or row[1] == 'd8' or row[2] == 'd8' or row[3] == 'd8' or row[4] == 'd8' or row[5]=='d8':\n",
    "        row['d8'] = True\n",
    "    else: row['d8'] = False\n",
    "    if row[0] == 'd9' or row[1] == 'd9' or row[2] == 'd9' or row[3] == 'd9' or row[4] == 'd9' or row[5]=='d9':\n",
    "        row['d9'] = True\n",
    "    else: row['d9'] = False\n",
    "\n",
    "# making seperate danger signs from new data frame \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_1\"]= new['d1'] \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_2\"]= new['d2'] \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_3\"]= new['d3'] \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_4\"]= new['d4'] \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_5\"]= new['d5']  \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_6\"]= new['d6']  \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_7\"]= new['d7']  \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_8\"]= new['d8'] \n",
    "pregnancy_visit_df[\"pregnancy_visit_danger_signs_9\"]= new['d9'] \n",
    "\n",
    "# Dropping old Name columns \n",
    "#pregnancy_visit_df.drop(columns =[\"pregnancy_visit_danger_signs\"], inplace = True) \n",
    "  \n",
    "# df display \n",
    "#pregnancy_visit_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Missing Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>person_id</th>\n",
       "      <th>sex</th>\n",
       "      <th>date_of_birth</th>\n",
       "      <th>hh_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>909991</td>\n",
       "      <td>905551</td>\n",
       "      <td>908941</td>\n",
       "      <td>909979</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>909991</td>\n",
       "      <td>5</td>\n",
       "      <td>31345</td>\n",
       "      <td>227445</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>18f293b725fec8cbc524f053ec2ece5c</td>\n",
       "      <td>female</td>\n",
       "      <td>2014-08-28 00:00:00</td>\n",
       "      <td>d4906d1f2ebe160656766b5f1ecdca98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>495600</td>\n",
       "      <td>260</td>\n",
       "      <td>75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>first</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1684-12-08 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>last</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2066-02-06 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                               person_id     sex        date_of_birth  \\\n",
       "count                             909991  905551               908941   \n",
       "unique                            909991       5                31345   \n",
       "top     18f293b725fec8cbc524f053ec2ece5c  female  2014-08-28 00:00:00   \n",
       "freq                                   1  495600                  260   \n",
       "first                                NaN     NaN  1684-12-08 00:00:00   \n",
       "last                                 NaN     NaN  2066-02-06 00:00:00   \n",
       "\n",
       "                                   hh_id  \n",
       "count                             909979  \n",
       "unique                            227445  \n",
       "top     d4906d1f2ebe160656766b5f1ecdca98  \n",
       "freq                                  75  \n",
       "first                                NaN  \n",
       "last                                 NaN  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#person_df\n",
    "person_df.describe(include = 'all')\n",
    "# 12 people have missing households\n",
    "# 4,440 people are missing sex data\n",
    "# 1,050 are missing their date of birth\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "12 people have missing households,\n",
    "4,440 people are missing sex data,\n",
    "1,050 are missing their date of birth"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>hh_id</th>\n",
       "      <th>how_water_treated</th>\n",
       "      <th>has_mosquito_net</th>\n",
       "      <th>latrine</th>\n",
       "      <th>hand_washing_facilities</th>\n",
       "      <th>electricity</th>\n",
       "      <th>television</th>\n",
       "      <th>cupboard</th>\n",
       "      <th>dvd</th>\n",
       "      <th>radio</th>\n",
       "      <th>clock</th>\n",
       "      <th>floor</th>\n",
       "      <th>walls</th>\n",
       "      <th>roof</th>\n",
       "      <th>fuel</th>\n",
       "      <th>toilet</th>\n",
       "      <th>highest_education_achieved</th>\n",
       "      <th>wealth_quintile</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>207086</td>\n",
       "      <td>143080</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>207086</td>\n",
       "      <td>203210</td>\n",
       "      <td>207081.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>207086</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>f268bc92b9f8e53b43143461ed5cab49</td>\n",
       "      <td>aqua_tabs</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>some_primary</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>99043</td>\n",
       "      <td>182664</td>\n",
       "      <td>192964</td>\n",
       "      <td>103649</td>\n",
       "      <td>158335</td>\n",
       "      <td>156987</td>\n",
       "      <td>104129</td>\n",
       "      <td>175019</td>\n",
       "      <td>160636</td>\n",
       "      <td>172086</td>\n",
       "      <td>119968</td>\n",
       "      <td>129404</td>\n",
       "      <td>167786</td>\n",
       "      <td>180156</td>\n",
       "      <td>195529</td>\n",
       "      <td>71878</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.323593</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.322430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   hh_id how_water_treated has_mosquito_net  \\\n",
       "count                             207086            143080           207086   \n",
       "unique                            207086                 4                2   \n",
       "top     f268bc92b9f8e53b43143461ed5cab49         aqua_tabs              yes   \n",
       "freq                                   1             99043           182664   \n",
       "mean                                 NaN               NaN              NaN   \n",
       "std                                  NaN               NaN              NaN   \n",
       "min                                  NaN               NaN              NaN   \n",
       "25%                                  NaN               NaN              NaN   \n",
       "50%                                  NaN               NaN              NaN   \n",
       "75%                                  NaN               NaN              NaN   \n",
       "max                                  NaN               NaN              NaN   \n",
       "\n",
       "       latrine hand_washing_facilities electricity television cupboard  \\\n",
       "count   207086                  207086      207086     207086   207086   \n",
       "unique       2                       2           2          2        2   \n",
       "top        yes                     yes          no         no       no   \n",
       "freq    192964                  103649      158335     156987   104129   \n",
       "mean       NaN                     NaN         NaN        NaN      NaN   \n",
       "std        NaN                     NaN         NaN        NaN      NaN   \n",
       "min        NaN                     NaN         NaN        NaN      NaN   \n",
       "25%        NaN                     NaN         NaN        NaN      NaN   \n",
       "50%        NaN                     NaN         NaN        NaN      NaN   \n",
       "75%        NaN                     NaN         NaN        NaN      NaN   \n",
       "max        NaN                     NaN         NaN        NaN      NaN   \n",
       "\n",
       "           dvd   radio   clock       floor         walls        roof    fuel  \\\n",
       "count   207086  207086  207086      207086        207086      207086  207086   \n",
       "unique       2       2       2           3             2           2       3   \n",
       "top         no     yes      no  earth_sand  dung_mud_sod  roof_other    wood   \n",
       "freq    175019  160636  172086      119968        129404      167786  180156   \n",
       "mean       NaN     NaN     NaN         NaN           NaN         NaN     NaN   \n",
       "std        NaN     NaN     NaN         NaN           NaN         NaN     NaN   \n",
       "min        NaN     NaN     NaN         NaN           NaN         NaN     NaN   \n",
       "25%        NaN     NaN     NaN         NaN           NaN         NaN     NaN   \n",
       "50%        NaN     NaN     NaN         NaN           NaN         NaN     NaN   \n",
       "75%        NaN     NaN     NaN         NaN           NaN         NaN     NaN   \n",
       "max        NaN     NaN     NaN         NaN           NaN         NaN     NaN   \n",
       "\n",
       "              toilet highest_education_achieved  wealth_quintile  \n",
       "count         207086                     203210    207081.000000  \n",
       "unique             2                          6              NaN  \n",
       "top     toilet_other               some_primary              NaN  \n",
       "freq          195529                      71878              NaN  \n",
       "mean             NaN                        NaN         2.323593  \n",
       "std              NaN                        NaN         1.322430  \n",
       "min              NaN                        NaN         1.000000  \n",
       "25%              NaN                        NaN         1.000000  \n",
       "50%              NaN                        NaN         2.000000  \n",
       "75%              NaN                        NaN         3.000000  \n",
       "max              NaN                        NaN         5.000000  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#family_survey_df\n",
    "family_survey_df.describe(include = 'all')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We have missing data for 'highest_education_achieved' and 'how_water_treated'."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_form_id</th>\n",
       "      <th>pregnancy_chw_id</th>\n",
       "      <th>pregnancy_date_time_submitted</th>\n",
       "      <th>pregnancy_patient_id</th>\n",
       "      <th>pregnancy_hh_id</th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_last_menstrual_period_date</th>\n",
       "      <th>pregnancy_expected_due_date</th>\n",
       "      <th>pregnancy_danger_signs</th>\n",
       "      <th>pregnancy_risk_factors</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_risk_factor_6</th>\n",
       "      <th>pregnancy_danger_signs_1</th>\n",
       "      <th>pregnancy_danger_signs_2</th>\n",
       "      <th>pregnancy_danger_signs_3</th>\n",
       "      <th>pregnancy_danger_signs_4</th>\n",
       "      <th>pregnancy_danger_signs_5</th>\n",
       "      <th>pregnancy_danger_signs_6</th>\n",
       "      <th>pregnancy_danger_signs_7</th>\n",
       "      <th>pregnancy_danger_signs_8</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>46636.000000</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>6129</td>\n",
       "      <td>9709</td>\n",
       "      <td>...</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>49245</td>\n",
       "      <td>2121</td>\n",
       "      <td>1150</td>\n",
       "      <td>46840</td>\n",
       "      <td>45145</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1251</td>\n",
       "      <td>1249</td>\n",
       "      <td>223</td>\n",
       "      <td>63</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>3264996cfe42c44a4ad123eea9ef6d7f</td>\n",
       "      <td>ab07d474a2de074098e74e6f0aab529f</td>\n",
       "      <td>2017-03-08 00:00:00</td>\n",
       "      <td>edf62a43a415eb5ef1ffb75f43146b16</td>\n",
       "      <td>3aa3a19d166ab44e905ab1e86e068b34</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2018-02-28 00:00:00</td>\n",
       "      <td>2018-12-04 00:00:00</td>\n",
       "      <td>d1</td>\n",
       "      <td>r1</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>244</td>\n",
       "      <td>161</td>\n",
       "      <td>10</td>\n",
       "      <td>13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>172</td>\n",
       "      <td>171</td>\n",
       "      <td>1817</td>\n",
       "      <td>4465</td>\n",
       "      <td>...</td>\n",
       "      <td>48854</td>\n",
       "      <td>46488</td>\n",
       "      <td>48778</td>\n",
       "      <td>48227</td>\n",
       "      <td>48907</td>\n",
       "      <td>47709</td>\n",
       "      <td>48757</td>\n",
       "      <td>49129</td>\n",
       "      <td>48907</td>\n",
       "      <td>49119</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>first</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2009-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2008-05-02 00:00:00</td>\n",
       "      <td>2009-02-05 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>last</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2019-04-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2019-03-19 00:00:00</td>\n",
       "      <td>2019-12-23 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25.052470</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.484784</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>24.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>63.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>13 rows Ã— 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                       pregnancy_form_id                  pregnancy_chw_id  \\\n",
       "count                              49245                             49245   \n",
       "unique                             49245                              2121   \n",
       "top     3264996cfe42c44a4ad123eea9ef6d7f  ab07d474a2de074098e74e6f0aab529f   \n",
       "freq                                   1                               244   \n",
       "first                                NaN                               NaN   \n",
       "last                                 NaN                               NaN   \n",
       "mean                                 NaN                               NaN   \n",
       "std                                  NaN                               NaN   \n",
       "min                                  NaN                               NaN   \n",
       "25%                                  NaN                               NaN   \n",
       "50%                                  NaN                               NaN   \n",
       "75%                                  NaN                               NaN   \n",
       "max                                  NaN                               NaN   \n",
       "\n",
       "       pregnancy_date_time_submitted              pregnancy_patient_id  \\\n",
       "count                          49245                             49245   \n",
       "unique                          1150                             46840   \n",
       "top              2017-03-08 00:00:00  edf62a43a415eb5ef1ffb75f43146b16   \n",
       "freq                             161                                10   \n",
       "first            2009-01-01 00:00:00                               NaN   \n",
       "last             2019-04-01 00:00:00                               NaN   \n",
       "mean                             NaN                               NaN   \n",
       "std                              NaN                               NaN   \n",
       "min                              NaN                               NaN   \n",
       "25%                              NaN                               NaN   \n",
       "50%                              NaN                               NaN   \n",
       "75%                              NaN                               NaN   \n",
       "max                              NaN                               NaN   \n",
       "\n",
       "                         pregnancy_hh_id  pregnancy_patient_age_in_years  \\\n",
       "count                              49245                    46636.000000   \n",
       "unique                             45145                             NaN   \n",
       "top     3aa3a19d166ab44e905ab1e86e068b34                             NaN   \n",
       "freq                                  13                             NaN   \n",
       "first                                NaN                             NaN   \n",
       "last                                 NaN                             NaN   \n",
       "mean                                 NaN                       25.052470   \n",
       "std                                  NaN                        6.484784   \n",
       "min                                  NaN                       -1.000000   \n",
       "25%                                  NaN                       20.000000   \n",
       "50%                                  NaN                       24.000000   \n",
       "75%                                  NaN                       29.000000   \n",
       "max                                  NaN                       63.000000   \n",
       "\n",
       "       pregnancy_last_menstrual_period_date pregnancy_expected_due_date  \\\n",
       "count                                 49245                       49245   \n",
       "unique                                 1251                        1249   \n",
       "top                     2018-02-28 00:00:00         2018-12-04 00:00:00   \n",
       "freq                                    172                         171   \n",
       "first                   2008-05-02 00:00:00         2009-02-05 00:00:00   \n",
       "last                    2019-03-19 00:00:00         2019-12-23 00:00:00   \n",
       "mean                                    NaN                         NaN   \n",
       "std                                     NaN                         NaN   \n",
       "min                                     NaN                         NaN   \n",
       "25%                                     NaN                         NaN   \n",
       "50%                                     NaN                         NaN   \n",
       "75%                                     NaN                         NaN   \n",
       "max                                     NaN                         NaN   \n",
       "\n",
       "       pregnancy_danger_signs pregnancy_risk_factors  ...  \\\n",
       "count                    6129                   9709  ...   \n",
       "unique                    223                     63  ...   \n",
       "top                        d1                     r1  ...   \n",
       "freq                     1817                   4465  ...   \n",
       "first                     NaN                    NaN  ...   \n",
       "last                      NaN                    NaN  ...   \n",
       "mean                      NaN                    NaN  ...   \n",
       "std                       NaN                    NaN  ...   \n",
       "min                       NaN                    NaN  ...   \n",
       "25%                       NaN                    NaN  ...   \n",
       "50%                       NaN                    NaN  ...   \n",
       "75%                       NaN                    NaN  ...   \n",
       "max                       NaN                    NaN  ...   \n",
       "\n",
       "       pregnancy_risk_factor_6 pregnancy_danger_signs_1  \\\n",
       "count                    49245                    49245   \n",
       "unique                       2                        2   \n",
       "top                      False                    False   \n",
       "freq                     48854                    46488   \n",
       "first                      NaN                      NaN   \n",
       "last                       NaN                      NaN   \n",
       "mean                       NaN                      NaN   \n",
       "std                        NaN                      NaN   \n",
       "min                        NaN                      NaN   \n",
       "25%                        NaN                      NaN   \n",
       "50%                        NaN                      NaN   \n",
       "75%                        NaN                      NaN   \n",
       "max                        NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_2 pregnancy_danger_signs_3  \\\n",
       "count                     49245                    49245   \n",
       "unique                        2                        2   \n",
       "top                       False                    False   \n",
       "freq                      48778                    48227   \n",
       "first                       NaN                      NaN   \n",
       "last                        NaN                      NaN   \n",
       "mean                        NaN                      NaN   \n",
       "std                         NaN                      NaN   \n",
       "min                         NaN                      NaN   \n",
       "25%                         NaN                      NaN   \n",
       "50%                         NaN                      NaN   \n",
       "75%                         NaN                      NaN   \n",
       "max                         NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_4 pregnancy_danger_signs_5  \\\n",
       "count                     49245                    49245   \n",
       "unique                        2                        2   \n",
       "top                       False                    False   \n",
       "freq                      48907                    47709   \n",
       "first                       NaN                      NaN   \n",
       "last                        NaN                      NaN   \n",
       "mean                        NaN                      NaN   \n",
       "std                         NaN                      NaN   \n",
       "min                         NaN                      NaN   \n",
       "25%                         NaN                      NaN   \n",
       "50%                         NaN                      NaN   \n",
       "75%                         NaN                      NaN   \n",
       "max                         NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_6 pregnancy_danger_signs_7  \\\n",
       "count                     49245                    49245   \n",
       "unique                        2                        2   \n",
       "top                       False                    False   \n",
       "freq                      48757                    49129   \n",
       "first                       NaN                      NaN   \n",
       "last                        NaN                      NaN   \n",
       "mean                        NaN                      NaN   \n",
       "std                         NaN                      NaN   \n",
       "min                         NaN                      NaN   \n",
       "25%                         NaN                      NaN   \n",
       "50%                         NaN                      NaN   \n",
       "75%                         NaN                      NaN   \n",
       "max                         NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_8 pregnancy_danger_signs_9  \n",
       "count                     49245                    49245  \n",
       "unique                        2                        2  \n",
       "top                       False                    False  \n",
       "freq                      48907                    49119  \n",
       "first                       NaN                      NaN  \n",
       "last                        NaN                      NaN  \n",
       "mean                        NaN                      NaN  \n",
       "std                         NaN                      NaN  \n",
       "min                         NaN                      NaN  \n",
       "25%                         NaN                      NaN  \n",
       "50%                         NaN                      NaN  \n",
       "75%                         NaN                      NaN  \n",
       "max                         NaN                      NaN  \n",
       "\n",
       "[13 rows x 25 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#pregnancy_df\n",
    "pregnancy_df.describe(include = 'all')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We have missing data for pregnancy_patient_age_in_years. Also for pregnancy_danger_signs and pregnancy_risk factors, but these will be dropped later in place of the dummy variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_visit_form_id</th>\n",
       "      <th>pregnancy_visit_chw_id</th>\n",
       "      <th>pregnancy_visit_date_time_submitted</th>\n",
       "      <th>pregnancy_visit_patient_id</th>\n",
       "      <th>pregnancy_visit_hh_id</th>\n",
       "      <th>pregnancy_visit_how_visit_conducted</th>\n",
       "      <th>pregnancy_visit_referred_to_health_facility</th>\n",
       "      <th>pregnancy_visit_danger_signs</th>\n",
       "      <th>pregnancy_visit_danger_signs_1</th>\n",
       "      <th>pregnancy_visit_danger_signs_2</th>\n",
       "      <th>pregnancy_visit_danger_signs_3</th>\n",
       "      <th>pregnancy_visit_danger_signs_4</th>\n",
       "      <th>pregnancy_visit_danger_signs_5</th>\n",
       "      <th>pregnancy_visit_danger_signs_6</th>\n",
       "      <th>pregnancy_visit_danger_signs_7</th>\n",
       "      <th>pregnancy_visit_danger_signs_8</th>\n",
       "      <th>pregnancy_visit_danger_signs_9</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>4536</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "      <td>138638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>138638</td>\n",
       "      <td>2082</td>\n",
       "      <td>919</td>\n",
       "      <td>39803</td>\n",
       "      <td>38510</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>124</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>52d8791a7306f92d59ceab752edf9fd3</td>\n",
       "      <td>ab07d474a2de074098e74e6f0aab529f</td>\n",
       "      <td>2018-10-17 00:00:00</td>\n",
       "      <td>d3e4e26e3b579617aad151038f5857b7</td>\n",
       "      <td>abdc224a6508f1d83dce037224626a8a</td>\n",
       "      <td>in_person</td>\n",
       "      <td>False</td>\n",
       "      <td>d1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>950</td>\n",
       "      <td>330</td>\n",
       "      <td>28</td>\n",
       "      <td>43</td>\n",
       "      <td>120656</td>\n",
       "      <td>134102</td>\n",
       "      <td>1390</td>\n",
       "      <td>136795</td>\n",
       "      <td>138184</td>\n",
       "      <td>138099</td>\n",
       "      <td>138291</td>\n",
       "      <td>137635</td>\n",
       "      <td>138072</td>\n",
       "      <td>138232</td>\n",
       "      <td>138406</td>\n",
       "      <td>138487</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>first</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2009-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>last</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2019-05-10 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 pregnancy_visit_form_id            pregnancy_visit_chw_id  \\\n",
       "count                             138638                            138638   \n",
       "unique                            138638                              2082   \n",
       "top     52d8791a7306f92d59ceab752edf9fd3  ab07d474a2de074098e74e6f0aab529f   \n",
       "freq                                   1                               950   \n",
       "first                                NaN                               NaN   \n",
       "last                                 NaN                               NaN   \n",
       "\n",
       "       pregnancy_visit_date_time_submitted        pregnancy_visit_patient_id  \\\n",
       "count                               138638                            138638   \n",
       "unique                                 919                             39803   \n",
       "top                    2018-10-17 00:00:00  d3e4e26e3b579617aad151038f5857b7   \n",
       "freq                                   330                                28   \n",
       "first                  2009-01-01 00:00:00                               NaN   \n",
       "last                   2019-05-10 00:00:00                               NaN   \n",
       "\n",
       "                   pregnancy_visit_hh_id pregnancy_visit_how_visit_conducted  \\\n",
       "count                             138638                              138638   \n",
       "unique                             38510                                   2   \n",
       "top     abdc224a6508f1d83dce037224626a8a                           in_person   \n",
       "freq                                  43                              120656   \n",
       "first                                NaN                                 NaN   \n",
       "last                                 NaN                                 NaN   \n",
       "\n",
       "       pregnancy_visit_referred_to_health_facility  \\\n",
       "count                                       138638   \n",
       "unique                                           2   \n",
       "top                                          False   \n",
       "freq                                        134102   \n",
       "first                                          NaN   \n",
       "last                                           NaN   \n",
       "\n",
       "       pregnancy_visit_danger_signs pregnancy_visit_danger_signs_1  \\\n",
       "count                          4536                         138638   \n",
       "unique                          124                              2   \n",
       "top                              d1                          False   \n",
       "freq                           1390                         136795   \n",
       "first                           NaN                            NaN   \n",
       "last                            NaN                            NaN   \n",
       "\n",
       "       pregnancy_visit_danger_signs_2 pregnancy_visit_danger_signs_3  \\\n",
       "count                          138638                         138638   \n",
       "unique                              2                              2   \n",
       "top                             False                          False   \n",
       "freq                           138184                         138099   \n",
       "first                             NaN                            NaN   \n",
       "last                              NaN                            NaN   \n",
       "\n",
       "       pregnancy_visit_danger_signs_4 pregnancy_visit_danger_signs_5  \\\n",
       "count                          138638                         138638   \n",
       "unique                              2                              2   \n",
       "top                             False                          False   \n",
       "freq                           138291                         137635   \n",
       "first                             NaN                            NaN   \n",
       "last                              NaN                            NaN   \n",
       "\n",
       "       pregnancy_visit_danger_signs_6 pregnancy_visit_danger_signs_7  \\\n",
       "count                          138638                         138638   \n",
       "unique                              2                              2   \n",
       "top                             False                          False   \n",
       "freq                           138072                         138232   \n",
       "first                             NaN                            NaN   \n",
       "last                              NaN                            NaN   \n",
       "\n",
       "       pregnancy_visit_danger_signs_8 pregnancy_visit_danger_signs_9  \n",
       "count                          138638                         138638  \n",
       "unique                              2                              2  \n",
       "top                             False                          False  \n",
       "freq                           138406                         138487  \n",
       "first                             NaN                            NaN  \n",
       "last                              NaN                            NaN  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#pregnancy_visit_df\n",
    "pregnancy_visit_df.describe(include = 'all')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Missing pregnancy_visit_danger_signs has been converted to dummy variables and will be dropped later. A missing value for a danger sign means no danger sign was recorded."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>delivery_id</th>\n",
       "      <th>delivery_chw_id</th>\n",
       "      <th>delivery_date_time_submitted</th>\n",
       "      <th>delivery_patient_id</th>\n",
       "      <th>delivery_hh_id</th>\n",
       "      <th>facility_delivery</th>\n",
       "      <th>danger_signs_at_delivery</th>\n",
       "      <th>delivery_first_visit_on_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>32465</td>\n",
       "      <td>32465</td>\n",
       "      <td>32465</td>\n",
       "      <td>32465</td>\n",
       "      <td>32465</td>\n",
       "      <td>32465</td>\n",
       "      <td>24110</td>\n",
       "      <td>32465</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>32465</td>\n",
       "      <td>2039</td>\n",
       "      <td>32454</td>\n",
       "      <td>32465</td>\n",
       "      <td>31120</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>488d2f33ef9e5c0743b696e9de1926bd</td>\n",
       "      <td>ab07d474a2de074098e74e6f0aab529f</td>\n",
       "      <td>2018-09-07 11:28:57+00:00</td>\n",
       "      <td>3da9deb6f8aeab0dd7315fe96397cad8</td>\n",
       "      <td>8f6fab250dcef99cb742c0c83efa9b43</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>125</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>28200</td>\n",
       "      <td>23531</td>\n",
       "      <td>30635</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>first</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2009-01-07 05:40:31+00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>last</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2019-04-01 18:21:21+00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                             delivery_id                   delivery_chw_id  \\\n",
       "count                              32465                             32465   \n",
       "unique                             32465                              2039   \n",
       "top     488d2f33ef9e5c0743b696e9de1926bd  ab07d474a2de074098e74e6f0aab529f   \n",
       "freq                                   1                               125   \n",
       "first                                NaN                               NaN   \n",
       "last                                 NaN                               NaN   \n",
       "\n",
       "       delivery_date_time_submitted               delivery_patient_id  \\\n",
       "count                         32465                             32465   \n",
       "unique                        32454                             32465   \n",
       "top       2018-09-07 11:28:57+00:00  3da9deb6f8aeab0dd7315fe96397cad8   \n",
       "freq                              2                                 1   \n",
       "first     2009-01-07 05:40:31+00:00                               NaN   \n",
       "last      2019-04-01 18:21:21+00:00                               NaN   \n",
       "\n",
       "                          delivery_hh_id facility_delivery  \\\n",
       "count                              32465             32465   \n",
       "unique                             31120                 2   \n",
       "top     8f6fab250dcef99cb742c0c83efa9b43              True   \n",
       "freq                                   6             28200   \n",
       "first                                NaN               NaN   \n",
       "last                                 NaN               NaN   \n",
       "\n",
       "       danger_signs_at_delivery delivery_first_visit_on_time  \n",
       "count                     24110                        32465  \n",
       "unique                        2                            2  \n",
       "top                       False                         True  \n",
       "freq                      23531                        30635  \n",
       "first                       NaN                          NaN  \n",
       "last                        NaN                          NaN  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#delivery_df\n",
    "delivery_df.describe(include = 'all')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We have missing values for danger_signs_at_delivery which is a potential outcome variable. Could it be the case that missing danger signs at delivery means there were not danger signs at delivery? Can we follow up with someone in the field? Otherwise, we need to investigate whether or not missing danger_signs_at_delivery is random. It is plausible to imagine that missing danger signs at delivery is caused by understaffing, if this is the case, then it is not independent. Removing observations with missing danger_signs_at_delivery would bias our data and reduce the accuracy of future predictions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "delivery_id                     1104\n",
       "delivery_chw_id                 1104\n",
       "delivery_date_time_submitted    1104\n",
       "delivery_patient_id             1104\n",
       "delivery_hh_id                  1104\n",
       "facility_delivery               1104\n",
       "danger_signs_at_delivery           0\n",
       "delivery_first_visit_on_time    1104\n",
       "dtype: int64"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Investigate possible missingness function - \n",
    "#Is danger signs at delivery missingness predicted by facility_delivery?\n",
    "missing_delivery_danger = delivery_df[delivery_df['danger_signs_at_delivery'].isnull()]\n",
    "\n",
    "#Initial investigation of missingness mechanism\n",
    "missing_delivery_danger[missing_delivery_danger['facility_delivery'] == False].count()\n",
    "#missing delivery danger signs does not seem to be a function of whether or not the delivery happened at a healthcare facilityf\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Missing delivery danger signs does not seem to be a function of whether or not the delivery happened at a healthcare facility.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Handle Missing Data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "I am of the camp that missing data is rarely missing at random. For this reason, to either impute the mean/median or drop missing observations, introduces bias. Missingness is informative and thus my strategy for handling missing data is to create missing flags. For categorical data, this means adding a category \"missing\" and for numerical data this means, imputing a '0' or other value and creating a missing flag."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "family_survey_df['how_water_treated'].fillna('missing', inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "family_survey_df['highest_education_achieved'].fillna('missing', inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([16., 27., 32., 28., 25., 23., 22., 31., 26., 33., 17., 20., 30.,\n",
       "       38., 19., 18., 36., 21., 24., 29., 34., 37., 35., 42., 44., 13.,\n",
       "       39., 40., 14., 41., 11., 48.,  0., 15., 49., 47., 10., 45., nan,\n",
       "       43., 46., 12., 50., 63., -1., 51.,  3., 52.])"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_df['pregnancy_patient_age_in_years'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_form_id</th>\n",
       "      <th>pregnancy_chw_id</th>\n",
       "      <th>pregnancy_date_time_submitted</th>\n",
       "      <th>pregnancy_patient_id</th>\n",
       "      <th>pregnancy_hh_id</th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_last_menstrual_period_date</th>\n",
       "      <th>pregnancy_expected_due_date</th>\n",
       "      <th>pregnancy_danger_signs</th>\n",
       "      <th>pregnancy_risk_factors</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_risk_factor_6</th>\n",
       "      <th>pregnancy_danger_signs_1</th>\n",
       "      <th>pregnancy_danger_signs_2</th>\n",
       "      <th>pregnancy_danger_signs_3</th>\n",
       "      <th>pregnancy_danger_signs_4</th>\n",
       "      <th>pregnancy_danger_signs_5</th>\n",
       "      <th>pregnancy_danger_signs_6</th>\n",
       "      <th>pregnancy_danger_signs_7</th>\n",
       "      <th>pregnancy_danger_signs_8</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>23375</th>\n",
       "      <td>a513486f0aae056a371ad76a8980054f</td>\n",
       "      <td>e5189d6f0d372c3a977c1657352b1e75</td>\n",
       "      <td>2017-12-12</td>\n",
       "      <td>85d8066eb38549e78610e037b8477ee5</td>\n",
       "      <td>340fcc00a79c5effcafaa0e0f7c2e833</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>2017-12-01</td>\n",
       "      <td>2018-09-06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1 rows Ã— 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                      pregnancy_form_id                  pregnancy_chw_id  \\\n",
       "23375  a513486f0aae056a371ad76a8980054f  e5189d6f0d372c3a977c1657352b1e75   \n",
       "\n",
       "      pregnancy_date_time_submitted              pregnancy_patient_id  \\\n",
       "23375                    2017-12-12  85d8066eb38549e78610e037b8477ee5   \n",
       "\n",
       "                        pregnancy_hh_id  pregnancy_patient_age_in_years  \\\n",
       "23375  340fcc00a79c5effcafaa0e0f7c2e833                            -1.0   \n",
       "\n",
       "      pregnancy_last_menstrual_period_date pregnancy_expected_due_date  \\\n",
       "23375                           2017-12-01                  2018-09-06   \n",
       "\n",
       "      pregnancy_danger_signs pregnancy_risk_factors  ...  \\\n",
       "23375                    NaN                    NaN  ...   \n",
       "\n",
       "      pregnancy_risk_factor_6 pregnancy_danger_signs_1  \\\n",
       "23375                   False                    False   \n",
       "\n",
       "      pregnancy_danger_signs_2 pregnancy_danger_signs_3  \\\n",
       "23375                    False                    False   \n",
       "\n",
       "      pregnancy_danger_signs_4 pregnancy_danger_signs_5  \\\n",
       "23375                    False                    False   \n",
       "\n",
       "      pregnancy_danger_signs_6 pregnancy_danger_signs_7  \\\n",
       "23375                    False                    False   \n",
       "\n",
       "      pregnancy_danger_signs_8 pregnancy_danger_signs_9  \n",
       "23375                    False                    False  \n",
       "\n",
       "[1 rows x 25 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_df[pregnancy_df['pregnancy_patient_age_in_years']== -1]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In my opinion, a patient age of '-1' is a missing value."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "pregnancy_df.loc[pregnancy_df.pregnancy_patient_id == '85d8066eb38549e78610e037b8477ee5', 'pregnancy_patient_age_in_years'] = np.nan"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([16., 27., 32., 28., 25., 23., 22., 31., 26., 33., 17., 20., 30.,\n",
       "       38., 19., 18., 36., 21., 24., 29., 34., 37., 35., 42., 44., 13.,\n",
       "       39., 40., 14., 41., 11., 48.,  0., 15., 49., 47., 10., 45., nan,\n",
       "       43., 46., 12., 50., 63., 51.,  3., 52.])"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_df['pregnancy_patient_age_in_years'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Impute average patient_age_in_years for missing data\n",
    "#pregnancy_df['pregnancy_patient_age_in_years'].fillna((pregnancy_df['pregnancy_patient_age_in_years'].mean()), inplace=True)\n",
    "\n",
    "#Impute zeros for missing data\n",
    "pregnancy_df['pregnancy_patient_age_in_years'].fillna(0, inplace=True)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_form_id</th>\n",
       "      <th>pregnancy_chw_id</th>\n",
       "      <th>pregnancy_date_time_submitted</th>\n",
       "      <th>pregnancy_patient_id</th>\n",
       "      <th>pregnancy_hh_id</th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_last_menstrual_period_date</th>\n",
       "      <th>pregnancy_expected_due_date</th>\n",
       "      <th>pregnancy_danger_signs</th>\n",
       "      <th>pregnancy_risk_factors</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_danger_signs_1</th>\n",
       "      <th>pregnancy_danger_signs_2</th>\n",
       "      <th>pregnancy_danger_signs_3</th>\n",
       "      <th>pregnancy_danger_signs_4</th>\n",
       "      <th>pregnancy_danger_signs_5</th>\n",
       "      <th>pregnancy_danger_signs_6</th>\n",
       "      <th>pregnancy_danger_signs_7</th>\n",
       "      <th>pregnancy_danger_signs_8</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "      <th>age_missing</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>fb4419f66aec81237d8f87c4ff0054a3</td>\n",
       "      <td>7f2d25199eef813addb4d9f783b3e075</td>\n",
       "      <td>2018-02-06</td>\n",
       "      <td>97a5f299f3254a998a3bca0ad11a154d</td>\n",
       "      <td>11d7a4f38fafa7954ce0752a1343e168</td>\n",
       "      <td>16.0</td>\n",
       "      <td>2017-08-07</td>\n",
       "      <td>2018-05-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>60cee26693654bcdee37558c3efe79f8</td>\n",
       "      <td>82b888a09920a91a193b60fa68605243</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>9769f2af62e82eb5bc661520a03739e5</td>\n",
       "      <td>2d3975a66c2fd5ec4653d151c025ba17</td>\n",
       "      <td>27.0</td>\n",
       "      <td>2017-07-29</td>\n",
       "      <td>2018-05-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>49776d9ba5b39fd209880c29cf30f10b</td>\n",
       "      <td>44d0a969dea0b117cf8eee9c671da1e1</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>669a826b66e0615d3d5be61ea3c789f1</td>\n",
       "      <td>8085e6eee84c56353fcb12a324e4f0ec</td>\n",
       "      <td>32.0</td>\n",
       "      <td>2017-12-21</td>\n",
       "      <td>2018-09-26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>73fbadf1c54c15e4d733e80899bd5a60</td>\n",
       "      <td>0296ee306ec54e31cdd661859e4a32ef</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>34b484a85a48ed5441c5b09de6867306</td>\n",
       "      <td>0f01fd8cf6d363411725243842b8315d</td>\n",
       "      <td>28.0</td>\n",
       "      <td>2017-08-08</td>\n",
       "      <td>2018-05-14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>46f237f3890d2e9e37cb6b0e7fb0edc3</td>\n",
       "      <td>a3abfd66e17a0e3a1303dcb3bfb937d1</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>c697f1476734d3b8782c6288a2aaf478</td>\n",
       "      <td>d4d73db5620f13202fdb7edd0c5c21c9</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2017-12-08</td>\n",
       "      <td>2018-09-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  pregnancy_form_id                  pregnancy_chw_id  \\\n",
       "0  fb4419f66aec81237d8f87c4ff0054a3  7f2d25199eef813addb4d9f783b3e075   \n",
       "1  60cee26693654bcdee37558c3efe79f8  82b888a09920a91a193b60fa68605243   \n",
       "2  49776d9ba5b39fd209880c29cf30f10b  44d0a969dea0b117cf8eee9c671da1e1   \n",
       "3  73fbadf1c54c15e4d733e80899bd5a60  0296ee306ec54e31cdd661859e4a32ef   \n",
       "4  46f237f3890d2e9e37cb6b0e7fb0edc3  a3abfd66e17a0e3a1303dcb3bfb937d1   \n",
       "\n",
       "  pregnancy_date_time_submitted              pregnancy_patient_id  \\\n",
       "0                    2018-02-06  97a5f299f3254a998a3bca0ad11a154d   \n",
       "1                    2018-02-07  9769f2af62e82eb5bc661520a03739e5   \n",
       "2                    2018-02-07  669a826b66e0615d3d5be61ea3c789f1   \n",
       "3                    2018-02-07  34b484a85a48ed5441c5b09de6867306   \n",
       "4                    2018-02-07  c697f1476734d3b8782c6288a2aaf478   \n",
       "\n",
       "                    pregnancy_hh_id  pregnancy_patient_age_in_years  \\\n",
       "0  11d7a4f38fafa7954ce0752a1343e168                            16.0   \n",
       "1  2d3975a66c2fd5ec4653d151c025ba17                            27.0   \n",
       "2  8085e6eee84c56353fcb12a324e4f0ec                            32.0   \n",
       "3  0f01fd8cf6d363411725243842b8315d                            28.0   \n",
       "4  d4d73db5620f13202fdb7edd0c5c21c9                            25.0   \n",
       "\n",
       "  pregnancy_last_menstrual_period_date pregnancy_expected_due_date  \\\n",
       "0                           2017-08-07                  2018-05-13   \n",
       "1                           2017-07-29                  2018-05-04   \n",
       "2                           2017-12-21                  2018-09-26   \n",
       "3                           2017-08-08                  2018-05-14   \n",
       "4                           2017-12-08                  2018-09-13   \n",
       "\n",
       "  pregnancy_danger_signs pregnancy_risk_factors  ... pregnancy_danger_signs_1  \\\n",
       "0                    NaN                    NaN  ...                    False   \n",
       "1                    NaN                    NaN  ...                    False   \n",
       "2                    NaN                    NaN  ...                    False   \n",
       "3                    NaN                    NaN  ...                    False   \n",
       "4                    NaN                    NaN  ...                    False   \n",
       "\n",
       "  pregnancy_danger_signs_2 pregnancy_danger_signs_3 pregnancy_danger_signs_4  \\\n",
       "0                    False                    False                    False   \n",
       "1                    False                    False                    False   \n",
       "2                    False                    False                    False   \n",
       "3                    False                    False                    False   \n",
       "4                    False                    False                    False   \n",
       "\n",
       "  pregnancy_danger_signs_5 pregnancy_danger_signs_6 pregnancy_danger_signs_7  \\\n",
       "0                    False                    False                    False   \n",
       "1                    False                    False                    False   \n",
       "2                    False                    False                    False   \n",
       "3                    False                    False                    False   \n",
       "4                    False                    False                    False   \n",
       "\n",
       "  pregnancy_danger_signs_8 pregnancy_danger_signs_9 age_missing  \n",
       "0                    False                    False       False  \n",
       "1                    False                    False       False  \n",
       "2                    False                    False       False  \n",
       "3                    False                    False       False  \n",
       "4                    False                    False       False  \n",
       "\n",
       "[5 rows x 26 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Create dummy missingness variable\n",
    "pregnancy_df['age_missing'] = pregnancy_df['pregnancy_patient_age_in_years'].isnull()\n",
    "\n",
    "pregnancy_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_form_id</th>\n",
       "      <th>pregnancy_chw_id</th>\n",
       "      <th>pregnancy_date_time_submitted</th>\n",
       "      <th>pregnancy_patient_id</th>\n",
       "      <th>pregnancy_hh_id</th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_last_menstrual_period_date</th>\n",
       "      <th>pregnancy_expected_due_date</th>\n",
       "      <th>pregnancy_danger_signs</th>\n",
       "      <th>pregnancy_risk_factors</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_danger_signs_1</th>\n",
       "      <th>pregnancy_danger_signs_2</th>\n",
       "      <th>pregnancy_danger_signs_3</th>\n",
       "      <th>pregnancy_danger_signs_4</th>\n",
       "      <th>pregnancy_danger_signs_5</th>\n",
       "      <th>pregnancy_danger_signs_6</th>\n",
       "      <th>pregnancy_danger_signs_7</th>\n",
       "      <th>pregnancy_danger_signs_8</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "      <th>age_missing</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245.000000</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>6129</td>\n",
       "      <td>9709</td>\n",
       "      <td>...</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "      <td>49245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>49245</td>\n",
       "      <td>2121</td>\n",
       "      <td>1150</td>\n",
       "      <td>46840</td>\n",
       "      <td>45145</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1251</td>\n",
       "      <td>1249</td>\n",
       "      <td>223</td>\n",
       "      <td>63</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>3264996cfe42c44a4ad123eea9ef6d7f</td>\n",
       "      <td>ab07d474a2de074098e74e6f0aab529f</td>\n",
       "      <td>2017-03-08 00:00:00</td>\n",
       "      <td>edf62a43a415eb5ef1ffb75f43146b16</td>\n",
       "      <td>3aa3a19d166ab44e905ab1e86e068b34</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2018-02-28 00:00:00</td>\n",
       "      <td>2018-12-04 00:00:00</td>\n",
       "      <td>d1</td>\n",
       "      <td>r1</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>244</td>\n",
       "      <td>161</td>\n",
       "      <td>10</td>\n",
       "      <td>13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>172</td>\n",
       "      <td>171</td>\n",
       "      <td>1817</td>\n",
       "      <td>4465</td>\n",
       "      <td>...</td>\n",
       "      <td>46488</td>\n",
       "      <td>48778</td>\n",
       "      <td>48227</td>\n",
       "      <td>48907</td>\n",
       "      <td>47709</td>\n",
       "      <td>48757</td>\n",
       "      <td>49129</td>\n",
       "      <td>48907</td>\n",
       "      <td>49119</td>\n",
       "      <td>49245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>first</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2009-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2008-05-02 00:00:00</td>\n",
       "      <td>2009-02-05 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>last</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2019-04-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2019-03-19 00:00:00</td>\n",
       "      <td>2019-12-23 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>23.725211</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8.444765</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>24.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>63.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>13 rows Ã— 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                       pregnancy_form_id                  pregnancy_chw_id  \\\n",
       "count                              49245                             49245   \n",
       "unique                             49245                              2121   \n",
       "top     3264996cfe42c44a4ad123eea9ef6d7f  ab07d474a2de074098e74e6f0aab529f   \n",
       "freq                                   1                               244   \n",
       "first                                NaN                               NaN   \n",
       "last                                 NaN                               NaN   \n",
       "mean                                 NaN                               NaN   \n",
       "std                                  NaN                               NaN   \n",
       "min                                  NaN                               NaN   \n",
       "25%                                  NaN                               NaN   \n",
       "50%                                  NaN                               NaN   \n",
       "75%                                  NaN                               NaN   \n",
       "max                                  NaN                               NaN   \n",
       "\n",
       "       pregnancy_date_time_submitted              pregnancy_patient_id  \\\n",
       "count                          49245                             49245   \n",
       "unique                          1150                             46840   \n",
       "top              2017-03-08 00:00:00  edf62a43a415eb5ef1ffb75f43146b16   \n",
       "freq                             161                                10   \n",
       "first            2009-01-01 00:00:00                               NaN   \n",
       "last             2019-04-01 00:00:00                               NaN   \n",
       "mean                             NaN                               NaN   \n",
       "std                              NaN                               NaN   \n",
       "min                              NaN                               NaN   \n",
       "25%                              NaN                               NaN   \n",
       "50%                              NaN                               NaN   \n",
       "75%                              NaN                               NaN   \n",
       "max                              NaN                               NaN   \n",
       "\n",
       "                         pregnancy_hh_id  pregnancy_patient_age_in_years  \\\n",
       "count                              49245                    49245.000000   \n",
       "unique                             45145                             NaN   \n",
       "top     3aa3a19d166ab44e905ab1e86e068b34                             NaN   \n",
       "freq                                  13                             NaN   \n",
       "first                                NaN                             NaN   \n",
       "last                                 NaN                             NaN   \n",
       "mean                                 NaN                       23.725211   \n",
       "std                                  NaN                        8.444765   \n",
       "min                                  NaN                        0.000000   \n",
       "25%                                  NaN                       20.000000   \n",
       "50%                                  NaN                       24.000000   \n",
       "75%                                  NaN                       29.000000   \n",
       "max                                  NaN                       63.000000   \n",
       "\n",
       "       pregnancy_last_menstrual_period_date pregnancy_expected_due_date  \\\n",
       "count                                 49245                       49245   \n",
       "unique                                 1251                        1249   \n",
       "top                     2018-02-28 00:00:00         2018-12-04 00:00:00   \n",
       "freq                                    172                         171   \n",
       "first                   2008-05-02 00:00:00         2009-02-05 00:00:00   \n",
       "last                    2019-03-19 00:00:00         2019-12-23 00:00:00   \n",
       "mean                                    NaN                         NaN   \n",
       "std                                     NaN                         NaN   \n",
       "min                                     NaN                         NaN   \n",
       "25%                                     NaN                         NaN   \n",
       "50%                                     NaN                         NaN   \n",
       "75%                                     NaN                         NaN   \n",
       "max                                     NaN                         NaN   \n",
       "\n",
       "       pregnancy_danger_signs pregnancy_risk_factors  ...  \\\n",
       "count                    6129                   9709  ...   \n",
       "unique                    223                     63  ...   \n",
       "top                        d1                     r1  ...   \n",
       "freq                     1817                   4465  ...   \n",
       "first                     NaN                    NaN  ...   \n",
       "last                      NaN                    NaN  ...   \n",
       "mean                      NaN                    NaN  ...   \n",
       "std                       NaN                    NaN  ...   \n",
       "min                       NaN                    NaN  ...   \n",
       "25%                       NaN                    NaN  ...   \n",
       "50%                       NaN                    NaN  ...   \n",
       "75%                       NaN                    NaN  ...   \n",
       "max                       NaN                    NaN  ...   \n",
       "\n",
       "       pregnancy_danger_signs_1 pregnancy_danger_signs_2  \\\n",
       "count                     49245                    49245   \n",
       "unique                        2                        2   \n",
       "top                       False                    False   \n",
       "freq                      46488                    48778   \n",
       "first                       NaN                      NaN   \n",
       "last                        NaN                      NaN   \n",
       "mean                        NaN                      NaN   \n",
       "std                         NaN                      NaN   \n",
       "min                         NaN                      NaN   \n",
       "25%                         NaN                      NaN   \n",
       "50%                         NaN                      NaN   \n",
       "75%                         NaN                      NaN   \n",
       "max                         NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_3 pregnancy_danger_signs_4  \\\n",
       "count                     49245                    49245   \n",
       "unique                        2                        2   \n",
       "top                       False                    False   \n",
       "freq                      48227                    48907   \n",
       "first                       NaN                      NaN   \n",
       "last                        NaN                      NaN   \n",
       "mean                        NaN                      NaN   \n",
       "std                         NaN                      NaN   \n",
       "min                         NaN                      NaN   \n",
       "25%                         NaN                      NaN   \n",
       "50%                         NaN                      NaN   \n",
       "75%                         NaN                      NaN   \n",
       "max                         NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_5 pregnancy_danger_signs_6  \\\n",
       "count                     49245                    49245   \n",
       "unique                        2                        2   \n",
       "top                       False                    False   \n",
       "freq                      47709                    48757   \n",
       "first                       NaN                      NaN   \n",
       "last                        NaN                      NaN   \n",
       "mean                        NaN                      NaN   \n",
       "std                         NaN                      NaN   \n",
       "min                         NaN                      NaN   \n",
       "25%                         NaN                      NaN   \n",
       "50%                         NaN                      NaN   \n",
       "75%                         NaN                      NaN   \n",
       "max                         NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_7 pregnancy_danger_signs_8  \\\n",
       "count                     49245                    49245   \n",
       "unique                        2                        2   \n",
       "top                       False                    False   \n",
       "freq                      49129                    48907   \n",
       "first                       NaN                      NaN   \n",
       "last                        NaN                      NaN   \n",
       "mean                        NaN                      NaN   \n",
       "std                         NaN                      NaN   \n",
       "min                         NaN                      NaN   \n",
       "25%                         NaN                      NaN   \n",
       "50%                         NaN                      NaN   \n",
       "75%                         NaN                      NaN   \n",
       "max                         NaN                      NaN   \n",
       "\n",
       "       pregnancy_danger_signs_9 age_missing  \n",
       "count                     49245       49245  \n",
       "unique                        2           1  \n",
       "top                       False       False  \n",
       "freq                      49119       49245  \n",
       "first                       NaN         NaN  \n",
       "last                        NaN         NaN  \n",
       "mean                        NaN         NaN  \n",
       "std                         NaN         NaN  \n",
       "min                         NaN         NaN  \n",
       "25%                         NaN         NaN  \n",
       "50%                         NaN         NaN  \n",
       "75%                         NaN         NaN  \n",
       "max                         NaN         NaN  \n",
       "\n",
       "[13 rows x 26 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Check\n",
    "pregnancy_df.describe(include = 'all')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Explore Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[<matplotlib.axes._subplots.AxesSubplot object at 0x1103152e8>]],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#demographics\n",
    "\n",
    "household_size = person_df.groupby('hh_id')['person_id'].nunique().reset_index(name=\"household_size\")\n",
    "#household_size.max()\n",
    "#household_size.mean()\n",
    "#household_size.median()\n",
    "hist = household_size.hist(bins=70)\n",
    "hist\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "We have 909991people in our dataset\n"
     ]
    }
   ],
   "source": [
    "print('We have ' + str(person_df['person_id'].nunique()) + 'people in our dataset')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "We have 227445households in our dataset\n"
     ]
    }
   ],
   "source": [
    "print('We have ' + str(person_df['hh_id'].nunique()) + 'households in our dataset')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "We have 207086household survey data\n"
     ]
    }
   ],
   "source": [
    "#family survey\n",
    "\n",
    "print('We have ' + str(family_survey_df['hh_id'].nunique()) + 'household survey data')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "hh_id                         182664\n",
       "how_water_treated             182664\n",
       "has_mosquito_net              182664\n",
       "latrine                       182664\n",
       "hand_washing_facilities       182664\n",
       "electricity                   182664\n",
       "television                    182664\n",
       "cupboard                      182664\n",
       "dvd                           182664\n",
       "radio                         182664\n",
       "clock                         182664\n",
       "floor                         182664\n",
       "walls                         182664\n",
       "roof                          182664\n",
       "fuel                          182664\n",
       "toilet                        182664\n",
       "highest_education_achieved    182664\n",
       "wealth_quintile               182659\n",
       "dtype: int64"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "family_survey_df[family_survey_df['has_mosquito_net'] == 'yes'].count()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "hh_id                         103649\n",
       "how_water_treated             103649\n",
       "has_mosquito_net              103649\n",
       "latrine                       103649\n",
       "hand_washing_facilities       103649\n",
       "electricity                   103649\n",
       "television                    103649\n",
       "cupboard                      103649\n",
       "dvd                           103649\n",
       "radio                         103649\n",
       "clock                         103649\n",
       "floor                         103649\n",
       "walls                         103649\n",
       "roof                          103649\n",
       "fuel                          103649\n",
       "toilet                        103649\n",
       "highest_education_achieved    103649\n",
       "wealth_quintile               103646\n",
       "dtype: int64"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "family_survey_df[family_survey_df['hand_washing_facilities'] == 'yes'].count()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "hh_id                         192964\n",
       "how_water_treated             192964\n",
       "has_mosquito_net              192964\n",
       "latrine                       192964\n",
       "hand_washing_facilities       192964\n",
       "electricity                   192964\n",
       "television                    192964\n",
       "cupboard                      192964\n",
       "dvd                           192964\n",
       "radio                         192964\n",
       "clock                         192964\n",
       "floor                         192964\n",
       "walls                         192964\n",
       "roof                          192964\n",
       "fuel                          192964\n",
       "toilet                        192964\n",
       "highest_education_achieved    192964\n",
       "wealth_quintile               192959\n",
       "dtype: int64"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "family_survey_df[family_survey_df['latrine'] == 'yes'].count()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "hh_id                         48751\n",
       "how_water_treated             48751\n",
       "has_mosquito_net              48751\n",
       "latrine                       48751\n",
       "hand_washing_facilities       48751\n",
       "electricity                   48751\n",
       "television                    48751\n",
       "cupboard                      48751\n",
       "dvd                           48751\n",
       "radio                         48751\n",
       "clock                         48751\n",
       "floor                         48751\n",
       "walls                         48751\n",
       "roof                          48751\n",
       "fuel                          48751\n",
       "toilet                        48751\n",
       "highest_education_achieved    48751\n",
       "wealth_quintile               48749\n",
       "dtype: int64"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "family_survey_df[family_survey_df['electricity'] == 'yes'].count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "hh_id                         50099\n",
       "how_water_treated             50099\n",
       "has_mosquito_net              50099\n",
       "latrine                       50099\n",
       "hand_washing_facilities       50099\n",
       "electricity                   50099\n",
       "television                    50099\n",
       "cupboard                      50099\n",
       "dvd                           50099\n",
       "radio                         50099\n",
       "clock                         50099\n",
       "floor                         50099\n",
       "walls                         50099\n",
       "roof                          50099\n",
       "fuel                          50099\n",
       "toilet                        50099\n",
       "highest_education_achieved    50099\n",
       "wealth_quintile               50097\n",
       "dtype: int64"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "family_survey_df[family_survey_df['television'] == 'yes'].count()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 49245 registered pregnancies in our dataset\n"
     ]
    }
   ],
   "source": [
    "#Count registered pregnancies\n",
    "\n",
    "print('There are ' + str(pregnancy_df['pregnancy_form_id'].nunique()) + ' registered pregnancies in our dataset')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 46840 women with registered pregnancies in our dataset\n"
     ]
    }
   ],
   "source": [
    "# Count pregnant women\n",
    "\n",
    "print('There are ' + str(pregnancy_df['pregnancy_patient_id'].nunique()) + ' women with registered pregnancies in our dataset')\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Since there is no pregnancy_id, there is a bit of difficulty involved in joining the pregnancy registration data \n",
    "to the delivery data. We can use the patient_id, but since one patient can have multiple pregnancies and multiple\n",
    "deliveries, we do not know for sure that a given pregnancy registration corresponds to a given delivery.\n",
    "\n",
    "There are ways to help mediate this, by trying to link a pregnancy registration with a delivery by using a timeframe\n",
    "around the approximated due date, but this is not foolproof\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1 max deliveries per patient\n",
      "10 max pregnancy registrations per pateient\n"
     ]
    }
   ],
   "source": [
    "#To see how much this could affect our analysis, let's see for how many women, have multiple deliveries\n",
    "print(str(delivery_df.groupby('delivery_patient_id')['delivery_id'].nunique().max()) + ' max deliveries per patient')\n",
    "\n",
    "#For pregnancy registrations?\n",
    "print(str(pregnancy_df.groupby('pregnancy_patient_id')['pregnancy_form_id'].nunique().max()) + ' max pregnancy registrations per pateient')\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Interesting... there is only one delivery per patient, but a patient can have 10 pregnancy registrations\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[<matplotlib.axes._subplots.AxesSubplot object at 0x122022cc0>]],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "pregnancy_counts = pregnancy_df.groupby('pregnancy_patient_id')['pregnancy_form_id'].nunique().reset_index(name=\"count\")\n",
    "\n",
    "hist = pregnancy_counts.hist(bins=9)\n",
    "hist\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "44675 of the 46840 patients only have one pregnancy (95%)\n",
    " "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "One time-saving option is to limit our analysis to only those patients who have a single pregnancy registration, \n",
    "but this may introduce bias. This also doesn't guarantee the that the delivery outcome is the one associated with \n",
    "the pregnancy registration.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "39803"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Count pregnancy visit patients\n",
    "\n",
    "pregnancy_visit_df['pregnancy_visit_patient_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "138638"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Count pregnancy visits\n",
    "\n",
    "pregnancy_visit_df['pregnancy_visit_form_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "39776"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Create pregnancy reg pregnancy visit df\n",
    "pregnancy_reg_pregnancy_visit_df = pd.merge(pregnancy_df, pregnancy_visit_df,  how='inner', left_on=['pregnancy_patient_id','pregnancy_hh_id'], right_on = ['pregnancy_visit_patient_id','pregnancy_visit_hh_id'])\n",
    "\n",
    "pregnancy_reg_pregnancy_visit_df.head()\n",
    "\n",
    "mutual_patients = pregnancy_reg_pregnancy_visit_df[pregnancy_reg_pregnancy_visit_df['pregnancy_patient_id'] == pregnancy_reg_pregnancy_visit_df['pregnancy_patient_id']]\n",
    "mutual_patients['pregnancy_patient_id'].nunique()\n",
    "#mutual_patients['pregnancy_visit_patient_id'].nunique()\n",
    "\n",
    "#"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Create Pregnancy Visit Counts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Maximum number of pregnancy visits for a single patient is 28\n",
      "The average number of pregnancy visits for a single patient is 3.4831042886214605\n",
      "The median number of pregnancy visits for a single patient is 3.0\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[<matplotlib.axes._subplots.AxesSubplot object at 0x10bad0b00>]],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Again, without a pregnancy_id, we are unable to reliably match pregnancy visits to a pregnancy or a delivery, \n",
    "#if the patient has more than one pregnancy\n",
    "pregnancy_visit_counts = pregnancy_visit_df.groupby('pregnancy_visit_patient_id')['pregnancy_visit_form_id'].nunique().reset_index(name=\"visit_count\")\n",
    "\n",
    "print('Maximum number of pregnancy visits for a single patient is ' + str(pregnancy_visit_counts['visit_count'].max()))\n",
    "print('The average number of pregnancy visits for a single patient is ' + str(pregnancy_visit_counts['visit_count'].mean()))\n",
    "print('The median number of pregnancy visits for a single patient is ' + str(pregnancy_visit_counts['visit_count'].median()))\n",
    "hist = pregnancy_visit_counts.hist(bins=28)\n",
    "hist\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "23642"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#How many patients had 3 or more pregnancy visits\n",
    "more_visits = pd.DataFrame(pregnancy_visit_counts[pregnancy_visit_counts['visit_count'] >= 3])\n",
    "\n",
    "more_visits['pregnancy_visit_patient_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "32465"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Deliveries\n",
    "\n",
    "delivery_df['delivery_patient_id'].nunique()\n",
    "delivery_df['delivery_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2639"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#How many patients have delivery data who do not have registered pregnancy data\n",
    "\n",
    "missing_reg = set(delivery_df['delivery_patient_id']) - set(pregnancy_df['pregnancy_patient_id'])\n",
    "len(missing_reg)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "28200"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#How many patients had their delivery at a health facility\n",
    "\n",
    "facility_deliveries = delivery_df[delivery_df['facility_delivery']==True]\n",
    "facility_deliveries['delivery_patient_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "579"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Ho many patients had danger signs at delivery?\n",
    "\n",
    "delivery_danger = delivery_df[delivery_df['danger_signs_at_delivery']==True]\n",
    "delivery_danger['delivery_patient_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "30635"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#How many patients had an on-time postnatal visit?\n",
    "\n",
    "postnatal = delivery_df[delivery_df['delivery_first_visit_on_time']==True]\n",
    "postnatal['delivery_patient_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "37"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Of the patients who had danger signs at delivery, how many did not have an on-time postnatal visit?\n",
    "risky_late = set(delivery_danger['delivery_patient_id']) - set(postnatal['delivery_patient_id'])\n",
    "len(risky_late)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "55"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#workforce\n",
    "\n",
    "delivery_df['delivery_chw_id'].nunique() #2039\n",
    "pregnancy_visit_df['pregnancy_visit_chw_id'].nunique() #2082\n",
    "\n",
    "#How many chws only do pregnancy visits and not deliveries?\n",
    "chw_preg_visit_only = set(pregnancy_visit_df['pregnancy_visit_chw_id'])- set(delivery_df['delivery_chw_id'])\n",
    "len(chw_preg_visit_only)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 17014 patients with a pregnancy registration who do not have a delivery outcome.\n",
      "There are 2639 patients with a delivery outcome who do not have a pregnancy registration.\n"
     ]
    }
   ],
   "source": [
    "#How many patients with a pregnancy registration do not have a delivery outcome?\n",
    "print('There are ' + str(len(set(set(pregnancy_df['pregnancy_patient_id']) - set(delivery_df['delivery_patient_id'])))) + ' patients with a pregnancy registration who do not have a delivery outcome.')\n",
    "\n",
    "#Do not have a pregnancy registration?\n",
    "print('There are ' + str(len(set(set(delivery_df['delivery_patient_id']) - set(pregnancy_df['pregnancy_patient_id'])))) + ' patients with a delivery outcome who do not have a pregnancy registration.')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Check for multicollinearity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Is it true that all pregnancy visits with danger signs are referred to a health facility?\n",
    "\n",
    "danger_visit =  pregnancy_visit_df[pregnancy_visit_df['pregnancy_visit_danger_signs'].notnull()]\n",
    "danger_visit['pregnancy_visit_form_id'].nunique() #4536\n",
    "\n",
    "not_referred = danger_visit[danger_visit['pregnancy_visit_referred_to_health_facility']==False]\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Every pregnancy visit that has any danger signs is automatically referred to a health facility. This means we can't include both pregnancy_visit_danger_signs and pregnancy_visit_referred_to_health_facility in our model."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Delivery Response Data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For reference: Sample size rule of thumb (Peduzzi)\n",
    "Let p be the smallest of the proportions of negative or positive cases in the population and \n",
    "k the number of covariates (the number of independent variables), then the minimum number of cases to include is:\n",
    "N = 10 k / p\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "danger_signs_at_delivery\n",
      "False    23531\n",
      "True       579\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "#Delivery Outcomes\n",
    "#danger_signs_at_delivery\n",
    "print(delivery_df.groupby('danger_signs_at_delivery').size())\n",
    "#24110"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "facility_delivery\n",
      "False     4265\n",
      "True     28200\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "#facility_delivery\n",
    "print(delivery_df.groupby('facility_delivery').size())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "delivery_first_visit_on_time\n",
      "False     1830\n",
      "True     30635\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "#first_visit_on_time\n",
    "print(delivery_df.groupby('delivery_first_visit_on_time').size())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Aggregate Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Our population will be those patients who had a pregnancy registration, delivery danger signs data, family survey, and household"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "#subset delivery data\n",
    "\n",
    "has_delivery_data = delivery_df[delivery_df['danger_signs_at_delivery'].notnull()]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Join pregnancy and delivery data\n",
    "\n",
    "pregnancy_delivery_df = pd.merge(pregnancy_df, has_delivery_data, how='inner', left_on=['pregnancy_patient_id','pregnancy_hh_id'], right_on = ['delivery_patient_id','delivery_hh_id'])\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "22155"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_df['delivery_patient_id'].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_form_id</th>\n",
       "      <th>pregnancy_chw_id</th>\n",
       "      <th>pregnancy_date_time_submitted</th>\n",
       "      <th>pregnancy_patient_id</th>\n",
       "      <th>pregnancy_hh_id</th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_last_menstrual_period_date</th>\n",
       "      <th>pregnancy_expected_due_date</th>\n",
       "      <th>pregnancy_danger_signs</th>\n",
       "      <th>pregnancy_risk_factors</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "      <th>age_missing</th>\n",
       "      <th>delivery_id</th>\n",
       "      <th>delivery_chw_id</th>\n",
       "      <th>delivery_date_time_submitted</th>\n",
       "      <th>delivery_patient_id</th>\n",
       "      <th>delivery_hh_id</th>\n",
       "      <th>facility_delivery</th>\n",
       "      <th>danger_signs_at_delivery</th>\n",
       "      <th>delivery_first_visit_on_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>fb4419f66aec81237d8f87c4ff0054a3</td>\n",
       "      <td>7f2d25199eef813addb4d9f783b3e075</td>\n",
       "      <td>2018-02-06</td>\n",
       "      <td>97a5f299f3254a998a3bca0ad11a154d</td>\n",
       "      <td>11d7a4f38fafa7954ce0752a1343e168</td>\n",
       "      <td>16.0</td>\n",
       "      <td>2017-08-07</td>\n",
       "      <td>2018-05-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>f5562a92c91af04ba249ea11cca6f735</td>\n",
       "      <td>7f2d25199eef813addb4d9f783b3e075</td>\n",
       "      <td>2018-03-03 08:06:41+00:00</td>\n",
       "      <td>97a5f299f3254a998a3bca0ad11a154d</td>\n",
       "      <td>11d7a4f38fafa7954ce0752a1343e168</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>60cee26693654bcdee37558c3efe79f8</td>\n",
       "      <td>82b888a09920a91a193b60fa68605243</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>9769f2af62e82eb5bc661520a03739e5</td>\n",
       "      <td>2d3975a66c2fd5ec4653d151c025ba17</td>\n",
       "      <td>27.0</td>\n",
       "      <td>2017-07-29</td>\n",
       "      <td>2018-05-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>8d3616481a1ef21f4f6ab6a20c602a5d</td>\n",
       "      <td>82b888a09920a91a193b60fa68605243</td>\n",
       "      <td>2018-04-27 03:43:39+00:00</td>\n",
       "      <td>9769f2af62e82eb5bc661520a03739e5</td>\n",
       "      <td>2d3975a66c2fd5ec4653d151c025ba17</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>73fbadf1c54c15e4d733e80899bd5a60</td>\n",
       "      <td>0296ee306ec54e31cdd661859e4a32ef</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>34b484a85a48ed5441c5b09de6867306</td>\n",
       "      <td>0f01fd8cf6d363411725243842b8315d</td>\n",
       "      <td>28.0</td>\n",
       "      <td>2017-08-08</td>\n",
       "      <td>2018-05-14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>6c2d0a4fc1224364215906d3a815cb43</td>\n",
       "      <td>0296ee306ec54e31cdd661859e4a32ef</td>\n",
       "      <td>2018-07-18 14:57:11+00:00</td>\n",
       "      <td>34b484a85a48ed5441c5b09de6867306</td>\n",
       "      <td>0f01fd8cf6d363411725243842b8315d</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>46f237f3890d2e9e37cb6b0e7fb0edc3</td>\n",
       "      <td>a3abfd66e17a0e3a1303dcb3bfb937d1</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>c697f1476734d3b8782c6288a2aaf478</td>\n",
       "      <td>d4d73db5620f13202fdb7edd0c5c21c9</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2017-12-08</td>\n",
       "      <td>2018-09-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>09006aac17fd54a94965895938dc5d19</td>\n",
       "      <td>a3abfd66e17a0e3a1303dcb3bfb937d1</td>\n",
       "      <td>2018-08-17 13:49:58+00:00</td>\n",
       "      <td>c697f1476734d3b8782c6288a2aaf478</td>\n",
       "      <td>d4d73db5620f13202fdb7edd0c5c21c9</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>339e3fe85597e9f3af8910b410d096a4</td>\n",
       "      <td>8073c889d7526c6482820636bb0efb9e</td>\n",
       "      <td>2018-02-01</td>\n",
       "      <td>53414d387e87b6d4fe6c96e56f920488</td>\n",
       "      <td>978bba69e9454c353431f73ae69b787b</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2017-08-02</td>\n",
       "      <td>2018-05-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>r1</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>35d9d3459a2bc34de632d979d7b4cc9f</td>\n",
       "      <td>8073c889d7526c6482820636bb0efb9e</td>\n",
       "      <td>2018-05-06 07:05:54+00:00</td>\n",
       "      <td>53414d387e87b6d4fe6c96e56f920488</td>\n",
       "      <td>978bba69e9454c353431f73ae69b787b</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  pregnancy_form_id                  pregnancy_chw_id  \\\n",
       "0  fb4419f66aec81237d8f87c4ff0054a3  7f2d25199eef813addb4d9f783b3e075   \n",
       "1  60cee26693654bcdee37558c3efe79f8  82b888a09920a91a193b60fa68605243   \n",
       "2  73fbadf1c54c15e4d733e80899bd5a60  0296ee306ec54e31cdd661859e4a32ef   \n",
       "3  46f237f3890d2e9e37cb6b0e7fb0edc3  a3abfd66e17a0e3a1303dcb3bfb937d1   \n",
       "4  339e3fe85597e9f3af8910b410d096a4  8073c889d7526c6482820636bb0efb9e   \n",
       "\n",
       "  pregnancy_date_time_submitted              pregnancy_patient_id  \\\n",
       "0                    2018-02-06  97a5f299f3254a998a3bca0ad11a154d   \n",
       "1                    2018-02-07  9769f2af62e82eb5bc661520a03739e5   \n",
       "2                    2018-02-07  34b484a85a48ed5441c5b09de6867306   \n",
       "3                    2018-02-07  c697f1476734d3b8782c6288a2aaf478   \n",
       "4                    2018-02-01  53414d387e87b6d4fe6c96e56f920488   \n",
       "\n",
       "                    pregnancy_hh_id  pregnancy_patient_age_in_years  \\\n",
       "0  11d7a4f38fafa7954ce0752a1343e168                            16.0   \n",
       "1  2d3975a66c2fd5ec4653d151c025ba17                            27.0   \n",
       "2  0f01fd8cf6d363411725243842b8315d                            28.0   \n",
       "3  d4d73db5620f13202fdb7edd0c5c21c9                            25.0   \n",
       "4  978bba69e9454c353431f73ae69b787b                            23.0   \n",
       "\n",
       "  pregnancy_last_menstrual_period_date pregnancy_expected_due_date  \\\n",
       "0                           2017-08-07                  2018-05-13   \n",
       "1                           2017-07-29                  2018-05-04   \n",
       "2                           2017-08-08                  2018-05-14   \n",
       "3                           2017-12-08                  2018-09-13   \n",
       "4                           2017-08-02                  2018-05-08   \n",
       "\n",
       "  pregnancy_danger_signs pregnancy_risk_factors  ... pregnancy_danger_signs_9  \\\n",
       "0                    NaN                    NaN  ...                    False   \n",
       "1                    NaN                    NaN  ...                    False   \n",
       "2                    NaN                    NaN  ...                    False   \n",
       "3                    NaN                    NaN  ...                    False   \n",
       "4                    NaN                     r1  ...                    False   \n",
       "\n",
       "  age_missing                       delivery_id  \\\n",
       "0       False  f5562a92c91af04ba249ea11cca6f735   \n",
       "1       False  8d3616481a1ef21f4f6ab6a20c602a5d   \n",
       "2       False  6c2d0a4fc1224364215906d3a815cb43   \n",
       "3       False  09006aac17fd54a94965895938dc5d19   \n",
       "4       False  35d9d3459a2bc34de632d979d7b4cc9f   \n",
       "\n",
       "                    delivery_chw_id delivery_date_time_submitted  \\\n",
       "0  7f2d25199eef813addb4d9f783b3e075    2018-03-03 08:06:41+00:00   \n",
       "1  82b888a09920a91a193b60fa68605243    2018-04-27 03:43:39+00:00   \n",
       "2  0296ee306ec54e31cdd661859e4a32ef    2018-07-18 14:57:11+00:00   \n",
       "3  a3abfd66e17a0e3a1303dcb3bfb937d1    2018-08-17 13:49:58+00:00   \n",
       "4  8073c889d7526c6482820636bb0efb9e    2018-05-06 07:05:54+00:00   \n",
       "\n",
       "                delivery_patient_id                    delivery_hh_id  \\\n",
       "0  97a5f299f3254a998a3bca0ad11a154d  11d7a4f38fafa7954ce0752a1343e168   \n",
       "1  9769f2af62e82eb5bc661520a03739e5  2d3975a66c2fd5ec4653d151c025ba17   \n",
       "2  34b484a85a48ed5441c5b09de6867306  0f01fd8cf6d363411725243842b8315d   \n",
       "3  c697f1476734d3b8782c6288a2aaf478  d4d73db5620f13202fdb7edd0c5c21c9   \n",
       "4  53414d387e87b6d4fe6c96e56f920488  978bba69e9454c353431f73ae69b787b   \n",
       "\n",
       "  facility_delivery danger_signs_at_delivery delivery_first_visit_on_time  \n",
       "0              True                    False                         True  \n",
       "1              True                    False                         True  \n",
       "2              True                    False                         True  \n",
       "3              True                    False                         True  \n",
       "4              True                    False                         True  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "%%capture\n",
    "\n",
    "#drop redundant joining columns\n",
    "\n",
    "pregnancy_delivery_df.drop(columns=['delivery_patient_id', 'delivery_hh_id'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_form_id</th>\n",
       "      <th>pregnancy_chw_id</th>\n",
       "      <th>pregnancy_date_time_submitted</th>\n",
       "      <th>pregnancy_patient_id</th>\n",
       "      <th>pregnancy_hh_id</th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_last_menstrual_period_date</th>\n",
       "      <th>pregnancy_expected_due_date</th>\n",
       "      <th>pregnancy_danger_signs</th>\n",
       "      <th>pregnancy_risk_factors</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "      <th>age_missing</th>\n",
       "      <th>delivery_id</th>\n",
       "      <th>delivery_chw_id</th>\n",
       "      <th>delivery_date_time_submitted</th>\n",
       "      <th>delivery_patient_id</th>\n",
       "      <th>delivery_hh_id</th>\n",
       "      <th>facility_delivery</th>\n",
       "      <th>danger_signs_at_delivery</th>\n",
       "      <th>delivery_first_visit_on_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>fb4419f66aec81237d8f87c4ff0054a3</td>\n",
       "      <td>7f2d25199eef813addb4d9f783b3e075</td>\n",
       "      <td>2018-02-06</td>\n",
       "      <td>97a5f299f3254a998a3bca0ad11a154d</td>\n",
       "      <td>11d7a4f38fafa7954ce0752a1343e168</td>\n",
       "      <td>16.0</td>\n",
       "      <td>2017-08-07</td>\n",
       "      <td>2018-05-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>f5562a92c91af04ba249ea11cca6f735</td>\n",
       "      <td>7f2d25199eef813addb4d9f783b3e075</td>\n",
       "      <td>2018-03-03 08:06:41+00:00</td>\n",
       "      <td>97a5f299f3254a998a3bca0ad11a154d</td>\n",
       "      <td>11d7a4f38fafa7954ce0752a1343e168</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>60cee26693654bcdee37558c3efe79f8</td>\n",
       "      <td>82b888a09920a91a193b60fa68605243</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>9769f2af62e82eb5bc661520a03739e5</td>\n",
       "      <td>2d3975a66c2fd5ec4653d151c025ba17</td>\n",
       "      <td>27.0</td>\n",
       "      <td>2017-07-29</td>\n",
       "      <td>2018-05-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>8d3616481a1ef21f4f6ab6a20c602a5d</td>\n",
       "      <td>82b888a09920a91a193b60fa68605243</td>\n",
       "      <td>2018-04-27 03:43:39+00:00</td>\n",
       "      <td>9769f2af62e82eb5bc661520a03739e5</td>\n",
       "      <td>2d3975a66c2fd5ec4653d151c025ba17</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>73fbadf1c54c15e4d733e80899bd5a60</td>\n",
       "      <td>0296ee306ec54e31cdd661859e4a32ef</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>34b484a85a48ed5441c5b09de6867306</td>\n",
       "      <td>0f01fd8cf6d363411725243842b8315d</td>\n",
       "      <td>28.0</td>\n",
       "      <td>2017-08-08</td>\n",
       "      <td>2018-05-14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>6c2d0a4fc1224364215906d3a815cb43</td>\n",
       "      <td>0296ee306ec54e31cdd661859e4a32ef</td>\n",
       "      <td>2018-07-18 14:57:11+00:00</td>\n",
       "      <td>34b484a85a48ed5441c5b09de6867306</td>\n",
       "      <td>0f01fd8cf6d363411725243842b8315d</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>46f237f3890d2e9e37cb6b0e7fb0edc3</td>\n",
       "      <td>a3abfd66e17a0e3a1303dcb3bfb937d1</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>c697f1476734d3b8782c6288a2aaf478</td>\n",
       "      <td>d4d73db5620f13202fdb7edd0c5c21c9</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2017-12-08</td>\n",
       "      <td>2018-09-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>09006aac17fd54a94965895938dc5d19</td>\n",
       "      <td>a3abfd66e17a0e3a1303dcb3bfb937d1</td>\n",
       "      <td>2018-08-17 13:49:58+00:00</td>\n",
       "      <td>c697f1476734d3b8782c6288a2aaf478</td>\n",
       "      <td>d4d73db5620f13202fdb7edd0c5c21c9</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>339e3fe85597e9f3af8910b410d096a4</td>\n",
       "      <td>8073c889d7526c6482820636bb0efb9e</td>\n",
       "      <td>2018-02-01</td>\n",
       "      <td>53414d387e87b6d4fe6c96e56f920488</td>\n",
       "      <td>978bba69e9454c353431f73ae69b787b</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2017-08-02</td>\n",
       "      <td>2018-05-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>r1</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>35d9d3459a2bc34de632d979d7b4cc9f</td>\n",
       "      <td>8073c889d7526c6482820636bb0efb9e</td>\n",
       "      <td>2018-05-06 07:05:54+00:00</td>\n",
       "      <td>53414d387e87b6d4fe6c96e56f920488</td>\n",
       "      <td>978bba69e9454c353431f73ae69b787b</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  pregnancy_form_id                  pregnancy_chw_id  \\\n",
       "0  fb4419f66aec81237d8f87c4ff0054a3  7f2d25199eef813addb4d9f783b3e075   \n",
       "1  60cee26693654bcdee37558c3efe79f8  82b888a09920a91a193b60fa68605243   \n",
       "2  73fbadf1c54c15e4d733e80899bd5a60  0296ee306ec54e31cdd661859e4a32ef   \n",
       "3  46f237f3890d2e9e37cb6b0e7fb0edc3  a3abfd66e17a0e3a1303dcb3bfb937d1   \n",
       "4  339e3fe85597e9f3af8910b410d096a4  8073c889d7526c6482820636bb0efb9e   \n",
       "\n",
       "  pregnancy_date_time_submitted              pregnancy_patient_id  \\\n",
       "0                    2018-02-06  97a5f299f3254a998a3bca0ad11a154d   \n",
       "1                    2018-02-07  9769f2af62e82eb5bc661520a03739e5   \n",
       "2                    2018-02-07  34b484a85a48ed5441c5b09de6867306   \n",
       "3                    2018-02-07  c697f1476734d3b8782c6288a2aaf478   \n",
       "4                    2018-02-01  53414d387e87b6d4fe6c96e56f920488   \n",
       "\n",
       "                    pregnancy_hh_id  pregnancy_patient_age_in_years  \\\n",
       "0  11d7a4f38fafa7954ce0752a1343e168                            16.0   \n",
       "1  2d3975a66c2fd5ec4653d151c025ba17                            27.0   \n",
       "2  0f01fd8cf6d363411725243842b8315d                            28.0   \n",
       "3  d4d73db5620f13202fdb7edd0c5c21c9                            25.0   \n",
       "4  978bba69e9454c353431f73ae69b787b                            23.0   \n",
       "\n",
       "  pregnancy_last_menstrual_period_date pregnancy_expected_due_date  \\\n",
       "0                           2017-08-07                  2018-05-13   \n",
       "1                           2017-07-29                  2018-05-04   \n",
       "2                           2017-08-08                  2018-05-14   \n",
       "3                           2017-12-08                  2018-09-13   \n",
       "4                           2017-08-02                  2018-05-08   \n",
       "\n",
       "  pregnancy_danger_signs pregnancy_risk_factors  ... pregnancy_danger_signs_9  \\\n",
       "0                    NaN                    NaN  ...                    False   \n",
       "1                    NaN                    NaN  ...                    False   \n",
       "2                    NaN                    NaN  ...                    False   \n",
       "3                    NaN                    NaN  ...                    False   \n",
       "4                    NaN                     r1  ...                    False   \n",
       "\n",
       "  age_missing                       delivery_id  \\\n",
       "0       False  f5562a92c91af04ba249ea11cca6f735   \n",
       "1       False  8d3616481a1ef21f4f6ab6a20c602a5d   \n",
       "2       False  6c2d0a4fc1224364215906d3a815cb43   \n",
       "3       False  09006aac17fd54a94965895938dc5d19   \n",
       "4       False  35d9d3459a2bc34de632d979d7b4cc9f   \n",
       "\n",
       "                    delivery_chw_id delivery_date_time_submitted  \\\n",
       "0  7f2d25199eef813addb4d9f783b3e075    2018-03-03 08:06:41+00:00   \n",
       "1  82b888a09920a91a193b60fa68605243    2018-04-27 03:43:39+00:00   \n",
       "2  0296ee306ec54e31cdd661859e4a32ef    2018-07-18 14:57:11+00:00   \n",
       "3  a3abfd66e17a0e3a1303dcb3bfb937d1    2018-08-17 13:49:58+00:00   \n",
       "4  8073c889d7526c6482820636bb0efb9e    2018-05-06 07:05:54+00:00   \n",
       "\n",
       "                delivery_patient_id                    delivery_hh_id  \\\n",
       "0  97a5f299f3254a998a3bca0ad11a154d  11d7a4f38fafa7954ce0752a1343e168   \n",
       "1  9769f2af62e82eb5bc661520a03739e5  2d3975a66c2fd5ec4653d151c025ba17   \n",
       "2  34b484a85a48ed5441c5b09de6867306  0f01fd8cf6d363411725243842b8315d   \n",
       "3  c697f1476734d3b8782c6288a2aaf478  d4d73db5620f13202fdb7edd0c5c21c9   \n",
       "4  53414d387e87b6d4fe6c96e56f920488  978bba69e9454c353431f73ae69b787b   \n",
       "\n",
       "  facility_delivery danger_signs_at_delivery delivery_first_visit_on_time  \n",
       "0              True                    False                         True  \n",
       "1              True                    False                         True  \n",
       "2              True                    False                         True  \n",
       "3              True                    False                         True  \n",
       "4              True                    False                         True  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#preview joined data\n",
    "pregnancy_delivery_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>hh_id</th>\n",
       "      <th>how_water_treated</th>\n",
       "      <th>has_mosquito_net</th>\n",
       "      <th>latrine</th>\n",
       "      <th>hand_washing_facilities</th>\n",
       "      <th>electricity</th>\n",
       "      <th>television</th>\n",
       "      <th>cupboard</th>\n",
       "      <th>dvd</th>\n",
       "      <th>radio</th>\n",
       "      <th>clock</th>\n",
       "      <th>floor</th>\n",
       "      <th>walls</th>\n",
       "      <th>roof</th>\n",
       "      <th>fuel</th>\n",
       "      <th>toilet</th>\n",
       "      <th>highest_education_achieved</th>\n",
       "      <th>wealth_quintile</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2c6f0fcbee6b97a4f1c2d5c22b977cc5</td>\n",
       "      <td>aqua_tabs</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>some_primary</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>7bdf3f8e664c900770105bcb7c7c3186</td>\n",
       "      <td>aqua_tabs</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>cement</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>primary</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>5d69c689be3f3f70023ebf87f64185b4</td>\n",
       "      <td>missing</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>thatch_grass_ makuti</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>none</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>f6ded15b6595c631dbf08557f526f4fd</td>\n",
       "      <td>missing</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>some_secondary</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>563abcf37859abdfc1c387ae57433cc7</td>\n",
       "      <td>aqua_tabs</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>secondary</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                              hh_id how_water_treated has_mosquito_net  \\\n",
       "0  2c6f0fcbee6b97a4f1c2d5c22b977cc5         aqua_tabs              yes   \n",
       "1  7bdf3f8e664c900770105bcb7c7c3186         aqua_tabs              yes   \n",
       "2  5d69c689be3f3f70023ebf87f64185b4           missing              yes   \n",
       "3  f6ded15b6595c631dbf08557f526f4fd           missing              yes   \n",
       "4  563abcf37859abdfc1c387ae57433cc7         aqua_tabs              yes   \n",
       "\n",
       "  latrine hand_washing_facilities electricity television cupboard  dvd radio  \\\n",
       "0     yes                      no         yes         no       no   no   yes   \n",
       "1     yes                     yes          no        yes       no   no   yes   \n",
       "2     yes                     yes          no         no       no  yes   yes   \n",
       "3     yes                      no          no         no      yes   no   yes   \n",
       "4     yes                     yes         yes         no      yes   no    no   \n",
       "\n",
       "  clock       floor         walls                  roof  fuel        toilet  \\\n",
       "0    no  earth_sand  dung_mud_sod            roof_other  wood  toilet_other   \n",
       "1    no      cement  dung_mud_sod            roof_other  wood  toilet_other   \n",
       "2    no  earth_sand  dung_mud_sod  thatch_grass_ makuti  wood  toilet_other   \n",
       "3    no  earth_sand  dung_mud_sod            roof_other  wood  toilet_other   \n",
       "4   yes  earth_sand  dung_mud_sod            roof_other  wood  toilet_other   \n",
       "\n",
       "  highest_education_achieved  wealth_quintile  \n",
       "0               some_primary              5.0  \n",
       "1                    primary              5.0  \n",
       "2                       none              1.0  \n",
       "3             some_secondary              2.0  \n",
       "4                  secondary              1.0  "
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "family_survey_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "#join family survey data\n",
    "\n",
    "pregnancy_delivery_survey_df = pd.merge(pregnancy_delivery_df, family_survey_df,  how='inner', left_on=['pregnancy_hh_id'], right_on = ['hh_id'])\n",
    "#pregnancy_delivery_survey_df.drop(columns=['pregnancy_hh_id'])\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Flatten Pregnancy Visit Data For Joining"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "pregnancy_visit_form_id                        4536\n",
       "pregnancy_visit_chw_id                         4536\n",
       "pregnancy_visit_date_time_submitted            4536\n",
       "pregnancy_visit_patient_id                     4536\n",
       "pregnancy_visit_hh_id                          4536\n",
       "pregnancy_visit_how_visit_conducted            4536\n",
       "pregnancy_visit_referred_to_health_facility    4536\n",
       "pregnancy_visit_danger_signs                   4536\n",
       "pregnancy_visit_danger_signs_1                 4536\n",
       "pregnancy_visit_danger_signs_2                 4536\n",
       "pregnancy_visit_danger_signs_3                 4536\n",
       "pregnancy_visit_danger_signs_4                 4536\n",
       "pregnancy_visit_danger_signs_5                 4536\n",
       "pregnancy_visit_danger_signs_6                 4536\n",
       "pregnancy_visit_danger_signs_7                 4536\n",
       "pregnancy_visit_danger_signs_8                 4536\n",
       "pregnancy_visit_danger_signs_9                 4536\n",
       "dtype: int64"
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_visit_df[pregnancy_visit_df['pregnancy_visit_danger_signs_1']==True].count()\n",
    "#1.3% of visits have danger signs_1\n",
    "\n",
    "pregnancy_visit_df[pregnancy_visit_df['pregnancy_visit_danger_signs_2']==True].count()\n",
    "#0.3% of visits have danger_signs_2\n",
    "\n",
    "pregnancy_visit_df[(pregnancy_visit_df['pregnancy_visit_danger_signs_1']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_2']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_3']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_4']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_5']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_6']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_7']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_8']==True) | (pregnancy_visit_df['pregnancy_visit_danger_signs_9']==True)].count()\n",
    "\n",
    "##Only 3.3% of pregnancy visits have danger signs"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We want to flatten pregnancy_visit_df to include patient_id, visit_count, ever_referral_follow_up_needed. Recall that if danger signs are observed, a referral_follow_up_needed is automatic."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_visit_patient_id</th>\n",
       "      <th>visit_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0000c86de88724accadc38f7dcfb807b</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>00015953a5b912803c46c51b13e69665</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0002ad25a615c21162597bc41e8452e7</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>00038238757b71fb4ace66053bea76fe</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>00044eaa9e3357b4f19662b6a7210a25</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         pregnancy_visit_patient_id  visit_count\n",
       "0  0000c86de88724accadc38f7dcfb807b            3\n",
       "1  00015953a5b912803c46c51b13e69665            2\n",
       "2  0002ad25a615c21162597bc41e8452e7            5\n",
       "3  00038238757b71fb4ace66053bea76fe            4\n",
       "4  00044eaa9e3357b4f19662b6a7210a25            1"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_visit_counts.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['pregnancy_visit_form_id', 'pregnancy_visit_chw_id',\n",
       "       'pregnancy_visit_date_time_submitted', 'pregnancy_visit_patient_id',\n",
       "       'pregnancy_visit_hh_id', 'pregnancy_visit_how_visit_conducted',\n",
       "       'pregnancy_visit_referred_to_health_facility',\n",
       "       'pregnancy_visit_danger_signs', 'pregnancy_visit_danger_signs_1',\n",
       "       'pregnancy_visit_danger_signs_2', 'pregnancy_visit_danger_signs_3',\n",
       "       'pregnancy_visit_danger_signs_4', 'pregnancy_visit_danger_signs_5',\n",
       "       'pregnancy_visit_danger_signs_6', 'pregnancy_visit_danger_signs_7',\n",
       "       'pregnancy_visit_danger_signs_8', 'pregnancy_visit_danger_signs_9'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_visit_df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [],
   "source": [
    "#create ever_referral variable\n",
    "pregnancy_referral_needed = pregnancy_visit_df.groupby(['pregnancy_visit_patient_id'], sort=False)['pregnancy_visit_referred_to_health_facility'].max().reset_index(name='ever_referral')\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_visit_patient_id</th>\n",
       "      <th>ever_referral</th>\n",
       "      <th>visit_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>43247b91bca109e83ff8e119daaab050</td>\n",
       "      <td>True</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9a228db10e0baae37c379d98d5d47bf8</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>cc23df15b0ab238c3bccaab1513e8975</td>\n",
       "      <td>False</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8593b086f11aa58304b2d4b73ee5b66a</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>e706638fd80d002bba309f979d4e0388</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         pregnancy_visit_patient_id  ever_referral  visit_count\n",
       "0  43247b91bca109e83ff8e119daaab050           True            5\n",
       "1  9a228db10e0baae37c379d98d5d47bf8          False            1\n",
       "2  cc23df15b0ab238c3bccaab1513e8975          False            3\n",
       "3  8593b086f11aa58304b2d4b73ee5b66a          False            1\n",
       "4  e706638fd80d002bba309f979d4e0388          False            1"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#join flattened visit data\n",
    "pregnancy_visit_flat = pd.merge(pregnancy_referral_needed, pregnancy_visit_counts, how='inner', left_on=['pregnancy_visit_patient_id'], right_on=['pregnancy_visit_patient_id'])\n",
    "\n",
    "pregnancy_visit_flat.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['pregnancy_form_id', 'pregnancy_chw_id',\n",
       "       'pregnancy_date_time_submitted', 'pregnancy_patient_id',\n",
       "       'pregnancy_hh_id', 'pregnancy_patient_age_in_years',\n",
       "       'pregnancy_last_menstrual_period_date', 'pregnancy_expected_due_date',\n",
       "       'pregnancy_danger_signs', 'pregnancy_risk_factors',\n",
       "       'pregnancy_risk_factor_1', 'pregnancy_risk_factor_2',\n",
       "       'pregnancy_risk_factor_3', 'pregnancy_risk_factor_4',\n",
       "       'pregnancy_risk_factor_5', 'pregnancy_risk_factor_6',\n",
       "       'pregnancy_danger_signs_1', 'pregnancy_danger_signs_2',\n",
       "       'pregnancy_danger_signs_3', 'pregnancy_danger_signs_4',\n",
       "       'pregnancy_danger_signs_5', 'pregnancy_danger_signs_6',\n",
       "       'pregnancy_danger_signs_7', 'pregnancy_danger_signs_8',\n",
       "       'pregnancy_danger_signs_9', 'age_missing', 'delivery_id',\n",
       "       'delivery_chw_id', 'delivery_date_time_submitted',\n",
       "       'delivery_patient_id', 'delivery_hh_id', 'facility_delivery',\n",
       "       'danger_signs_at_delivery', 'delivery_first_visit_on_time', 'hh_id',\n",
       "       'how_water_treated', 'has_mosquito_net', 'latrine',\n",
       "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
       "       'dvd', 'radio', 'clock', 'floor', 'walls', 'roof', 'fuel', 'toilet',\n",
       "       'highest_education_achieved', 'wealth_quintile'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_survey_df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_form_id</th>\n",
       "      <th>pregnancy_chw_id</th>\n",
       "      <th>pregnancy_date_time_submitted</th>\n",
       "      <th>pregnancy_patient_id</th>\n",
       "      <th>pregnancy_hh_id</th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_last_menstrual_period_date</th>\n",
       "      <th>pregnancy_expected_due_date</th>\n",
       "      <th>pregnancy_danger_signs</th>\n",
       "      <th>pregnancy_risk_factors</th>\n",
       "      <th>...</th>\n",
       "      <th>floor</th>\n",
       "      <th>walls</th>\n",
       "      <th>roof</th>\n",
       "      <th>fuel</th>\n",
       "      <th>toilet</th>\n",
       "      <th>highest_education_achieved</th>\n",
       "      <th>wealth_quintile</th>\n",
       "      <th>pregnancy_visit_patient_id</th>\n",
       "      <th>ever_referral</th>\n",
       "      <th>visit_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>fb4419f66aec81237d8f87c4ff0054a3</td>\n",
       "      <td>7f2d25199eef813addb4d9f783b3e075</td>\n",
       "      <td>2018-02-06</td>\n",
       "      <td>97a5f299f3254a998a3bca0ad11a154d</td>\n",
       "      <td>11d7a4f38fafa7954ce0752a1343e168</td>\n",
       "      <td>16.0</td>\n",
       "      <td>2017-08-07</td>\n",
       "      <td>2018-05-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>fuel_other</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>primary</td>\n",
       "      <td>1.0</td>\n",
       "      <td>97a5f299f3254a998a3bca0ad11a154d</td>\n",
       "      <td>False</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>60cee26693654bcdee37558c3efe79f8</td>\n",
       "      <td>82b888a09920a91a193b60fa68605243</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>9769f2af62e82eb5bc661520a03739e5</td>\n",
       "      <td>2d3975a66c2fd5ec4653d151c025ba17</td>\n",
       "      <td>27.0</td>\n",
       "      <td>2017-07-29</td>\n",
       "      <td>2018-05-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>dung_mud_sod</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>after_secondary</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>73fbadf1c54c15e4d733e80899bd5a60</td>\n",
       "      <td>0296ee306ec54e31cdd661859e4a32ef</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>34b484a85a48ed5441c5b09de6867306</td>\n",
       "      <td>0f01fd8cf6d363411725243842b8315d</td>\n",
       "      <td>28.0</td>\n",
       "      <td>2017-08-08</td>\n",
       "      <td>2018-05-14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>earth_sand</td>\n",
       "      <td>walls_other</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>primary</td>\n",
       "      <td>3.0</td>\n",
       "      <td>34b484a85a48ed5441c5b09de6867306</td>\n",
       "      <td>False</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>46f237f3890d2e9e37cb6b0e7fb0edc3</td>\n",
       "      <td>a3abfd66e17a0e3a1303dcb3bfb937d1</td>\n",
       "      <td>2018-02-07</td>\n",
       "      <td>c697f1476734d3b8782c6288a2aaf478</td>\n",
       "      <td>d4d73db5620f13202fdb7edd0c5c21c9</td>\n",
       "      <td>25.0</td>\n",
       "      <td>2017-12-08</td>\n",
       "      <td>2018-09-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>cement</td>\n",
       "      <td>walls_other</td>\n",
       "      <td>thatch_grass_ makuti</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>primary</td>\n",
       "      <td>2.0</td>\n",
       "      <td>c697f1476734d3b8782c6288a2aaf478</td>\n",
       "      <td>False</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>339e3fe85597e9f3af8910b410d096a4</td>\n",
       "      <td>8073c889d7526c6482820636bb0efb9e</td>\n",
       "      <td>2018-02-01</td>\n",
       "      <td>53414d387e87b6d4fe6c96e56f920488</td>\n",
       "      <td>978bba69e9454c353431f73ae69b787b</td>\n",
       "      <td>23.0</td>\n",
       "      <td>2017-08-02</td>\n",
       "      <td>2018-05-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>r1</td>\n",
       "      <td>...</td>\n",
       "      <td>cement</td>\n",
       "      <td>walls_other</td>\n",
       "      <td>roof_other</td>\n",
       "      <td>wood</td>\n",
       "      <td>toilet_other</td>\n",
       "      <td>secondary</td>\n",
       "      <td>3.0</td>\n",
       "      <td>53414d387e87b6d4fe6c96e56f920488</td>\n",
       "      <td>False</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 55 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  pregnancy_form_id                  pregnancy_chw_id  \\\n",
       "0  fb4419f66aec81237d8f87c4ff0054a3  7f2d25199eef813addb4d9f783b3e075   \n",
       "1  60cee26693654bcdee37558c3efe79f8  82b888a09920a91a193b60fa68605243   \n",
       "2  73fbadf1c54c15e4d733e80899bd5a60  0296ee306ec54e31cdd661859e4a32ef   \n",
       "3  46f237f3890d2e9e37cb6b0e7fb0edc3  a3abfd66e17a0e3a1303dcb3bfb937d1   \n",
       "4  339e3fe85597e9f3af8910b410d096a4  8073c889d7526c6482820636bb0efb9e   \n",
       "\n",
       "  pregnancy_date_time_submitted              pregnancy_patient_id  \\\n",
       "0                    2018-02-06  97a5f299f3254a998a3bca0ad11a154d   \n",
       "1                    2018-02-07  9769f2af62e82eb5bc661520a03739e5   \n",
       "2                    2018-02-07  34b484a85a48ed5441c5b09de6867306   \n",
       "3                    2018-02-07  c697f1476734d3b8782c6288a2aaf478   \n",
       "4                    2018-02-01  53414d387e87b6d4fe6c96e56f920488   \n",
       "\n",
       "                    pregnancy_hh_id  pregnancy_patient_age_in_years  \\\n",
       "0  11d7a4f38fafa7954ce0752a1343e168                            16.0   \n",
       "1  2d3975a66c2fd5ec4653d151c025ba17                            27.0   \n",
       "2  0f01fd8cf6d363411725243842b8315d                            28.0   \n",
       "3  d4d73db5620f13202fdb7edd0c5c21c9                            25.0   \n",
       "4  978bba69e9454c353431f73ae69b787b                            23.0   \n",
       "\n",
       "  pregnancy_last_menstrual_period_date pregnancy_expected_due_date  \\\n",
       "0                           2017-08-07                  2018-05-13   \n",
       "1                           2017-07-29                  2018-05-04   \n",
       "2                           2017-08-08                  2018-05-14   \n",
       "3                           2017-12-08                  2018-09-13   \n",
       "4                           2017-08-02                  2018-05-08   \n",
       "\n",
       "  pregnancy_danger_signs pregnancy_risk_factors  ...       floor  \\\n",
       "0                    NaN                    NaN  ...  earth_sand   \n",
       "1                    NaN                    NaN  ...  earth_sand   \n",
       "2                    NaN                    NaN  ...  earth_sand   \n",
       "3                    NaN                    NaN  ...      cement   \n",
       "4                    NaN                     r1  ...      cement   \n",
       "\n",
       "          walls                  roof        fuel        toilet  \\\n",
       "0  dung_mud_sod            roof_other  fuel_other  toilet_other   \n",
       "1  dung_mud_sod            roof_other        wood  toilet_other   \n",
       "2   walls_other            roof_other        wood  toilet_other   \n",
       "3   walls_other  thatch_grass_ makuti        wood  toilet_other   \n",
       "4   walls_other            roof_other        wood  toilet_other   \n",
       "\n",
       "  highest_education_achieved wealth_quintile  \\\n",
       "0                    primary             1.0   \n",
       "1            after_secondary             1.0   \n",
       "2                    primary             3.0   \n",
       "3                    primary             2.0   \n",
       "4                  secondary             3.0   \n",
       "\n",
       "         pregnancy_visit_patient_id ever_referral visit_count  \n",
       "0  97a5f299f3254a998a3bca0ad11a154d         False         1.0  \n",
       "1                               NaN           NaN         NaN  \n",
       "2  34b484a85a48ed5441c5b09de6867306         False         3.0  \n",
       "3  c697f1476734d3b8782c6288a2aaf478         False         4.0  \n",
       "4  53414d387e87b6d4fe6c96e56f920488         False         6.0  \n",
       "\n",
       "[5 rows x 55 columns]"
      ]
     },
     "execution_count": 80,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# join in flattened visit data\n",
    "\n",
    "pregnancy_delivery_survey_visit_df = pd.merge(pregnancy_delivery_survey_df, pregnancy_visit_flat, how='left', left_on=['pregnancy_patient_id'], right_on=['pregnancy_visit_patient_id'])\n",
    "\n",
    "pregnancy_delivery_survey_visit_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {},
   "outputs": [],
   "source": [
    "#drop pregnancy visit patient id\n",
    "pregnancy_delivery_survey_visit_df.drop(columns=['pregnancy_visit_patient_id'])\n",
    "\n",
    "#coerce implied missing values from left join i.e. if there was no visit, there was no referral, if there was no visit,\n",
    "#visit number is zero\n",
    "\n",
    "pregnancy_delivery_survey_visit_df['ever_referral'].fillna(False, inplace=True)\n",
    "\n",
    "pregnancy_delivery_survey_visit_df['visit_count'].fillna(0, inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['pregnancy_form_id', 'pregnancy_chw_id',\n",
       "       'pregnancy_date_time_submitted', 'pregnancy_patient_id',\n",
       "       'pregnancy_hh_id', 'pregnancy_patient_age_in_years',\n",
       "       'pregnancy_last_menstrual_period_date', 'pregnancy_expected_due_date',\n",
       "       'pregnancy_danger_signs', 'pregnancy_risk_factors',\n",
       "       'pregnancy_risk_factor_1', 'pregnancy_risk_factor_2',\n",
       "       'pregnancy_risk_factor_3', 'pregnancy_risk_factor_4',\n",
       "       'pregnancy_risk_factor_5', 'pregnancy_risk_factor_6',\n",
       "       'pregnancy_danger_signs_1', 'pregnancy_danger_signs_2',\n",
       "       'pregnancy_danger_signs_3', 'pregnancy_danger_signs_4',\n",
       "       'pregnancy_danger_signs_5', 'pregnancy_danger_signs_6',\n",
       "       'pregnancy_danger_signs_7', 'pregnancy_danger_signs_8',\n",
       "       'pregnancy_danger_signs_9', 'age_missing', 'delivery_id',\n",
       "       'delivery_chw_id', 'delivery_date_time_submitted',\n",
       "       'delivery_patient_id', 'delivery_hh_id', 'facility_delivery',\n",
       "       'danger_signs_at_delivery', 'delivery_first_visit_on_time', 'hh_id',\n",
       "       'how_water_treated', 'has_mosquito_net', 'latrine',\n",
       "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
       "       'dvd', 'radio', 'clock', 'floor', 'walls', 'roof', 'fuel', 'toilet',\n",
       "       'highest_education_achieved', 'wealth_quintile',\n",
       "       'pregnancy_visit_patient_id', 'ever_referral', 'visit_count'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 82,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_survey_visit_df.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Add Household Size"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>hh_id</th>\n",
       "      <th>household_size</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>000011214306406a544f879972ccbf07</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>000021464dcef94410982c36ad471369</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>000132dc6adcd10a7d24e11a1018cead</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0001727631d6a3d1dd8e41989fcb03e3</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>000191355990014ac7ca8cd6aa92185f</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                              hh_id  household_size\n",
       "0  000011214306406a544f879972ccbf07               2\n",
       "1  000021464dcef94410982c36ad471369               2\n",
       "2  000132dc6adcd10a7d24e11a1018cead               6\n",
       "3  0001727631d6a3d1dd8e41989fcb03e3               8\n",
       "4  000191355990014ac7ca8cd6aa92185f               1"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "household_size.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['pregnancy_form_id', 'pregnancy_chw_id',\n",
       "       'pregnancy_date_time_submitted', 'pregnancy_patient_id',\n",
       "       'pregnancy_hh_id', 'pregnancy_patient_age_in_years',\n",
       "       'pregnancy_last_menstrual_period_date', 'pregnancy_expected_due_date',\n",
       "       'pregnancy_danger_signs', 'pregnancy_risk_factors',\n",
       "       'pregnancy_risk_factor_1', 'pregnancy_risk_factor_2',\n",
       "       'pregnancy_risk_factor_3', 'pregnancy_risk_factor_4',\n",
       "       'pregnancy_risk_factor_5', 'pregnancy_risk_factor_6',\n",
       "       'pregnancy_danger_signs_1', 'pregnancy_danger_signs_2',\n",
       "       'pregnancy_danger_signs_3', 'pregnancy_danger_signs_4',\n",
       "       'pregnancy_danger_signs_5', 'pregnancy_danger_signs_6',\n",
       "       'pregnancy_danger_signs_7', 'pregnancy_danger_signs_8',\n",
       "       'pregnancy_danger_signs_9', 'age_missing', 'delivery_id',\n",
       "       'delivery_chw_id', 'delivery_date_time_submitted',\n",
       "       'delivery_patient_id', 'delivery_hh_id', 'facility_delivery',\n",
       "       'danger_signs_at_delivery', 'delivery_first_visit_on_time', 'hh_id_x',\n",
       "       'how_water_treated', 'has_mosquito_net', 'latrine',\n",
       "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
       "       'dvd', 'radio', 'clock', 'floor', 'walls', 'roof', 'fuel', 'toilet',\n",
       "       'highest_education_achieved', 'wealth_quintile',\n",
       "       'pregnancy_visit_patient_id', 'ever_referral', 'visit_count', 'hh_id_y',\n",
       "       'household_size'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 87,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_survey_visit_household_df = pd.merge(pregnancy_delivery_survey_visit_df, household_size, how='left', left_on=['pregnancy_hh_id'], right_on = ['hh_id'])\n",
    "\n",
    "pregnancy_delivery_survey_visit_household_df.columns\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [],
   "source": [
    "pregnancy_delivery_survey_visit_df = pregnancy_delivery_survey_visit_household_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Create days_pregnant variable"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create days_pregnant at time of registration column\n",
    "\n",
    "pregnancy_delivery_survey_visit_df['days_pregnant'] = pregnancy_delivery_survey_visit_df['pregnancy_date_time_submitted'] - pregnancy_delivery_survey_visit_household_df['pregnancy_last_menstrual_period_date']\n",
    "\n",
    "#pregnancy_delivery_survey_visit_df['days_pregnant']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['pregnancy_form_id', 'pregnancy_chw_id',\n",
       "       'pregnancy_date_time_submitted', 'pregnancy_patient_id',\n",
       "       'pregnancy_hh_id', 'pregnancy_patient_age_in_years',\n",
       "       'pregnancy_last_menstrual_period_date', 'pregnancy_expected_due_date',\n",
       "       'pregnancy_danger_signs', 'pregnancy_risk_factors',\n",
       "       'pregnancy_risk_factor_1', 'pregnancy_risk_factor_2',\n",
       "       'pregnancy_risk_factor_3', 'pregnancy_risk_factor_4',\n",
       "       'pregnancy_risk_factor_5', 'pregnancy_risk_factor_6',\n",
       "       'pregnancy_danger_signs_1', 'pregnancy_danger_signs_2',\n",
       "       'pregnancy_danger_signs_3', 'pregnancy_danger_signs_4',\n",
       "       'pregnancy_danger_signs_5', 'pregnancy_danger_signs_6',\n",
       "       'pregnancy_danger_signs_7', 'pregnancy_danger_signs_8',\n",
       "       'pregnancy_danger_signs_9', 'age_missing', 'delivery_id',\n",
       "       'delivery_chw_id', 'delivery_date_time_submitted',\n",
       "       'delivery_patient_id', 'delivery_hh_id', 'facility_delivery',\n",
       "       'danger_signs_at_delivery', 'delivery_first_visit_on_time', 'hh_id_x',\n",
       "       'how_water_treated', 'has_mosquito_net', 'latrine',\n",
       "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
       "       'dvd', 'radio', 'clock', 'floor', 'walls', 'roof', 'fuel', 'toilet',\n",
       "       'highest_education_achieved', 'wealth_quintile',\n",
       "       'pregnancy_visit_patient_id', 'ever_referral', 'visit_count', 'hh_id_y',\n",
       "       'household_size', 'days_pregnant'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_survey_visit_df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "metadata": {},
   "outputs": [],
   "source": [
    "pregnancy_delivery_survey_visit_df_subset = pregnancy_delivery_survey_visit_df[['pregnancy_patient_age_in_years',\n",
    "       'pregnancy_risk_factor_1', 'pregnancy_risk_factor_2',\n",
    "       'pregnancy_risk_factor_3', 'pregnancy_risk_factor_4',\n",
    "       'pregnancy_risk_factor_5', 'pregnancy_risk_factor_6',\n",
    "       'pregnancy_danger_signs_1', 'pregnancy_danger_signs_2',\n",
    "       'pregnancy_danger_signs_3', 'pregnancy_danger_signs_4',\n",
    "       'pregnancy_danger_signs_5', 'pregnancy_danger_signs_6',\n",
    "       'pregnancy_danger_signs_7', 'pregnancy_danger_signs_8',\n",
    "       'pregnancy_danger_signs_9', \n",
    "       'facility_delivery', 'danger_signs_at_delivery',\n",
    "       'delivery_first_visit_on_time', 'how_water_treated',\n",
    "       'has_mosquito_net', 'latrine', 'hand_washing_facilities', 'electricity',\n",
    "       'television', 'cupboard', 'dvd', 'radio', 'clock', 'floor', 'walls',\n",
    "       'roof', 'fuel', 'toilet', 'highest_education_achieved',\n",
    "       'wealth_quintile', 'ever_referral',\n",
    "       'visit_count', 'days_pregnant', 'household_size']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Handle Categorical Variables"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To prevent the encoding of atrificial information that exists when we transform categorical variables to \n",
    "integer data (i.e. an order that does not exists naturally in the data), we will implement one-hot encoding"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0          missing\n",
       "1        aqua_tabs\n",
       "2        aqua_tabs\n",
       "3          missing\n",
       "4             boil\n",
       "5          missing\n",
       "6        aqua_tabs\n",
       "7             boil\n",
       "8          missing\n",
       "9           filter\n",
       "10       aqua_tabs\n",
       "11       aqua_tabs\n",
       "12         missing\n",
       "13         missing\n",
       "14         missing\n",
       "15       aqua_tabs\n",
       "16            boil\n",
       "17          filter\n",
       "18       aqua_tabs\n",
       "19            boil\n",
       "20          filter\n",
       "21          filter\n",
       "22            boil\n",
       "23         missing\n",
       "24         missing\n",
       "25         missing\n",
       "26         missing\n",
       "27         missing\n",
       "28       aqua_tabs\n",
       "29         missing\n",
       "           ...    \n",
       "22438    aqua_tabs\n",
       "22439    aqua_tabs\n",
       "22440       filter\n",
       "22441      missing\n",
       "22442      missing\n",
       "22443      missing\n",
       "22444    aqua_tabs\n",
       "22445    aqua_tabs\n",
       "22446         boil\n",
       "22447      missing\n",
       "22448    aqua_tabs\n",
       "22449    aqua_tabs\n",
       "22450      missing\n",
       "22451    aqua_tabs\n",
       "22452       filter\n",
       "22453    aqua_tabs\n",
       "22454    aqua_tabs\n",
       "22455    aqua_tabs\n",
       "22456    aqua_tabs\n",
       "22457      missing\n",
       "22458      missing\n",
       "22459         boil\n",
       "22460      missing\n",
       "22461    aqua_tabs\n",
       "22462       filter\n",
       "22463    aqua_tabs\n",
       "22464    aqua_tabs\n",
       "22465    aqua_tabs\n",
       "22466    aqua_tabs\n",
       "22467      missing\n",
       "Name: how_water_treated, Length: 22468, dtype: object"
      ]
     },
     "execution_count": 94,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_survey_visit_df['how_water_treated']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {},
   "outputs": [],
   "source": [
    "categorical_cols = [\n",
    " 'how_water_treated',\n",
    " 'has_mosquito_net',\n",
    " 'latrine',\n",
    " 'hand_washing_facilities',\n",
    " 'electricity',\n",
    " 'television',\n",
    " 'cupboard',\n",
    " 'dvd',\n",
    " 'radio',\n",
    " 'clock',\n",
    " 'floor',\n",
    " 'walls',\n",
    " 'roof',\n",
    " 'fuel',\n",
    " 'toilet',\n",
    "    'pregnancy_risk_factor_1', 'pregnancy_risk_factor_2',\n",
    "       'pregnancy_risk_factor_3', 'pregnancy_risk_factor_4',\n",
    "       'pregnancy_risk_factor_5', 'pregnancy_risk_factor_6',\n",
    "       'pregnancy_danger_signs_1', 'pregnancy_danger_signs_2',\n",
    "       'pregnancy_danger_signs_3', 'pregnancy_danger_signs_4',\n",
    "       'pregnancy_danger_signs_5', 'pregnancy_danger_signs_6',\n",
    "       'pregnancy_danger_signs_7', 'pregnancy_danger_signs_8',\n",
    "       'pregnancy_danger_signs_9', 'facility_delivery', 'danger_signs_at_delivery',\n",
    "       'delivery_first_visit_on_time',\n",
    " 'highest_education_achieved', 'ever_referral'\n",
    "]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>how_water_treated</th>\n",
       "      <th>has_mosquito_net</th>\n",
       "      <th>latrine</th>\n",
       "      <th>hand_washing_facilities</th>\n",
       "      <th>electricity</th>\n",
       "      <th>television</th>\n",
       "      <th>cupboard</th>\n",
       "      <th>dvd</th>\n",
       "      <th>radio</th>\n",
       "      <th>clock</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_danger_signs_5</th>\n",
       "      <th>pregnancy_danger_signs_6</th>\n",
       "      <th>pregnancy_danger_signs_7</th>\n",
       "      <th>pregnancy_danger_signs_8</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "      <th>facility_delivery</th>\n",
       "      <th>danger_signs_at_delivery</th>\n",
       "      <th>delivery_first_visit_on_time</th>\n",
       "      <th>highest_education_achieved</th>\n",
       "      <th>ever_referral</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>missing</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>primary</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>aqua_tabs</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>after_secondary</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>aqua_tabs</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>primary</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>missing</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>primary</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>boil</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>secondary</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  how_water_treated has_mosquito_net latrine hand_washing_facilities  \\\n",
       "0           missing              yes     yes                     yes   \n",
       "1         aqua_tabs               no     yes                     yes   \n",
       "2         aqua_tabs              yes     yes                     yes   \n",
       "3           missing              yes     yes                     yes   \n",
       "4              boil               no     yes                     yes   \n",
       "\n",
       "  electricity television cupboard  dvd radio clock  ...  \\\n",
       "0          no        yes       no   no   yes    no  ...   \n",
       "1          no        yes      yes  yes   yes    no  ...   \n",
       "2          no        yes       no   no   yes    no  ...   \n",
       "3          no        yes       no   no   yes    no  ...   \n",
       "4         yes         no      yes   no   yes    no  ...   \n",
       "\n",
       "  pregnancy_danger_signs_5 pregnancy_danger_signs_6 pregnancy_danger_signs_7  \\\n",
       "0                    False                    False                    False   \n",
       "1                    False                    False                    False   \n",
       "2                    False                    False                    False   \n",
       "3                    False                    False                    False   \n",
       "4                    False                    False                    False   \n",
       "\n",
       "  pregnancy_danger_signs_8 pregnancy_danger_signs_9 facility_delivery  \\\n",
       "0                    False                    False              True   \n",
       "1                    False                    False              True   \n",
       "2                    False                    False              True   \n",
       "3                    False                    False              True   \n",
       "4                    False                    False              True   \n",
       "\n",
       "  danger_signs_at_delivery delivery_first_visit_on_time  \\\n",
       "0                    False                         True   \n",
       "1                    False                         True   \n",
       "2                    False                         True   \n",
       "3                    False                         True   \n",
       "4                    False                         True   \n",
       "\n",
       "  highest_education_achieved ever_referral  \n",
       "0                    primary         False  \n",
       "1            after_secondary         False  \n",
       "2                    primary         False  \n",
       "3                    primary         False  \n",
       "4                  secondary         False  \n",
       "\n",
       "[5 rows x 35 columns]"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pregnancy_delivery_survey_visit_df_subset[categorical_cols].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pandas/core/frame.py:3391: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  self[k1] = value[k2]\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>how_water_treated</th>\n",
       "      <th>has_mosquito_net</th>\n",
       "      <th>latrine</th>\n",
       "      <th>hand_washing_facilities</th>\n",
       "      <th>electricity</th>\n",
       "      <th>television</th>\n",
       "      <th>cupboard</th>\n",
       "      <th>dvd</th>\n",
       "      <th>radio</th>\n",
       "      <th>clock</th>\n",
       "      <th>...</th>\n",
       "      <th>pregnancy_danger_signs_5</th>\n",
       "      <th>pregnancy_danger_signs_6</th>\n",
       "      <th>pregnancy_danger_signs_7</th>\n",
       "      <th>pregnancy_danger_signs_8</th>\n",
       "      <th>pregnancy_danger_signs_9</th>\n",
       "      <th>facility_delivery</th>\n",
       "      <th>danger_signs_at_delivery</th>\n",
       "      <th>delivery_first_visit_on_time</th>\n",
       "      <th>highest_education_achieved</th>\n",
       "      <th>ever_referral</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   how_water_treated  has_mosquito_net  latrine  hand_washing_facilities  \\\n",
       "0                  3                 1        1                        1   \n",
       "1                  0                 0        1                        1   \n",
       "2                  0                 1        1                        1   \n",
       "3                  3                 1        1                        1   \n",
       "4                  1                 0        1                        1   \n",
       "5                  3                 1        1                        1   \n",
       "6                  0                 1        1                        0   \n",
       "7                  1                 1        1                        0   \n",
       "8                  3                 1        1                        1   \n",
       "9                  2                 1        1                        0   \n",
       "\n",
       "   electricity  television  cupboard  dvd  radio  clock  ...  \\\n",
       "0            0           1         0    0      1      0  ...   \n",
       "1            0           1         1    1      1      0  ...   \n",
       "2            0           1         0    0      1      0  ...   \n",
       "3            0           1         0    0      1      0  ...   \n",
       "4            1           0         1    0      1      0  ...   \n",
       "5            0           0         0    0      1      0  ...   \n",
       "6            0           0         1    0      1      0  ...   \n",
       "7            0           0         0    0      1      0  ...   \n",
       "8            0           0         1    0      1      0  ...   \n",
       "9            0           0         1    0      1      0  ...   \n",
       "\n",
       "   pregnancy_danger_signs_5  pregnancy_danger_signs_6  \\\n",
       "0                         0                         0   \n",
       "1                         0                         0   \n",
       "2                         0                         0   \n",
       "3                         0                         0   \n",
       "4                         0                         0   \n",
       "5                         0                         0   \n",
       "6                         0                         0   \n",
       "7                         0                         0   \n",
       "8                         0                         0   \n",
       "9                         0                         0   \n",
       "\n",
       "   pregnancy_danger_signs_7  pregnancy_danger_signs_8  \\\n",
       "0                         0                         0   \n",
       "1                         0                         0   \n",
       "2                         0                         0   \n",
       "3                         0                         0   \n",
       "4                         0                         0   \n",
       "5                         0                         1   \n",
       "6                         0                         0   \n",
       "7                         0                         0   \n",
       "8                         0                         0   \n",
       "9                         0                         0   \n",
       "\n",
       "   pregnancy_danger_signs_9  facility_delivery  danger_signs_at_delivery  \\\n",
       "0                         0                  1                         0   \n",
       "1                         0                  1                         0   \n",
       "2                         0                  1                         0   \n",
       "3                         0                  1                         0   \n",
       "4                         0                  1                         0   \n",
       "5                         1                  1                         0   \n",
       "6                         0                  1                         0   \n",
       "7                         0                  1                         0   \n",
       "8                         0                  1                         0   \n",
       "9                         0                  1                         0   \n",
       "\n",
       "   delivery_first_visit_on_time  highest_education_achieved  ever_referral  \n",
       "0                             1                           3              0  \n",
       "1                             1                           0              0  \n",
       "2                             1                           3              0  \n",
       "3                             1                           3              0  \n",
       "4                             1                           4              0  \n",
       "5                             1                           5              0  \n",
       "6                             1                           5              0  \n",
       "7                             1                           6              0  \n",
       "8                             1                           5              0  \n",
       "9                             1                           6              0  \n",
       "\n",
       "[10 rows x 35 columns]"
      ]
     },
     "execution_count": 97,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#First we will will use the LabelEncoder to convert categorical text data to categorical numerical data\n",
    "\n",
    "# import labelencoder\n",
    "from sklearn.preprocessing import LabelEncoder\n",
    "# instantiate labelencoder object\n",
    "labelencoder = LabelEncoder()\n",
    "\n",
    "# apply le on categorical feature columns\n",
    "pregnancy_delivery_survey_visit_df_subset[categorical_cols] = pregnancy_delivery_survey_visit_df_subset[categorical_cols].apply(lambda col: labelencoder.fit_transform(col))\n",
    "pregnancy_delivery_survey_visit_df_subset[categorical_cols].head(10)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Next we will implement one-hot encoding for those variables with more than two categories"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1 0]\n",
      "[1 0]\n",
      "[1 0]\n",
      "[0 1]\n",
      "[1 0]\n",
      "[0 1]\n",
      "[0 1]\n",
      "[1 0]\n",
      "[0 1]\n",
      "floor:[1 0 2]\n",
      "[0 1]\n",
      "[0 1]\n",
      "fuel:[0 2 1]\n",
      "[1 0]\n"
     ]
    }
   ],
   "source": [
    "print(pregnancy_delivery_survey_visit_df_subset['has_mosquito_net'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['latrine'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['hand_washing_facilities'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['electricity'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['television'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['cupboard'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['dvd'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['radio'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['clock'].unique())\n",
    "print('floor:' + str(pregnancy_delivery_survey_visit_df_subset['floor'].unique()))\n",
    "print(pregnancy_delivery_survey_visit_df_subset['walls'].unique())\n",
    "print(pregnancy_delivery_survey_visit_df_subset['roof'].unique())\n",
    "print('fuel:' + str(pregnancy_delivery_survey_visit_df_subset['fuel'].unique()))\n",
    "print(pregnancy_delivery_survey_visit_df_subset['toilet'].unique())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['hh_id', 'how_water_treated', 'has_mosquito_net', 'latrine',\n",
       "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
       "       'dvd', 'radio', 'clock', 'floor', 'walls', 'roof', 'fuel', 'toilet',\n",
       "       'highest_education_achieved', 'wealth_quintile'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 100,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "family_survey_df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['pregnancy_patient_age_in_years', 'pregnancy_risk_factor_1',\n",
       "       'pregnancy_risk_factor_2', 'pregnancy_risk_factor_3',\n",
       "       'pregnancy_risk_factor_4', 'pregnancy_risk_factor_5',\n",
       "       'pregnancy_risk_factor_6', 'pregnancy_danger_signs_1',\n",
       "       'pregnancy_danger_signs_2', 'pregnancy_danger_signs_3',\n",
       "       'pregnancy_danger_signs_4', 'pregnancy_danger_signs_5',\n",
       "       'pregnancy_danger_signs_6', 'pregnancy_danger_signs_7',\n",
       "       'pregnancy_danger_signs_8', 'pregnancy_danger_signs_9',\n",
       "       'facility_delivery', 'danger_signs_at_delivery',\n",
       "       'delivery_first_visit_on_time', 'has_mosquito_net', 'latrine',\n",
       "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
       "       'dvd', 'radio', 'clock', 'walls', 'roof', 'toilet', 'wealth_quintile',\n",
       "       'ever_referral', 'visit_count', 'days_pregnant', 'household_size',\n",
       "       'floor_1', 'floor_2', 'fuel_1', 'fuel_2', 'education_1', 'education_2',\n",
       "       'education_3', 'education_4', 'education_5', 'education_6', 'water_1',\n",
       "       'water_2', 'water_3'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 101,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Create dummy vars \n",
    "\n",
    "#floor\n",
    "df_floor = pd.get_dummies(pregnancy_delivery_survey_visit_df_subset['floor'], drop_first=True, prefix='floor')\n",
    "df_floor\n",
    "\n",
    "df_subset_floor = pd.concat([pregnancy_delivery_survey_visit_df_subset, df_floor], axis=1)\n",
    "df_subset_floor\n",
    "\n",
    "#fuel\n",
    "df_fuel = pd.get_dummies(pregnancy_delivery_survey_visit_df_subset['fuel'], drop_first=True, prefix='fuel')\n",
    "df_fuel\n",
    "\n",
    "df_subset_floor_fuel = pd.concat([df_subset_floor, df_fuel], axis=1)\n",
    "df_subset_floor_fuel\n",
    "\n",
    "#education\n",
    "df_edu = pd.get_dummies(pregnancy_delivery_survey_visit_df_subset['highest_education_achieved'], drop_first=True, prefix='education')\n",
    "df_edu\n",
    "\n",
    "df_subset_floor_fuel_edu = pd.concat([df_subset_floor_fuel, df_edu], axis=1)\n",
    "df_subset_floor_fuel_edu\n",
    "\n",
    "#water treatment\n",
    "df_wat = pd.get_dummies(pregnancy_delivery_survey_visit_df_subset['how_water_treated'], drop_first=True, prefix='water')\n",
    "df_wat\n",
    "\n",
    "df_subset_floor_fuel_edu_wat = pd.concat([df_subset_floor_fuel_edu, df_wat], axis=1)\n",
    "df_subset_floor_fuel_edu_wat\n",
    "\n",
    "\n",
    "df_subset_floor_fuel_edu_wat.drop(columns=['floor', 'fuel', 'highest_education_achieved', 'how_water_treated'], inplace=True)\n",
    "df_subset_floor_fuel_edu_wat.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "cols = list(df_subset_floor_fuel_edu_wat.columns)\n",
    "\n",
    "#Convert columns to numeric\n",
    "df_subset_floor_fuel_edu_wat.loc[:, cols] = df_subset_floor_fuel_edu_wat.loc[:, cols].apply(pd.to_numeric)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_subset_floor_fuel_edu_wat[['visit_count']] = df_subset_floor_fuel_edu_wat[['visit_count']].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 1,  0,  3,  4,  6,  7,  2, 11,  8,  9, 10,  5, 12, 13, 14, 19, 17,\n",
       "       15, 23, 18, 16, 20, 28])"
      ]
     },
     "execution_count": 160,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_subset_floor_fuel_edu_wat['visit_count'].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Build Models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['pregnancy_patient_age_in_years', 'pregnancy_risk_factor_1',\n",
       "       'pregnancy_risk_factor_2', 'pregnancy_risk_factor_3',\n",
       "       'pregnancy_risk_factor_4', 'pregnancy_risk_factor_5',\n",
       "       'pregnancy_risk_factor_6', 'pregnancy_danger_signs_1',\n",
       "       'pregnancy_danger_signs_2', 'pregnancy_danger_signs_3',\n",
       "       'pregnancy_danger_signs_4', 'pregnancy_danger_signs_5',\n",
       "       'pregnancy_danger_signs_6', 'pregnancy_danger_signs_7',\n",
       "       'pregnancy_danger_signs_8', 'pregnancy_danger_signs_9',\n",
       "       'facility_delivery', 'danger_signs_at_delivery',\n",
       "       'delivery_first_visit_on_time', 'has_mosquito_net', 'latrine',\n",
       "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
       "       'dvd', 'radio', 'clock', 'walls', 'roof', 'toilet', 'wealth_quintile',\n",
       "       'ever_referral', 'visit_count', 'days_pregnant', 'household_size',\n",
       "       'floor_1', 'floor_2', 'fuel_1', 'fuel_2', 'education_1', 'education_2',\n",
       "       'education_3', 'education_4', 'education_5', 'education_6', 'water_1',\n",
       "       'water_2', 'water_3'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 161,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#separate response variables from #explanatory variables\n",
    "\n",
    "df_subset_floor_fuel_edu_wat.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "metadata": {},
   "outputs": [],
   "source": [
    "X = df_subset_floor_fuel_edu_wat[['pregnancy_patient_age_in_years', 'pregnancy_risk_factor_1',\n",
    "       'pregnancy_risk_factor_2', 'pregnancy_risk_factor_3',\n",
    "       'pregnancy_risk_factor_4', 'pregnancy_risk_factor_5',\n",
    "       'pregnancy_risk_factor_6', 'pregnancy_danger_signs_1',\n",
    "       'pregnancy_danger_signs_2', 'pregnancy_danger_signs_3',\n",
    "       'pregnancy_danger_signs_4', 'pregnancy_danger_signs_5',\n",
    "       'pregnancy_danger_signs_6', 'pregnancy_danger_signs_7',\n",
    "       'pregnancy_danger_signs_8', 'pregnancy_danger_signs_9','has_mosquito_net', 'latrine',\n",
    "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
    "       'dvd', 'radio', 'clock', 'walls', 'roof', 'toilet', 'wealth_quintile',\n",
    "       'ever_referral', 'visit_count', 'days_pregnant', 'household_size',\n",
    "       'floor_1', 'floor_2', 'fuel_1', 'fuel_2', 'education_1', 'education_2',\n",
    "       'education_3', 'education_4', 'education_5', 'education_6', 'water_1',\n",
    "       'water_2', 'water_3']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_visit = df_subset_floor_fuel_edu_wat[['visit_count']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_simple = df_subset_floor_fuel_edu_wat[[\n",
    "       'ever_referral', 'visit_count']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "metadata": {},
   "outputs": [],
   "source": [
    "y1 = df_subset_floor_fuel_edu_wat[['facility_delivery']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "metadata": {},
   "outputs": [],
   "source": [
    "y2 = df_subset_floor_fuel_edu_wat[['delivery_first_visit_on_time']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "metadata": {},
   "outputs": [],
   "source": [
    "y3 = df_subset_floor_fuel_edu_wat[['danger_signs_at_delivery']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Simple Logistic Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 168,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "facility_delivery\n",
      "0     2227\n",
      "1    14624\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X_simple, y1, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")\n",
    "\n",
    "#Check the number of positive and negative responses in the response variable \n",
    "print(y_train.groupby('facility_delivery').size())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "I usually like to run Logistic Regressions in statsmodels and sklearn (statsmodels because I love their summary output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Optimization terminated successfully.\n",
      "         Current function value: 0.480003\n",
      "         Iterations 6\n",
      "                           Logit Regression Results                           \n",
      "==============================================================================\n",
      "Dep. Variable:      facility_delivery   No. Observations:                16851\n",
      "Model:                          Logit   Df Residuals:                    16849\n",
      "Method:                           MLE   Df Model:                            1\n",
      "Date:                Tue, 16 Apr 2019   Pseudo R-squ.:                 -0.2293\n",
      "Time:                        16:29:33   Log-Likelihood:                -8088.5\n",
      "converged:                       True   LL-Null:                       -6579.8\n",
      "                                        LLR p-value:                     1.000\n",
      "=================================================================================\n",
      "                    coef    std err          z      P>|z|      [0.025      0.975]\n",
      "---------------------------------------------------------------------------------\n",
      "ever_referral     0.0687      0.080      0.858      0.391      -0.088       0.226\n",
      "visit_count       0.4195      0.007     60.648      0.000       0.406       0.433\n",
      "=================================================================================\n"
     ]
    }
   ],
   "source": [
    "import statsmodels.api as sm\n",
    "\n",
    "logit = sm.Logit(y_train, X_train)\n",
    "\n",
    "# fit the model\n",
    "result = logit.fit()\n",
    "print(result.summary())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Visit counts look significant!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.8629161474096493\n",
      "confusion matrix: [[   0  770]\n",
      " [   0 4847]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.8629161474096493\n",
      "f1_score is 0.926414373088685\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Oh no! The model is only correctly predicting true negatives. We could get the same accuracy by predicting that all pregnancies occur at health facilities."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<seaborn.axisgrid.PairGrid at 0x14910ec18>"
      ]
     },
     "execution_count": 172,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 6 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import seaborn as sns\n",
    "sns.pairplot(X_simple)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 173,
   "metadata": {},
   "outputs": [],
   "source": [
    "testing = df_subset_floor_fuel_edu_wat[['ever_referral', 'visit_count', 'facility_delivery']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<seaborn.axisgrid.PairGrid at 0x14911bac8>"
      ]
     },
     "execution_count": 174,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAg0AAAIUCAYAAACZwR/HAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAIABJREFUeJzs3Xt8HOV99/3vb7Vaa32KjZD9EMuOTeJA/aQpROKQ0x3KIY8JFNpCC04MwTe3DSQQ+jRtQ9scCGl7k6RJn0IIxk4CAScBCk3jG5wAJZBjIZYTQoI5OcRgEYqFbMA2a69W+3v+2JW8Wq2k2dXO7uzq83699iXN7DUzv9F17exPM9dcY+4uAACAicTqHQAAAGgMJA0AACAQkgYAABAISQMAAAiEpAEAAARC0gAAAAIhaQAAAIGQNAAAgEBIGgAAQCANmzQsX77cJfHiVfyqO9omr3FedUf75DXGK5CGTRpeeumleocAlETbRJTRPjEZDZs0AACA2iJpAAAAgZA0AACAQEgaAABAIKEnDWb2NTPbaWa/HuN9M7NrzGybmT1qZm8LOyYAAFC+eA22cZOkL0m6eYz3T5W0NP86TtL1+Z+TtviKuwOX3X71adXYJFCW/fsz6k+llcm64jFTezIhSaPmVXu6FtsIss22toOHoHQ6o759B9/vmJFQIlHdQ1Qmk9XOvQc0MJhVa0tM82ZOUzzOCdchpdpjYR2hsYRRn6G3Bnf/oZktHqfImZJudneX9JCZzTGzw9z9hbBjA+pp//6Mnu7fp0s2bFHv7pQ65yZ146pjlM5kddEtB+ddv7JL197/lO7dunPM6bse6dUNP9o+PL17b0rn37hleHrLb1/SlXc9oc65Sa1d2aW21pguuHHzpLYxJxnTez7/Q7132TxddtKbR+xHqeXnz07onHUPjSiztH2G2triSqczerJv36h1HNExo2qJQyaT1RMv7tHFBdtYu7JLR86fReKg0u2xsI7QWMKqzyh8UhZI2lEw3ZufBzS1/lR6+AMtSb27U+rdlRpOGIbmXbJhi87qWjju9Nndi0ZMv3He7BHTJy47bHj64g1btGNXatLbiFmLJOmsroWj9qPU8umMjyrTn0pLkvr2jf5bXLJhi/r2pav2996598BwwlD4t9i590DVttHISrXHwjpCYwmrPqOQNARmZmvMrMfMevr6+uodDjCskraZyR78Eh0yPdEyal7v7pTmJFvHnW6J2YjpTNZHTOdO5B2cnp5oqdo25iRbA8U8mPVRZYbWUepvUbwfkzUwmC29jcFs1bYRVUHaZy3qALUTVn1GIWl4XtLCgunO/LxR3H2du3e7e3dHR0dNggOCqKRtxmOmzrnJEfNeSw+Omtc5N6mXUwPjThd+IXfOTSpe8AXfOTcps5HTr6UHq7aNl1MDgWIuTDqK11Hqb1G8H5PV2hIrvY2WKBwGwxWkfdaiDlA7YdVnFD4tGyWdn7+L4nhJr9CfAVNBezKh61d2DX+wO+cm1XlIUjecN3Le9Su7dOeWHeNO39Hz3Ijp3+x8dcT097e+MDy9dmWXFh6SnPQ2sp5LPO7csmPUfpRaPhG3UWWGOkh2zBj9t7h+ZZc6ZiSq9veeN3Oa1hZtY+3KLs2bOa1q22hkpdpjYR2hsYRVn1Z42jIMZvYtSSdIOlTSi5I+JalVktx9reX+BfqSpOWSXpO0yt17Jlpvd3e39/SMX4y7J6akuv9bFKRtDuHuifrcPZEZzCpen7snIt0+uXuiuZRZn4HaZi3unlgxwfsu6cNhxwFEUVtbXAtKfIiL51V7uhbbCLLNQolEXAuqnCQUi8djev2c5MQFp6ix2iMaUxj1GYXLEwAAoAGQNAAAgEBIGgAAQCAkDQAAIBCSBgAAEAhJAwAACISkAQAABELSAAAAAiFpAAAAgZA0AACAQEgaAABAICQNAAAgEJIGAAAQCEkDAAAIhKQBAAAEQtIAAAACIWkAAACB1CRpMLPlZvakmW0zsytKvL/IzB4ws1+Y2aNm9r5axAUAAIILPWkwsxZJ10k6VdIySSvMbFlRsY9Lut3dj5Z0rqQvhx0XAAAoTy3ONBwraZu7P+PuaUm3SjqzqIxLmp3//XWSfleDuAAAQBniNdjGAkk7CqZ7JR1XVOZKSfea2WWSZkg6uQZxAQCAMkSlI+QKSTe5e6ek90m6xcxGxWZma8ysx8x6+vr6ah4kMBbaJqKM9olqqUXS8LykhQXTnfl5hS6UdLskuft/SWqTdGjxitx9nbt3u3t3R0dHSOEC5aNtIspon6iWWiQNmyUtNbMlZpZQrqPjxqIyz0k6SZLM7PeUSxpIhwEAiJDQkwZ3z0i6VNI9kh5X7i6Jx8zsKjM7I1/so5JWm9kvJX1L0gXu7mHHBgAAgqtFR0i5+yZJm4rmfbLg962S3lmLWAAAQGWi0hESAABEHEkDAAAIhKQBAAAEMmGfBjO7VrkRG0ty949UNSIAABBJQTpC9oQeBQAAiLwJkwZ3/3otAgEAANEW+JZLM+uQ9DHlnlTZNjTf3U8MIS4AABAx5XSE/IZygzMtkfRpSduVG+0RAABMAeUkDe3u/lVJA+7+A3f/n5I4ywAAwBRRzoiQA/mfL5jZaZJ+J+mQ6ocEAACiqJyk4R/M7HXKPSfiWkmzJf2/oUQFAAAiJ1DSYGYtkpa6+12SXpH0h6FGBQAAIidQnwZ3H5S0IuRYAABAhJVzeeInZvYlSbdJ2jc0091/XvWoAABA5JSTNByV/3lVwTwXd1AAADAlBO3TEJN0vbvfHnI8AAAgooL2achK+ptKNmBmy83sSTPbZmZXjFHmz81sq5k9ZmbfrGQ7AAAgXOVcnvhPM/srje7TsGusBfJ3XVwn6RRJvZI2m9lGd99aUGappL+V9E53321m88rcBwAAUAPlJA3n5H9+uGCeSzp8nGWOlbTN3Z+RJDO7VdKZkrYWlFkt6Tp33y1J7r6zjJgAAECNBE4a3H1JBetfIGlHwXSvpOOKyrxZkszsJ5JaJF3p7t+rYFsAACBEgZ89YWbTzezjZrYuP73UzE6vQgxxSUslnaDcWBDrzWzOGDGsMbMeM+vp6+urwqaB6qBtIspon6iWch5YdaOktKR35Kefl/QPEyzzvKSFBdOd+XmFeiVtdPcBd/+tpKeUSyJGcfd17t7t7t0dHR1lhA6Ei7aJKKN9olrKSRre6O6fU/7BVe7+miSbYJnNkpaa2RIzS0g6V9LGojL/odxZBpnZocpdrnimjLgAAEANlJM0pM0sqVznR5nZGyUdGG8Bd89IulTSPZIel3S7uz9mZleZ2Rn5YvdI6jezrZIekPTX7t5f5n4AAICQlXP3xKckfU/SQjP7hqR3SrpgooXcfZOkTUXzPlnwu0v6y/wLAABE1IRJg5m9091/IumHkv5U0vHKXZa43N1fCjk+AAAQEUHONFwjqUvSf7n72yTdHW5IAAAgioIkDQP52yw7zeya4jfd/SPVDwsAAERNkKThdEknS/p/JG0JNxwAABBVEyYN+X4Lt5rZ4+7+yxrEBAAAIqicWy5TZna/mf1akszsrWb28ZDiAgAAEVNO0rBeuadRDg3u9KhygzUBAIApoJykYbq7/6xoXqaawQAAgOgqJ2l4KT8K5NCIkGdLeiGUqAAAQOSUMyLkhyWtk3SkmT0v6beSPhBKVAAAIHICJQ1mFpPU7e4nm9kMSTF33xNuaAAAIEoCXZ5w96ykv8n/vo+EAQCAqaecPg3/aWZ/ZWYLzeyQoVdokQEAgEgpp0/DOfmfHy6Y55IOr144AAAgqgInDe6+ZLz3zewUd79v8iEBAIAoKufyxEQ+W8V1AQCAiKlm0mBVXBcAAIiYaiYNPtYbZrbczJ40s21mdsU45c4yMzez7irGBQAAqqCaSUNJZtYi6TpJp0paJmmFmS0rUW6WpMslPRx2TAAAoHyBkgYzi5nZOyYotn2M+cdK2ubuz7h7WtKtks4sUe4zyvWL2B8kJgAAUFvlDO503QRl/nSMtxZI2lEw3ZufN8zM3iZpobvfHSQeAABQe+Vcnrg/3+egqh0e80NUf1HSRwOUXWNmPWbW09fXV80wgEmhbSLKaJ+olnKShosk/ZuktJm9amZ7zOzVAMs9L2lhwXRnft6QWZLeIulBM9su6XhJG0t1hnT3de7e7e7dHR0dZYQOhIu2iSijfaJayhncaVaF29gsaamZLVEuWThX0vsL1vuKpEOHps3sQUl/5e49FW4PAACEIPCZBstZaWafyE8vNLNjJ1rO3TOSLpV0j6THJd3u7o+Z2VVmdkalgQMAgNoq59kTX5aUlXSicnc67FWuc+QxEy3o7pskbSqa98kxyp5QRkwAAKBGykkajnP3t5nZLyTJ3XebWSKkuAAAQMSU0xFyID9Qk0uSmXUod+YBAABMAeUkDddI+rakeWb2j5J+LOmfQokKAABETjl3T3zDzLZIOkm5h1P9sbs/HlpkAAAgUgInDWZ2jaRb3X3ckSEBAEBzKufyxBZJHzez35jZP/MkSgAAppbASYO7f93d36fcLZZPSvqsmT0dWmQAACBSKnk09pskHSnpDZKeqG44AAAgqsoZEfJzZvaUpKsk/UpSt7v/UWiRAQCASCnnTMN2Sf8g6afufpOk2UGGkQYAAM2hnKTh9yUdJ2lFfnqPcsNIAwCAKYBhpAEAQCAMIw0AAAJhGGkAABAIw0gDAIBAyunTIHd/QozNAADAlFTJ4E4AAGAKCj1pMLPlZvakmW0zsytKvP+XZrbVzB41s/vN7A1hxwQAAMoXatKQv9viOkmnSlomaYWZLSsq9gvlRpd8q6Q7JH0uzJgAAEBlwj7TcKykbe7+jLunJd0q6czCAu7+gLu/lp98SFJnyDEBAIAKhJ00LJC0o2C6Nz9vLBdK+u5Yb5rZGjPrMbOevr6+KoUITB5tE1FG+0S1RKYjpJmtlNQt6fNjlXH3de7e7e7dHR0dtQsOmABtE1FG+0S1lHXLZQWel7SwYLozP28EMztZ0t9Leo+7Hwg5JgAAUIGwzzRslrTUzJbkn1NxrqSNhQXM7GhJN0g6w913hhwPAACoUKhJg7tnJF0q6R5Jj0u63d0fM7OrzOyMfLHPS5op6d/M7BEz2zjG6gAAQB2FfXlC7r5J0qaieZ8s+P3ksGMAAACTF5mOkAAAINpIGgAAQCAkDQAAIBCSBgAAEAhJAwAACISkAQAABELSAAAAAiFpAAAAgZA0AACAQEgaAABAICQNAAAgEJIGAAAQCEkDAAAIhKQBAAAEEvqjsYHxLL7i7sBlt199WoiRAAAmwpkGAAAQSE2SBjNbbmZPmtk2M7uixPvTzOy2/PsPm9niWsQFAACCC/3yhJm1SLpO0imSeiVtNrON7r61oNiFkna7+5vM7FxJn5V0TtixAbW2f39G/am0MllXPGZqTyZGTUuasMxkp2uxjWpsc9f+AQ0MZtXaEtMhba0j3j90ekKvpgeVzgwqEW9R+4yEYjGreZ1ms67+fem6x1ENpdpnWxtXsRtVGPVZi9ZwrKRt7v6MJJnZrZLOlFSYNJwp6cr873dI+pKZmbt7DeIDamL//oye7t+nSzZsUe/ulDrnJnX9yi5de/9TunfrzuHpw9un6Zx1D41bZnvfq7rs1keHp9/QPk1vvfJ+XfTuxTr9qM7hbRRPd85N6sZVx+jAQFYXTxBH8TbueqRXN/xo+6jypbZRan2zk3F9YP3DI8oUr3PLb1/SlXc9MTwdt6xOveano8q/d9k8XXbSm0dsc/353Tpi/qyafmFns64nX9yj1Tf31DWOahirfS5tn0Hi0IDCqs9aXJ5YIGlHwXRvfl7JMu6ekfSKpPYaxAbUTH8qPfwBlqTe3SldsmGLzupaOGL65VR2wjJHv6F9xPSeVFaSdHb3ohHbKJ7u3Z1S767UcMJQzjbO7l5UsnypbZRa30DGR5UpXueJyw4bMT07Oa1k+bO6Fo7a5uqbe9S/L12Fmgquf196OGGoZxzVMFb77E813r4gvPpsqI6QZrbGzHrMrKevr6/e4QDDgrTNTPbgl+aQ3t0pzUm2jpjOZH3CMoMFZQqXaYnZiG0UT0vS9ERLoDiKt9FS8J9zYflS2yi1vuJ/vEuts/DkYvHforD8nGRryW2mM4OqpXRmMBJxTGQy7bO4PaIxhFWftUganpe0sGC6Mz+vZBkzi0t6naT+4hW5+zp373b37o6OjpDCBcoXpG3GY6bOuckR8zrnJvVyamDEdLzo27VUmcIv28JlBrM+YhvF05L0WnowUBzF2yhMIgrLl9pGqfUVH6tKrdOs9H4Vl385NVBym4l4i2opEW+JRBwTmUz7LG6PaAxh1WctkobNkpaa2RIzS0g6V9LGojIbJX0w//vZkr5PfwY0m/ZkQtev7Br+IA9dY7xzy44R03OSsQnL/OLZ/hHTs5K5j/IdPc+N2EbxdOfcpDoPSWptgDiKt3FHz3Mly5faRqn1tcZtVJnidX5/6wsjpl9NHShZ/s4tO0Ztc/353WqfkahCTQXXPiOh9ed31z2OahirfQ51YkVjCas+rRbfzWb2Pkn/n6QWSV9z9380s6sk9bj7RjNrk3SLpKMl7ZJ07lDHybF0d3d7T0/PuNtl4KDoC6GO6v5v0Xhtk7snyr97IjOYVbx57p5ouPZJJ8jGVWZ9BmqbNWkN7r5J0qaieZ8s+H2/pD+rRSxAPbW1xbWg6ENbPF1qXrWna7GNamzz9RO83zGt/l9osZipY9a0eodRFaXaJxpXGPXZUB0hAQBA/ZA0AACAQEgaAABAICQNAAAgkJrcPREGM+uT9OwExQ6V9FINwqk39vOgl9x9eS2CGUuTtc1GiLMRYpRycT5B+4wU9vOgQMfOhk0agjCzHnfvrnccYWM/G0+j7EsjxNkIMUqNE6fUWLFOBvtZPi5PAACAQEgaAABAIM2eNKyrdwA1wn42nkbZl0aIsxFilBonTqmxYp0M9rNMTd2nAQAAVE+zn2kAAABVQtIAAAACIWkAAACBkDQAAIBASBoAAEAgJA0AACAQkgYAABAISQMAAAiEpAEAAARC0gAAAAIhaQAAAIGQNAAAgEBqmjSYWZuZ/czMfmlmj5nZp/Pzl5jZw2a2zcxuM7NELeMCAAATq/WZhgOSTnT3P5B0lKTlZna8pM9K+hd3f5Ok3ZIurHFcAABgAjVNGjxnb36yNf9ySSdKuiM//+uS/riWcQEAgInVvE+DmbWY2SOSdkq6T9JvJL3s7pl8kV5JCyZaz/Lly125hIMXr8JX3dE2eY3zqjvaJ68xXoHEgxasFncflHSUmc2R9G1JRwZd1szWSFojSYsWLQonQKACtE1EGe0T1VK3uyfc/WVJD0h6u6Q5ZjaUwHRKen6MZda5e7e7d3d0dNQoUmBitE1EGe0T1VLruyc68mcYZGZJSadIely55OHsfLEPSvpOLeMCAAATq/XlicMkfd3MWpRLWG5397vMbKukW83sHyT9QtJXaxwXAACYQE2TBnd/VNLRJeY/I+nYWsYCAADKw4iQAAAgkJrfPVEL2ayrf19a6cygEvEWtc9IKBazeocFVGzxFXeXVX771aeFFAmARhHGd2HTJQ3ZrOvJF/do9c096t2dUufcpNaf360j5s8icQAATAlhfRc23eWJ/n3p4T+SJPXuTmn1zT3q35euc2QAANRGWN+FTZc0pDODw3+kIb27U0pnBusUEQAAtRXWd2HTJQ2JeIs65yZHzOucm1Qi3lKniAAAqK2wvgubLmlon5HQ+vO7h/9YQ9dx2mfwtG0AwNQQ1ndh03WEjMVMR8yfpW9/6J3cPQEAmJLC+i5suqRByv2xOmZNq3cYAADUTRjfhU2ZNABRV+64CwAQBU3XpwEAAISDpAEAAARC0gAAAAIhaQAAAIHUNGkws4Vm9oCZbTWzx8zs8vz8K83seTN7JP96Xy3jAgAAE6v13RMZSR9195+b2SxJW8zsvvx7/+Lu/1zjeAAAQEA1TRrc/QVJL+R/32Nmj0taUMsYAABAZerWp8HMFks6WtLD+VmXmtmjZvY1M5s7xjJrzKzHzHr6+vpqFCkwMdomooz2iWqpS9JgZjMl3SnpL9z9VUnXS3qjpKOUOxPxhVLLufs6d+929+6Ojo6axQtMhLaJKKN9olpqnjSYWatyCcM33P3fJcndX3T3QXfPSlov6dhaxwUAAMZX67snTNJXJT3u7l8smH9YQbE/kfTrWsYFAAAmVuu7J94p6TxJvzKzR/Lz/k7SCjM7SpJL2i7pohrHBQAAJlDruyd+LKnUczk31TIOAABQPkaEBAAAgfBobEReJpPVzr0HNDCYVWtLTPNmTlM8Tr4LAOMJ49hJ0oBIy2SyeuLFPbp4wxb17k6pc25Sa1d26cj5s0gcAGAMYR07Oeoi0nbuPTDc6CWpd3dKF2/Yop17D9Q5MgCIrrCOnSQNiLSBwexwox/SuzulzGC2ThEBQPSFdewkaUCktbbE1Dk3OWJe59yk4i00XQAYS1jHTo68iLR5M6dp7cqu4cY/dF1u3sxpdY4MAKIrrGMnHSERafF4TEfOn6XbL3q7MoNZxbl7AgAmFNaxk6QBkRePx/T6OcmJCwIAhoVx7OTfNQAAEAhJAwAACISkAQAABELSAAAAAiFpAAAAgdQ0aTCzhWb2gJltNbPHzOzy/PxDzOw+M3s6/3PuZLaTzbr69hzQ87tfU9+eA8pmvTo7AABAgwjju7DWt1xmJH3U3X9uZrMkbTGz+yRdIOl+d7/azK6QdIWkj1WygWzW9eSLe7T65p7hh3SsP79bR8yfpVjMqrYjAABEVVjfhTU90+DuL7j7z/O/75H0uKQFks6U9PV8sa9L+uNKt9G/Lz38R5JyY22vvrlH/fvSk4odAIBGEdZ3Yd36NJjZYklHS3pY0nx3fyH/1n9Lmj/GMmvMrMfMevr6+kquN50ZLPmQjnRmsEqRA6MFaZtAvdA+p56wvgvrkjSY2UxJd0r6C3d/tfA9d3dJJS+8uPs6d+929+6Ojo6S607EW0o+pCMRb6lK7EApQdomUC+0z6knrO/CmicNZtaqXMLwDXf/9/zsF83ssPz7h0naWen622cktP68kQ/pWH9el9pnJCYZOQAAjSGs78KKOkKa2Wfd/WMTzSuxnEn6qqTH3f2LBW9tlPRBSVfnf36nkrgkKZMZVDwe02fOfIumJ1r0Wjo3nckMKpHgURsAgOYX1ndhpUueotF3N5xaYl6xd0o6T9KvzOyR/Ly/Uy5ZuN3MLpT0rKQ/rzAu9e1La9WNm0dcy+mcm9Rta47XApIGAMAUENZ3YVlLmtklkj4k6XAze7TgrVmSfjLR8u7+Y0lj3etxUjmxjCWT9ZKdPzKM1QAAmCLC+i4sN934pqTvSvrfyo2lMGSPu++aVCRVEo+ZLnr3Yp3dvUgtMdNg1nVHz3OKM0YDAGCKCOu7sKykwd1fkfSKpBVm1qLcrZFxSTPNbKa7PzepaKqgPZnQ6Ud1atVNm4cHtLh+ZZfak3SEBABMDWF9F1Z094SZXSrpRUn3Sbo7/7prUpFUya79A7pkw5YRA1pcsmGLdu0fqHNkAADURljfhZX2hvgLSUe4e/+kth6CgcFs6es4g9k6RQQAQG2F9V1Y6TgNO5S7TBE5rS2xkgNaxFt4oCcAYGoI67uw0jMNz0h60MzulnRgaGbR2At1MW/mNN39kXdo7/6sMllXPGaa2RbTjFb6NDSqdDqjvn3p4frsmJFgzA0gBJlMVjv3HtDAYFatLTHNmzlN8Tj/cDWieTOnadPl79Ce1MHvwlnJmKbH6zC4k6Tn8q9E/hUZmUxWz+06MHwtZ6jzx9L2OI2/AaXTGT3Zt29UfR7RMYPEAaiiTCarJ17co4sLPmtrV3bpyPmzOHY2oEwmq2f7q/9dWNGS7v7pUq+Ko6ii/lS6ZOeP/hRPuWxEfftK12cfTy0Fqmrn3gPDCYOU+6xdvGGLdu49MMGSiKKwvgsrHUb6AZV4qJS7nzipaKqAwZ2aC/UJ1AadyJtLVAZ3GvJXBb+3STpLUmZSkVRJPGbqnJscNXQmgzs1JuoTqI2hjnOjPmt0Im9IYR07K0oa3H1L0ayfmNnPJhVJlbQnE/q3i49XZlAadFeLmeIt0txpkep6gYA6ZiR0/cquUdflOnhqKVBV82ZO09qVXaP6NMybOa3eoaECYX0XVnp54pCCyZikLkmvm1QkVfTS3oFRXzIkDY0pkYjriI4Zum3N8dw9AYQoHo/pyPmzdPtFb1dmMKs4d080vDC+Cys98m5Rrk+DKXdZ4reSLpxUJFUyVueP29YcrwVtfNE0okQizhNKgRqIx2N6/ZzkxAUReWF9F1Z6eWJJJcuZ2dcknS5pp7u/JT/vSkmrJfXli/2du2+qZP0SHecAAIhUR0gza5V0iaT/kZ/1oKQb3H2iQa1vkvQlSTcXzf8Xd//nSmIpxlMum8/+/Rn1pw4O7tSeTKiNs0ZA1fFZax6R6ggp6XpJrZK+nJ8+Lz/vf423kLv/0MwWV7jNQHjKZXPZvz+jp/tHD+60tH0GBzOgivisNZf2ZOlO5HV5yqWkY9z9g+7+/fxrlaRjJhHHpWb2qJl9zczmTmI9DO7UZKhPoDb4rDWX/lRadz3SqxsvOEbf/+h7dOMFx+iuR3rrM7iTpEEze6O7/0aSzOxwSYMVrut6SZ9RrmPlZyR9QdL/LFXQzNZIWiNJixYtKrky+jQ0l0apzyBtE6gXjp1TTybruuFH23XDj7aPmP/+4xdPar2Vnmn4a0kPmNmDZvYDSd+X9NFKVuTuL7r7oLtnJa2XdOw4Zde5e7e7d3d0dJQsM3QdpxCDATWuRqnPIG0TqBeOnVNPWPVZ6d0T95vZUklH5Gc96e4VDVBuZoe5+wv5yT+R9OtK1jOkPZnQN1Yfp4GMK2ZS1qXWuNGnoUG1JxP69w+9XemMazDraomZEnHT7NbWeocGNJWwroGjPtqTiZJPfJ5mk+ufUundEx+W9A13fzQ/PdfMLnT3L0+w3LcknSDpUDPrlfQpSSeY2VHKXZ7YLumiSmIq9GoqM6rhz5/OqGaN6sVX06Pqc3Y7SQNQba9LxnXTqmOH/+FKxDnL0MjGeuKFZDUJAAAgAElEQVTzZFS69Gp3v25owt13m9lqHbyboiR3X1Fi9lcrjKEkBndqLtQnUBv9qbTev/7hUbfo8VlrTGEdOyvt09BiZsMpqJm1SIrEOSw68zQX6hOoDT5rzSVSgztJ+p6k28zshvz0Rfl5dRePmd67bJ7O6lqoOclWvZwa0J1bdtCZp0FRn0Bt8ETZ5hLWsbPSpOFjyt2+c0l++j5JX5lUJFXSnkzospPeTGeeJkF9ArVBR8jmEtaxs6LLE+6edfe17n52/nWDuw+P02Bmd04qqklggJLmQn0CtdGfSuva+5/SJ05fptvWHK9PnL5M197/FJ+1BhXWsTOs3i2Hh7TeCXFdrrlQn0BtZLKue7fu1L1bd46Y//enLatTRJiMsI6dYT0ovW5HdAYoaS7UJ1AbfNaaS6QGd4oyrss1l/ZkQmtXdunigvpcS30CVdeeTOj/XPYOvXbg4GBA06fFlIw13dfElBDWd2FYraGuqensogFKWhmgpKG1tcb0mTPfoumJFr2WHlRba1gnyICprXd39QcDQv20z2zVt1Yfr6y7YmZqaZn8OisdEfJyd//XceZ9bNKRVag/ldYHGKCkafSn0rrgxs3UJxAyBlJrLv2ptM5Z91DVj52V/sv2wRLzLhj6xd3vrXC9k0bHueZCfQK1wWetuURicCczWyHp/ZKWmNnGgrdmSdo1qUiqhMGAmks8ZvrR3/wPxaxl+Dpr1gcVM+oTqKZ4zPTdj7xDs5PThj9rr6YOcOxsUPGY6aJ3L9bZ3YvUEjMNZl139DxX846QP5X0gqRDJX2hYP4eSY9OKpIqYTCg5tKeTOjp/n26ZMPmouusyYkXBhBYezKhXa8NDJ/S5tjZ2NqTCZ1+VKdW3bS5qvVZ1uUJd3/W3R9097e7+w8KXj9398ykIqkSBgNqLtQnUBt81ppLJAZ3MrMfu/u7zGyPRo7FYJLc3WdPKpoq4Lpcc6E+gdrgs9ZcIjG4k7u/K/9zlrvPLnjNCpIwmNnXzGynmf26YN4hZnafmT2d/zm3/N04iAFKmgv1CdQGn7XmEqnBnczsjZJ63f2AmZ0g6a2Sbnb3lydY9CZJX5J0c8G8KyTd7+5Xm9kV+emKb9lsTyb0zdXHKZ3x4XEaEnHjulyDak8m9I3Vx2mgoD5bqU+g6hgYr7m0JxO6+yPv0N79BwfrmtkW0zSb3O2zlS59p6RuM3uTpHWSviPpm5LeN95C7v5DM1tcNPtMSSfkf/+6pAc1yXEeXkllRjX8edOnTWaVqKNXS9TnfOoTqLpDiwYDildhMCDUz3O7qj9YV6XjNGTzHR//RNK17v7Xkg6rcF3z3f2F/O//LWl+heuRRGeeZkN9ArXRn0rrz9Y+pHd/7gG95/MP6t2fe0B/tvYhPmsNKqxjZ6VJw0B+zIYPSrorP691UpEo15NS4zzsyszWmFmPmfX09fWVLENnnubSKPUZpG0C9cKxc+qJxOBOBVZJuljSP7r7b81siaRbKlzXi2Z2mLu/YGaHSdo5VkF3X6fc5RB1d3eX3PN4zHTtuW/V0W9o12DW1RIz/eLZfjrzNKhGGawrSNsE6iXosTOMwYBQH2F9F1aUNLj7VkkfKZj+raTPVhjDRuXOWFyd//mdCtcjKdf5Y3HHbJ3LACVNgcG6gNoIazAg1EdY34VlXZ4ws9vzP39lZo8WvH5lZhOOCGlm35L0X5KOMLNeM7tQuWThFDN7WtLJ+emKcQ28uVCfQG3wWWsukRjcSdLl+Z83SXpIUm85C7v7ijHeOqnMOMbEdbnmQn0CtcFnrblEZXCnobscZip3fWyDpD+StN/dn51UJFXCACXNhfoEaoPPWnOJ1OBO7v5pSZ82s7dKOkfSD8ys191PnlQ0VdCeTOjGVceod1dK0xMtei09qM5DklyXa1DtyYS+vuoYPVdQn4uoT6Dq2pMJ3bTqGO0o+Kwt5LPWsMIarGtyozzk7nT4b0n9kuZNcl1Vc2Agq09859fDf6i1K7vqHRImIUV9AjWxn89aU5mdjOumVceOGE13sioap8HMPmRmD0q6X1K7pNXu/tZJR1MF/am0Li7q/HExnXkaFvUJ1AaftebSn0rrA+sf1slf/IFO/MIPdPIXf6APrH+45h0hhyyU9Bfu/sikth4COvM0F+oTqA0+a80lEh0hh7j730YxYZDozNNsqE+gNvisNZdIdYSMsvZkQmtXdg2fZhu6LkdnnsZE5yygNtqTCd1wXpcuuuXgsfOG8zh2NqqwbgpouqRBkqa1xvSZM98y/Iea1lrpIzYQBXTOKt/iK+4OXHb71aeFGAkaSSI+8tiZiHPsbGRh3BTQdElDfyqtVTduHnEtp3NuUretOV4L2ppud5veWJ2zqE+gujh2Npewjp1Nl0bSmae5UJ9AbfBZay5Re8plZA11/ijOlunM05jiMdOVpx+pE5cdpqy7Ymb6/tYXqE+gyjh2Npew6rPpzjQMjYI11GuUJ7U1tvZkQl1LDtX71z+kEz7/oN6//iF1LTmU+gSqjGNncwmrPpvuTEN/Kq27HunVjRccM+KZ8Oe/YwnX5RrQWE9q4zorUF39qbSuvf8pfeL0ZZqTbNXLqQFde/9T+tQf/d981hpQWPXZdC0hk3Xd8KPtuuFH20fMf//xi+sSDyaH66xAbWSyrnu37tS9W3eOmP/3py2rU0SYjLDqMzKXJ8xsu5n9ysweMbOeStfDACXNhfoEaoPPWnOZKoM7/aG7vzSZFYT1ZC/UR3syoe9c+g7tT2eVybriMVNbIqYZLVFrukBja08m9M3Vxymd8eEHHCXixrGzQUX1KZeR9LqiJ3slqvBkL9TP714+MKrhL21vyqYL1NUrqcyoz9q86dPqHRYqFMZ3YZSOvC7pXjNzSTe4+7pKVtKfSuv96x9mgJImQUdIoDb4rDWXsL4Lo9QS3uXuz5vZPEn3mdkT7v7DwgJmtkbSGklatGhRyZXQca65NEp9BmmbQL1w7Jx6mn5wJ3d/Pv9zp5l9W9Kxkn5YVGadpHWS1N3dXXLP4zHTo1eepD2pg9fAZyVj2pPKhrwHCEM8Zrro3Yt1dveiEbfQRq1zVpC2CdRL0GMnA6k1j3jM9MtPnaS9+w9+F85si2nv/sl9F0YiaTCzGZJi7r4n//t7JV1Vybrakwk93b+vxDXwGVWNGbXRnkzo9KM6teqmzXRsBUJUOJAan7XGF9Z3YVRuuZwv6cdm9ktJP5N0t7t/r5IVjXVdrj+Vrl60qBnqE6gNPmvNJaz6jMSZBnd/RtIfVGNdXJdrLtQnUBt81ppLWPUZlTMNVcMAJc2F+gRqg89ac5kqgztNWnsyoX//0NuVzrgGs66WmCkRN81uba13aKhAezKhm1Ydox27UpqeaNFr6UEtPCTJdVagytqTCd1wXpcuuuXgNfAbzqNPQ6MKa2C8pksaJOnFV9OjOn/MbidpaFT7B7L6xHd+PVyfa1d21TskoCkl4jF95sy3DCfoiXjTnYyeUsIYGK/pWgSdeZpLfyqti4vq82LqE6i6/lRaq27crFU3bdY56x7Sqps2a9WNm/msNaiwvgubLmmgM09zoT6B2uCz1lyafnCnaonHTO9dNk9ndS0cfob4nVt20JmnQVGfQG00ykBqCCasY2fTJQ3tyYQuO+nNPOWySVCfQG0wkFpzCevY2XSXJ+jT0FyoT6A2+Kw1F/o0BMR1ueZCfQK1wWetuTC4U0AMUNJcqE+gNvisNRcGdwqoPZnQPZe/Qy8XPOVyTjKmlubb1SmBAWeA2mAgteYS1kCHTflN+kx/9Qe0QP0w4AxQGwyk1lzCGOiw6Y6+dOZpLgw4A9QGA6k1FzpCBkRnnuZCfQK1wWetuTT94E5mtlzSv0pqkfQVd7+6kvUMdf4o/GPRmadxUZ/hW3zF3WWV3371aSFFgnris9ZcwqrPSCQNZtYi6TpJp0jqlbTZzDa6+9Zy10VnnubSnkzo+pVdDO4EhKw9mdDalV3DlyiG+jTwWWtM7cmEvrn6OKUzrphJWZcScZt0fUYiaZB0rKRt7v6MJJnZrZLOlFR20iDRmaeZtLXFtbR9hm5bc/zw3TDtyYTa2qLSdIHm0dY6stNxW2vTXcGeUl5JZUb9wzVv+rRJrTMqR94FknYUTPdKOq6SFY3Vmee2NcdrAV80DamtLU7dASHrT6V1wY2bR53O5tjZmMbqCDnZ+myoNNLM1phZj5n19PX1lSxDZx7UQ5C2CdQLx86pp9lHhHxe0sKC6c78vBHcfZ27d7t7d0dHR8kVMaoZ6iFI2wTqhWPn1BNWfUYladgsaamZLTGzhKRzJW2sZEVDHeeG/lh0nAOAiXHsbC5h1WckLlS5e8bMLpV0j3K3XH7N3R+rZF10nAOA8nHsbC5h1WdkWoO7b5K0qRrrouMcAJSPY2dzCaM+o3J5AgAARBxJAwAACITzUADKUs6w0ww5DTQXkgYAoeG5FkBzMffGHLjDzPokPTtBsUMlvVSDcOqN/TzoJXdfXotgxtJkbbMR4myEGKVcnE/QPiOF/Two0LGzYZOGIMysx9276x1H2NjPxtMo+9IIcTZCjFLjxCk1VqyTwX6Wj46QAAAgEJIGAAAQSLMnDevqHUCNsJ+Np1H2pRHibIQYpcaJU2qsWCeD/SxTU/dpAAAA1dPsZxoAAECVkDQAAIBASBoAAEAgJA0AACAQkgYAABAISQMAAAiEpAEAAARC0gAAAAIhaQAAAIGQNAAAgEBIGgAAQCAkDQAAIBCSBgAAEAhJAwAACISkAQAABNKwScPy5ctdEi9exa+6o23yGudVd7RPXmO8AmnYpOGll16qdwhASbRNRBntE5PRsEkDAACoLZIGAAAQCEkDAAAIhKQBAAAEEg97A2b2NUmnS9rp7m8p8b5J+ldJ75P0mqQL3P3nk9nm/v0Z9afSymRd8ZipPZlQW1vou4qQNFN9ltqX4mlJE5aZ7HQttlGNbe7aP6CBwaxaW2I6pK11xPuHTk/o1fSg0plBJeItap+RUCxm4/79M5msdu49MLzOeTOnKR6f3P9O2ayrf1+6rDiARlWLI+9Nkr4k6eYx3j9V0tL86zhJ1+d/VmT//oye7t+nSzZsUe/ulDrnJnX9yi4tbZ/RsF80U1kz1edY+3LXI7264Ufbh6fnz07onHUPjShz7f1P6d6tO4end+9N6fwbtwxPLzpkmv7g0/froncv1ulHdQ5v473L5umyk948YptrV3ZpWmtMq27crN7dqVHLDK1ze9+ruuzWR4en45bVqdf8dFTcV55+pLqWHDpq+eKYFx0ybXi/xtrmlt++pCvvemJ4ekardOIXfzxqm6X2a/353Tpi/qwxv7AzmayeeHGPLi76Wxw5f1bFiUM263ryxT1afXNP4DiAalh8xd2By26/+rSqbTf0yxPu/kNJu8Ypcqakmz3nIUlzzOywSrfXn0oPH0gkqXd3Spds2KL+VLrSVaKOmqk+x9qXs7sXjZhOZ3xUmbO6Fo6YfuO82SOm9+7PSpLO7l40YhtndS0ctc2LN2xR767U8LziZYbWefQb2kdMz05OKxn3icsOK7l8ccx792cn3OaJyw4bMT2ttbXkNkvt1+qbe9S/b+x2sXPvgeGEofBvsXPvgcB1WKx/X3o4YQgaB9DIotCnYYGkHQXTvfl5o5jZGjPrMbOevr6+kivLZA8ecIdXuDulTDbw2BWIkEapz8m0zZaC/0h7d6c0WLRvvbtTmpNsHTFduP+F0y0xG7GNOcnWktucnmgZni5eplQcpbY5FHfWS+/XeDGPtU33YNsca7/SmUGNZWAwW7otDWbHXGYi6cxg2XHUQ5D2CQQRhaQhMHdf5+7d7t7d0dFRskw8Zuqcmxwxr3NuUnFOFTakRqnPybTNwi/nzrnJEUnE0LyXUwMjpgv3v3B6MOsjtvFyaqDkNl9LH/xSK16mVByltjkUd8xK79d4MY+1zVwXp4m3OdZ+JeItGktrS6x0W2qp/DCYiLeUHUc9BGmfQBBRSBqel7SwYLozP68i7cmErl/ZNfxBHroWOtQRC42lmepzrH25o+e5EdOJuI0qc+eWHSOmf7Pz1RHTM9tyH+U7ep4bsY07t+wYtc21K7vUeUhyeF7xMkPr/MWz/SOmX00dKBn397e+UHL54phntsUm3Ob3t74wYvrAwEDJbZbar/Xnd6t9xtjtYt7Mabl9L/pbzJs5LXAdFmufkdD687vLigNoZFZ4OjC0jZgtlnTXGHdPnCbpUuXunjhO0jXufuxE6+zu7vaenp6S7zVTb3uUXZ91PwVRbtvk7onx757IDGYVr/LdE0PrrMPdE5Fun2gcIXSEDNQ2a3HL5bcknSDpUDPrlfQpSa2S5O5rJW1SLmHYptwtl6smu822trgWkCQ0jWaqz1L7UmrfJioz2elabKMa23z9BO93TCuvXcTjMb1+TnLigmWIxUwdsyo/WwE0ktCPxO6+YoL3XdKHw44DAABMThT6NAAAgAZA0gAAAAIhaQAAAIGQNAAAgEBIGgAAQCAkDQAAIBCSBgAAEAhJAwAACISkAQAABELSAAAAAiFpAAAAgZA0AACAQEgaAABAICQNAAAgEJIGAAAQCEkDAAAIpCZJg5ktN7MnzWybmV1R4v1FZvaAmf3CzB41s/fVIi4AABBc6EmDmbVIuk7SqZKWSVphZsuKin1c0u3ufrSkcyV9Oey4AABAeWpxpuFYSdvc/Rl3T0u6VdKZRWVc0uz876+T9LsaxAUAAMoQr8E2FkjaUTDdK+m4ojJXSrrXzC6TNEPSyTWICwAAlCEqHSFXSLrJ3TslvU/SLWY2KjYzW2NmPWbW09fXV/MggbHQNhFltE9US+CkwcwuM7O5FWzjeUkLC6Y78/MKXSjpdkly9/+S1Cbp0OIVufs6d+929+6Ojo4KQgHCQdtElNE+US3lnGmYL2mzmd2evxvCAi63WdJSM1tiZgnlOjpuLCrznKSTJMnMfk+5pIF0GACACAmcNLj7xyUtlfRVSRdIetrM/snM3jjBchlJl0q6R9Ljyt0l8ZiZXWVmZ+SLfVTSajP7paRvSbrA3b3svQEAAKEpqyOku7uZ/bek/5aUkTRX0h1mdp+7/804y22StKlo3icLft8q6Z3lxAIAAGorcNJgZpdLOl/SS5K+Iumv3X0g32HxaUljJg0AAKDxlXOmYa6kP3X3ZwtnunvWzE6vblgAACBqAvVpyI/qeG5xwjDE3R+valQAACByAiUN7j4o6UkzWxRyPAAAIKLKvTzxmJn9TNK+oZnufsbYiwAAgGZRTtLwidCiAAAAkRc4aXD3H5jZGyQtdff/NLPpklrCCw0AAERJOcNIr5Z0h6Qb8rMWSPqPMIICAADRU84w0h9WbgCmVyXJ3Z+WNC+MoAAAQPSUkzQccPf00ISZxSUx1DMAAFNEOUnDD8zs7yQlzewUSf8m6f+EExYAAIiacpKGK5R78uSvJF2k3LMkPh5GUAAAIHrKueXyjyXd7O7rwwoGAABEVzlnGv5I0lNmdouZnZ7v0wAAAKaIwEmDu6+S9Cbl+jKskPQbM/tKWIEBAIBoKetsQf5R2N9V7q6JpHKXLP5XGIEBAIBoKWdwp1PN7CZJT0s6S9JXJP1fIcUFAAAippw+DecrNwLkEe5+gbtvcvfMRAuZ2XIze9LMtpnZFWOU+XMz22pmj5nZN8uICQAA1Eg5z55YUe7KzaxF0nWSTpHUK2mzmW10960FZZZK+ltJ73T33WbGKJMAAETQhGcazOzH+Z97zOzV4p8TLH6spG3u/kx+NMlbJZ1ZVGa1pOvcfbckufvO8ncDAACEbcIzDe7+rvzPWRWsf4GkHQXTvZKOKyrzZkkys58o99TMK939exVsCwAAhGjCpMHMDhnvfXffVYUYlko6QVKnpB+a2e+7+8slYlkjaY0kLVq0aJKbBaqHtokoo32iWoL0adii3C2WVuI9l3T4OMs+L2lhwXRnfl6hXkkPu/uApN+a2VPKJRGbR23MfZ2kdZLU3d3Nw7IQGbRNRBntE9US5PLEkkmsf7OkpWa2RLlk4VxJ7y8q8x/KDRZ1o5kdqtzlimcmsU0AABCCcsZpMDNbaWafyE8vMrNjx1smf0vmpZLukfS4pNvd/TEzu8rMzsgXu0dSv5ltlfSApL929/5KdgYAAISnnBEhvywpK+lESZ+RtEfSnZKOGW8hd9+k3BMxC+d9suB3l/SX+RcAAIiocpKG49z9bWb2C0nKj6mQCCkuAAAQMeWMCDmQH6zJJcnMOpQ78wAAAKaAcpKGayR9W9I8M/tHST+W9E+hRAUAACKnnGGkv2FmWySdpNztl3/s7o+HFhkAAIiUcgd32inpW4XvVWFwJwAA0ADKHdxpkaTd+d/nSHpO0mTGcQAAAA1iwj4N7r7E3Q+X9J+S/sjdD3X3dkmnS7o37AABAEA0lNMR8vj8mAuSJHf/rqR3VD8kAAAQReWM0/A7M/u4pA356Q9I+l31QwIAAFFUzpmGFZI6lLvt8t/zv68IIygAABA95dxyuUvS5WO9b2bXuvtlVYkKAABETjlnGibyziquCwAAREw1kwYAANDESBoAAEAg1UwarIrrAgAAERM4aTCz35+gyL9OMhYAABBh5Zxp+LKZ/czMPmRmryt+091vGmtBM1tuZk+a2TYzu2KccmeZmZtZdxlxAQCAGgicNLj7u5Ub0GmhpC1m9k0zO2Wi5cysRdJ1kk6VtEzSCjNbVqLcLOVu6Xw4aEwAAKB2yurT4O5PS/q4pI9Jeo+ka8zsCTP703EWO1bSNnd/xt3Tkm6VdGaJcp+R9FlJ+8uJCQAA1EY5fRreamb/IulxSScq9/Cq38v//i/jLLpA0o6C6d78vMJ1v03SQne/O2g8AACgtso503CtpJ9L+gN3/7C7/1yS3P13yp19qIiZxSR9UdJHA5RdY2Y9ZtbT19dX6SaBqqNtIspon6iWcpKGb7v7Le6eGpphZpdLkrvfMs5yzyvXD2JIZ37ekFmS3iLpQTPbLul4SRtLdYZ093Xu3u3u3R0dHWWEDoSLtokoo32iWspJGs4vMe+CAMttlrTUzJaYWULSuZI2Dr3p7q+4+6HuvtjdF0t6SNIZ7t5TRmwAACBkEz6wysxWSHq/pCVmtrHgrVmSdk20vLtnzOxSSfdIapH0NXd/zMyuktTj7hvHXwMAAIiCIE+5/KmkFyQdKukLBfP3SHo0yEbcfZOkTUXzPjlG2ROCrBMAANTWhEmDuz8r6VlJbw8/HAAAEFVBLk/82N3fZWZ7JHnhW5Lc3WeHFh0AAIiMIGca3pX/OSv8cAAAQFQFOdNwyHjvu/uEnSEBAEDjC9IRcotylyVKPfraJR1e1YgAAEAkBbk8saQWgQAAgGgLcnniSHd/Iv98iFGGhpMGAADNLcjlib+UtEYjx2gY4so9sAoAADS5IJcn1uR//mH44QAAgKgq59HYHzazOQXTc83sQ+GEBQAAoqacB1atdveXhybcfbek1dUPCQAARFE5SUOLmQ3fdmlmLZIS1Q8JAABEUZCOkEO+J+k2M7shP31Rfh4AAJgCykkaPqZconBJfvo+SV+pekQAACCSAicN7p6VdH3+BQAAppjASYOZLZX0vyUtk9Q2NN/dGUYaAIApoJyOkDcqd5YhI+kPJd0saUMYQQEAgOgpJ2lIuvv9kszdn3X3KyWdNtFCZrbczJ40s21mdkWJ9//SzLaa2aNmdr+ZvaGMmAAAQI2UkzQcMLOYpKfN7FIz+xNJM8dbIH9b5nWSTlXussYKM1tWVOwXkrrd/a2S7pD0uTJiAgAANTJh0mBmt+R//Q9J0yV9RFKXpPMkfXCCxY+VtM3dn3H3tKRbJZ1ZWMDdH3D31/KTD0nqDB4+AAColSAdIbvM7PWSPiBpvaTXJH004PoXSNpRMN0r6bhxyl8o6bsB1w0AAGooSNKwVtL9kg6XtEWSKfd0y6GfVbl7wsxWSuqW9J5xyqxR7ombWrRoUTU2C1QFbRNRRvtEtUx4ecLdr3H335P0NXc/3N2XFP6cYPHnJS0smO7MzxvBzE6W9PeSznD3A+PEss7du929u6OjY6LQgZqhbSLKaJ+olsAdId39kolLjbJZ0lIzW2JmCUnnStpYWMDMjpZ0g3IJw84KtgEAAGqgnLsnyubuGUmXSrpH0uOSbnf3x8zsKjM7I1/s88rdhfFvZvaImW0cY3UAAKCOynn2REXcfZOkTUXzPlnw+8lhxwAAACYv1DMNAACgeZA0AACAQEgaAABAICQNAAAgEJIGAAAQCEkDAAAIhKQBAAAEQtIAAAACCX1wJwBAY1l8xd2By26/+rQQI0HUcKYBAAAEQtIAAAACIWkAAACBkDQAAIBASBoAAEAgJA0AACAQkgYAABAISQMAAAikJoM7mdlySf8qqUXSV9z96qL3p0m6WVKXpH5J57j79kq3t39/Rv2ptDJZVzxmak8m1NbGOFaNqpnqs9S+FE9LmrDMZKdrsY0g2yysx0wmq517D2hgMKvWlpjmzZymeJz/a4AoCf3Ia2Ytkq6TdIqkXkmbzWyju28tKHahpN3u/iYzO1fSZyWdU8n29u/P6On+fbpkwxb17k6pc25S16/s0tL2GQ37RTOVNVN9Fu/Le5fN02UnvXnEvq1d2aW21pguuHHziP2965Fe3fCj7SWXuX5ll7b89iVdedcTgcrfuOoYpTNZXXTLyHVce/9TunfrzlHruPL0I9W15NBR24xbVqde89Ph6YGBAf3p2odLbvObq4/TK6nMmPWYyWT1xIt7dHHR3+LI+bNIHIAIqcWn8VhJ29z9GXdPS7pV0plFZc6U9PX873dIOsnMrJKN9afSwwcmSerdndIlG7aoP5WuLHrUVTPVZ/G+nNW1cNS+Xbxhi3bsSo3a37O7F425zCUbtujEZYcFLt+7KzWcMBQuc1bXwpLrOHHZYSW3OTs5bcT0/MmaygEAAA2PSURBVNdNH3Ob6YyPW4879x4YThgK/xY79x6oZhUAmKRaJA0LJO0omO7NzytZxt0zkl6R1F68IjNbY2Y9ZtbT19dXcmOZrA8feIY3uDulTNYr3gHUT6PUZyVtc06yteS+TU+0jJrXErNxl3H3wOWnJ1pKrmNOsrXkOrI+cR0UTpfaZsw07joGBrOl3x/MCpMXpH0CQTTUeT93X+fu3e7e3dHRUbJMPGbqnJscMa9zblLxWEUnLlBnjVKf/397Zx5sRXHF4e8Hj63UgIA7lojRGJIYF5IYE40V3KIViYrGXVwqLsQlVUk0pbHUVMotWkaNYgqJmDKKoFZIXFFBjAvwWMQHbihEY4goirsiz5M/uh9vuMx9d952Z+71fFVTt7fpPj1z7rlnuvtOd0Q3V338WWrfPlrdvF5ac/xxLXdOcmCuUvmPVjen1rHq489S6+ihyvcgGU9r83OjzTp69eyRnt+zpkxUYcmin46ThWp8I18Htk7Eh8S01DKSGoD+hAWR7WZQv97ceOxuaw1Qy9xpy0Isp7aop/tZ2pe75r62Xt/GHbsbWw/st15/pzS+WvacG4/djUcXL89cfsjAftx03Pp13DX3tdQ6Hl28PLXN9z7+dJ34G+9+VLbN3g1q8z5uumEfxqVci0037NOVt8BxnE6i5LBmtzQQnIAXgZEE52AOcLSZLUqUGQt8w8xOiwshDzWzI9qqd8SIEdbY2JiaV0+r7Z1238/chyDaq5v+74lAy78n1jR/TkP9/nui0PrZgm+NXXy64R5l0s1u/yU1szWSfg48SPjL5QQzWyTpEqDRzKYCNwN/lbQEeBs4sjNt9u3bwFbuJNQN9XQ/0/qS1rdKZTobr0YbWdpM0tDQgy0H9Cub7zhO/lTFEpvZfcB9JWkXJsKfAIdXQxbHcRzHcTpG3Y39OY7jOI7TPbjT4DiO4zhOJtxpcBzHcRwnE+40OI7jOI6TiW7/y2V3IelN4N8Vig0G3qqCOHnj/WzlLTM7oBrClKPOdLMW5KwFGSHI+bzrZ6HwfraSyXbWrNOQBUmNZjYibzm6G+9n7VErfakFOWtBRqgdOaG2ZO0M3s/249MTjuM4juNkwp0Gx3Ecx3EyUe9Ow5/zFqBKeD9rj1rpSy3IWQsyQu3ICbUla2fwfraTul7T4DiO4zhO11HvIw2O4ziO43QRdeE0SDpA0guSlkg6LyW/j6RJMX+WpKHVl7LzZOjnGElvSloQj1PykLMzSJogaYWkpjL5knRtvAYLJe1abRk7S6X7mBdp117SQEnTJL0UPzfOWcatJU2XtFjSIklnF01OSX0lzZb0TJTx4pi+bbQ/S6I9yn1/d7eda/PddmbFzGr6IOyc+TIwDOgNPAMMLylzBjAuho8EJuUtdzf1cwxwfd6ydrKfewG7Ak1l8g8E7ids47o7MCtvmbv6Phbp2gNXAOfF8HnA5TnLuAWwawxvBLwIDC+SnFE3N4zhXsCsqKt3AkfG9HHA6TlfS7edrWXcdmY86mGk4dvAEjN7xcxWA3cAo0rKjAImxvAUYKSk3Pe1bydZ+lnzmNlMwvbo5RgF3GqBp4EBkraojnRdQmHvY5lrn/zuTAR+UlWhSjCz5WY2L4bfB54DtqJAckbd/CBGe8XDgB8S7A8U4FritrOuqJbtrAenYSvgtUT8PzEttYyZrQHeBQZVRbquI0s/AQ6LQ09TJG1dHdGqStbrUFRqTf7NzGx5DP8P2CxPYZLEofJdCE/yhZJTUk9JC4AVwDTCk+6qaH+gGPfdbee6uO3MQD04DU4r/wCGmtlOBEM1sUJ5x8mMhTHOQvzdStKGwF3AOWb2XjKvCHKaWbOZ7QwMITzp7pinPE5F3HZmpB6chteBpFc4JKallpHUAPQHVlZFuq6jYj/NbKWZfRqj44HdqiRbNclyv4tMrcn/RssQZvxckbM8SOpFcBhuM7O7Y3Lh5AQws1XAdOC7hOHghphVhPvutjPitjM79eA0zAG2jyuTexMW60wtKTMVOCGGRwOPxqeRWqJiP0vmpw4mzPfWG1OB4+NK4N2BdxPD0rVAFn0tEsnvzgnA33OUhTiffjPwnJldncgqjJySNpE0IIb7AfsSvovTCfYHCnAtcdu5Fred7SDvFZ9dtGr0QMIq6peB82PaJcDBMdwXmAwsAWYDw/KWuZv6eSmwiLA6eDqwY94yd6CPtwPLgc8Ic24nA6cBp8V8AX+K1+BZYETeMnfFfSzCUebaDwIeAV4CHgYG5izj9wlTDwuBBfE4sEhyAjsB86OMTcCFMX1YtD9Loj3qU4B77rbT3Ha25/A3QjqO4ziOk4l6mJ5wHMdxHKcKuNPgOI7jOE4m3GlwHMdxHCcT7jQ4juM4jpMJdxocx3Ecx8mEOw2O4ziO42TCnYY6Jb5gZpak+ZL27Ib6x0i6vqvrdfJD0paSplQo82T8HCrp6OpIVlaWAZLOyFMGJxuSzpL0nKTb2nneeEnDY3iZpMEx3OV6mKw/S5kWGb5ouNNQUCT17GSZkcCzZraLmT3ekTYTr7x1vgCY2X/NbHSFMnvE4FAgV6cBGEDYutkpPmcA+5rZMe05ycxOMbPFKem562FChg5TizbWnYYuQtKxkmZLWiDpJkljJV2ZyF/7ZJ5StmdM/0DSVZKeIbyrPq2dZZIulzQPOFzSdpIekDRX0uOSdpS0M3AFMCq20U/SfpKekjRP0uS44U9afTMkXSOpEThb0o8TIxYPSyrMLodOx5F0maSxifhFkn4pqSnGv5bQ0YWSto/pLVs+XwbsGfN/UaaNnpL+IKkp1nFmTB8Z9elZSRMk9Ynpyae4EZJmJGSbEHXzFUlnJWTYLspwZYoITgGQNI7wNsz7JZ0b7dB8SU9K+kosU05XZkgakVJnqh5KmhntX0u5f0n6Zhm5Bkl6SNIiSeMJb0xsyUu10WkySLpD0kGJ9FskjY59ulLSnNinU2P+3tFWTwUWS7pE0jmJ838v6ezsV7jK5P3qy3o4gK8SdknrFeM3EN7XviRR5n7CK3DTyh4fwwYcUaGtZcCvE/FHgO1j+DuEd8MDjAGuj+HBwExggxg/l9ZX25bWNwO4IRHfGNa+OfQU4KrS+v2ovYOwpfRjifhiYE+gKcavA46J4d5Avxj+IH7uDfyzQhunA1OAhhgfSHgt8WvADjHtVsJOlS26ODiGRwAzYvgi4EmgT9TllUAvwlNmU97X0o9M+rYs3rsvJfRhH+CucroSP2cQX3dcoh+pekiwu9fE8A5AYxsyXZuwgwcR7O9g2rbRaTIcAkyM4d5Rv/sBPwMuiOl9gEZg2yjzh8C2MW8oMC+GexBe8zwo73tW7qi5oZGCMpKwK9ocSRAUZgXwisLGIC8RtsZ9AhhbpixAM2H3vkpMgrXbA+8BTI51QVDOUnYHhgNPxHK9gadK6ysTHwJMUtjQpTewNIN8TsExs/mSNpW0JbAJ8A7B2LXwFHC+pCHA3Wb2Ugea2QcYZ2ZrYptvx6e+pWb2YiwzkfCduKZCXfda2IXwU0krAB/xqk36AxPjyJURnD9I0ZUO1j8Z+K2kXwEnAbe0UXYv4NDY3r2S3onp5ex5Oe4H/hhHzA4AZprZx5L2A3aS1DLl1x/YHlgNzDazpbHtZZJWStqFoNfzzaywO4m609A1iOBp/madROkk4AjgeeAeMzMFLVyvbOQTM2vO0N6H8bMHsMrMdm6rcJRvmpkdVaG+tPh1wNVmNlXS3oSnPqc+mEzYuXBzShxHM/ubpFmEJ7D7JJ1qZo92szxraJ0y7VuS92ki3Izbrlrld8B0MztE0lDCSEKXYWYfSZoGjCLY3o5scd2WjU5r85M4lbY/8FPgjkQ9Z5rZg+tUHuxoqc0dTxi93RyY0AGZq4avaegaHgFGS9oUQNJASdsA9xCU9yhaFalc2XZjZu8BSyUdHutSmfm7p4HvSfpyLLeBpB0yNtOf1j3XT2iroFNzTCJsEzya4ECsRdIw4BUzu5awhfNOJee+D2xUof5pwKmKi70kDQReAIa26CJwHPBYDC+j1cgflkH+LDI4xSJpT8Yk0tN0JQtpOjCeMPUwx8zeWf+UtcwkLqKU9CPCVCx0zEZPAk4kTPE9ENMeBE6X1CvWs4OkDcqcfw9hlOJb8bzC4k5DF2Bhde8FwEOSFhK+AFtEhX0O2MbMZrdVthPNHwOcrLB4chHBSSmV703CF/T22OZThOmSLFxEmP6YC7zVCTmdgmFmiwgG93UzW16SfQTQJGkB8HXC2oMkC4FmSc+ozEJIgvF+FVgY9fNoM/uEYFwnS3oW+BwYF8tfTBjmbSSMJlSSfyVhyq3JF0LWDFcAl0qaz7qjRevpSsb61tNDM5sLvAf8pcK5FwN7SVpEmKZ4NZ7fERv9EPAD4GEzW53o02JgnsIC45soM0IWz5kO3JlxtDk3fGtsx3Ecp26I63RmADua2ec5i5MJST2AecDhHVw/VDV8pMFxHMepCyQdD8wCzq8hh2E4sAR4pOgOA/hIQ2GRdA/h7zlJzi1dVOM4eSNpf+DykuSlZnZIHvI4ThJJJwKl7z14wszGppV32sadBsdxHMdxMuHTE47jOI7jZMKdBsdxHMdxMuFOg+M4juM4mXCnwXEcx3GcTLjT4DiO4zhOJv4PBZc/oS6libsAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 540x540 with 12 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.pairplot(testing)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 175,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<seaborn.axisgrid.FacetGrid at 0x146155780>"
      ]
     },
     "execution_count": 175,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.catplot(x='facility_delivery', y='visit_count', data=testing)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 0])"
      ]
     },
     "execution_count": 176,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_subset_floor_fuel_edu_wat['facility_delivery'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 1,  0,  3,  4,  6,  7,  2, 11,  8,  9, 10,  5, 12, 13, 14, 19, 17,\n",
       "       15, 23, 18, 16, 20, 28])"
      ]
     },
     "execution_count": 177,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_subset_floor_fuel_edu_wat['visit_count'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432.5x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.catplot(x=\"facility_delivery\", y=\"visit_count\", hue=\"ever_referral\", kind=\"bar\", data=testing);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's try rescaling our data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sklearn/preprocessing/data.py:334: DataConversionWarning: Data with input dtype int64 were all converted to float64 by MinMaxScaler.\n",
      "  return self.partial_fit(X, y)\n"
     ]
    }
   ],
   "source": [
    "from sklearn.preprocessing import MinMaxScaler\n",
    "\n",
    "scaler = MinMaxScaler(feature_range=(0, 1))\n",
    "rescaledX = scaler.fit_transform(X_simple)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.        , 0.03571429],\n",
       "       [0.        , 0.        ],\n",
       "       [0.        , 0.10714286],\n",
       "       ...,\n",
       "       [0.        , 0.        ],\n",
       "       [0.        , 0.03571429],\n",
       "       [0.        , 0.        ]])"
      ]
     },
     "execution_count": 180,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rescaledX"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    rescaledX, y1, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.8629161474096493\n",
      "confusion matrix: [[   0  770]\n",
      " [   0 4847]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.8629161474096493\n",
      "f1_score is 0.926414373088685\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Nope"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "How about normalizing X?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import Normalizer\n",
    "scaler = Normalizer().fit(X_simple)\n",
    "normalizedX = scaler.transform(X_simple)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.8629161474096493\n",
      "confusion matrix: [[   0  770]\n",
      " [   0 4847]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.8629161474096493\n",
      "f1_score is 0.926414373088685\n"
     ]
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    normalizedX, y1, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.8629161474096493\n",
      "confusion matrix: [[   0  770]\n",
      " [   0 4847]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.8629161474096493\n",
      "f1_score is 0.926414373088685\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Hmmm......Try Only Visit Predictor:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X_visit, y1, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")\n",
    "\n",
    "#Check the number of positive and negative responses in"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.8629161474096493\n",
      "confusion matrix: [[   0  770]\n",
      " [   0 4847]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.8629161474096493\n",
      "f1_score is 0.926414373088685\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Still not working..."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Kitchen Sink Logistic Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X, y1, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")\n",
    "\n",
    "#Check the number of positive and negative responses in"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.13708385259035072\n",
      "confusion matrix: [[ 770    0]\n",
      " [4847    0]]\n",
      "recall_score is 0.0\n",
      "precision_score is 0.0\n",
      "f1_score is 0.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples.\n",
      "  'precision', 'predicted', average, warn_for)\n",
      "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 due to no predicted samples.\n",
      "  'precision', 'predicted', average, warn_for)\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Still Trying"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_attempt = df_subset_floor_fuel_edu_wat[['pregnancy_patient_age_in_years','has_mosquito_net', 'latrine',\n",
    "       'hand_washing_facilities', 'electricity', 'television', 'cupboard',\n",
    "       'dvd', 'radio', 'clock', 'walls', 'roof', 'toilet', 'wealth_quintile', 'household_size',\n",
    "       'floor_1', 'floor_2', 'fuel_1', 'fuel_2', 'education_1', 'education_2',\n",
    "       'education_3', 'education_4', 'education_5', 'education_6', 'water_1',\n",
    "       'water_2', 'water_3']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X_attempt, y1, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")\n",
    "\n",
    "#Check the number of positive and negative responses in"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:758: ConvergenceWarning: lbfgs failed to converge. Increase the number of iterations.\n",
      "  \"of iterations.\", ConvergenceWarning)\n"
     ]
    }
   ],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's try a tree for the heck of it"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Tree Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X_simple, y1, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn import tree\n",
    "\n",
    "model = tree.DecisionTreeClassifier(criterion='gini') # for classification, here you can change the algorithm as gini or entropy (information gain) by default it is gini  \n",
    "# model = tree.DecisionTreeRegressor() for regression\n",
    "# Train the model using the training sets and check score\n",
    "model.fit(X_train, y_train)\n",
    "model.score(X_train, y_train)\n",
    "#Predict Output\n",
    "y_pred = model.predict(X_test)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 196,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.8629161474096493\n",
      "confusion matrix: [[   0  770]\n",
      " [   0 4847]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.8629161474096493\n",
      "f1_score is 0.926414373088685\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Nope..."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's Try another response variable"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "delivery_first_visit_on_time\n",
      "0      955\n",
      "1    15896\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X_simple, y2, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")\n",
    "\n",
    "#Check the number of positive and negative responses in the response variable \n",
    "print(y_train.groupby('delivery_first_visit_on_time').size())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Optimization terminated successfully.\n",
      "         Current function value: 0.330079\n",
      "         Iterations 7\n",
      "                                Logit Regression Results                                \n",
      "========================================================================================\n",
      "Dep. Variable:     delivery_first_visit_on_time   No. Observations:                16851\n",
      "Model:                                    Logit   Df Residuals:                    16849\n",
      "Method:                                     MLE   Df Model:                            1\n",
      "Date:                          Tue, 16 Apr 2019   Pseudo R-squ.:                 -0.5161\n",
      "Time:                                  16:49:22   Log-Likelihood:                -5562.2\n",
      "converged:                                 True   LL-Null:                       -3668.7\n",
      "                                                  LLR p-value:                     1.000\n",
      "=================================================================================\n",
      "                    coef    std err          z      P>|z|      [0.025      0.975]\n",
      "---------------------------------------------------------------------------------\n",
      "ever_referral    -0.3578      0.103     -3.470      0.001      -0.560      -0.156\n",
      "visit_count       0.7522      0.012     64.910      0.000       0.729       0.775\n",
      "=================================================================================\n"
     ]
    }
   ],
   "source": [
    "import statsmodels.api as sm\n",
    "\n",
    "logit = sm.Logit(y_train, X_train)\n",
    "\n",
    "# fit the model\n",
    "result = logit.fit()\n",
    "print(result.summary())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 199,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 200,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.9451664589638598\n",
      "confusion matrix: [[   0  308]\n",
      " [   0 5309]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.9451664589638598\n",
      "f1_score is 0.9718103606077247\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Booooooooo"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 201,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "#Split data\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X_attempt, y2, test_size=0.25, random_state=1234 #for reproducibility\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 202,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:758: ConvergenceWarning: lbfgs failed to converge. Increase the number of iterations.\n",
      "  \"of iterations.\", ConvergenceWarning)\n"
     ]
    }
   ],
   "source": [
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "model = LogisticRegression(solver='lbfgs')\n",
    "model.fit(X_train, y_train.values.ravel())\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 203,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy_score is :0.9451664589638598\n",
      "confusion matrix: [[   0  308]\n",
      " [   0 5309]]\n",
      "recall_score is 1.0\n",
      "precision_score is 0.9451664589638598\n",
      "f1_score is 0.9718103606077247\n"
     ]
    }
   ],
   "source": [
    "# evaluate accuracy: fraction of samples correctly predicted\n",
    "#not the best for rare events\n",
    "from sklearn.metrics import accuracy_score\n",
    "print('accuracy_score is :' + str(accuracy_score(y_test, y_pred)))\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "print('confusion matrix: ' + str(confusion_matrix(y_test, y_pred)))\n",
    "\n",
    "#the fraction of positives events that you predicted correctly\n",
    "from sklearn.metrics import recall_score\n",
    "print('recall_score is ' + str(recall_score(y_test, y_pred)))\n",
    "\n",
    "# the fraction of predicted positives events that are actually positive \n",
    "from sklearn.metrics import precision_score\n",
    "print('precision_score is ' + str(precision_score(y_test, y_pred)))\n",
    "\n",
    "#The f1 score is the harmonic mean of recall and precision, with a higher score as a better model.\n",
    "from sklearn.metrics import f1_score\n",
    "print('f1_score is ' + str(f1_score(y_test, y_pred)))\n",
    "#accuracy_score(df.actual_label.values, df.predicted_RF.values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 205,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pregnancy_patient_age_in_years</th>\n",
       "      <th>pregnancy_risk_factor_1</th>\n",
       "      <th>pregnancy_risk_factor_2</th>\n",
       "      <th>pregnancy_risk_factor_3</th>\n",
       "      <th>pregnancy_risk_factor_4</th>\n",
       "      <th>pregnancy_risk_factor_5</th>\n",
       "      <th>pregnancy_risk_factor_6</th>\n",
       "      <th>pregnancy_danger_signs_1</th>\n",
       "      <th>pregnancy_danger_signs_2</th>\n",
       "      <th>pregnancy_danger_signs_3</th>\n",
       "      <th>...</th>\n",
       "      <th>fuel_2</th>\n",
       "      <th>education_1</th>\n",
       "      <th>education_2</th>\n",
       "      <th>education_3</th>\n",
       "      <th>education_4</th>\n",
       "      <th>education_5</th>\n",
       "      <th>education_6</th>\n",
       "      <th>water_1</th>\n",
       "      <th>water_2</th>\n",
       "      <th>water_3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "      <td>22468.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>24.190716</td>\n",
       "      <td>0.112293</td>\n",
       "      <td>0.060397</td>\n",
       "      <td>0.008679</td>\n",
       "      <td>0.021364</td>\n",
       "      <td>0.009347</td>\n",
       "      <td>0.008323</td>\n",
       "      <td>0.058127</td>\n",
       "      <td>0.008724</td>\n",
       "      <td>0.019717</td>\n",
       "      <td>...</td>\n",
       "      <td>0.869058</td>\n",
       "      <td>0.019405</td>\n",
       "      <td>0.095113</td>\n",
       "      <td>0.254584</td>\n",
       "      <td>0.115453</td>\n",
       "      <td>0.348718</td>\n",
       "      <td>0.125690</td>\n",
       "      <td>0.156133</td>\n",
       "      <td>0.057103</td>\n",
       "      <td>0.311421</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>7.365705</td>\n",
       "      <td>0.315734</td>\n",
       "      <td>0.238226</td>\n",
       "      <td>0.092758</td>\n",
       "      <td>0.144597</td>\n",
       "      <td>0.096227</td>\n",
       "      <td>0.090852</td>\n",
       "      <td>0.233989</td>\n",
       "      <td>0.092994</td>\n",
       "      <td>0.139029</td>\n",
       "      <td>...</td>\n",
       "      <td>0.337344</td>\n",
       "      <td>0.137948</td>\n",
       "      <td>0.293378</td>\n",
       "      <td>0.435637</td>\n",
       "      <td>0.319575</td>\n",
       "      <td>0.476575</td>\n",
       "      <td>0.331507</td>\n",
       "      <td>0.362990</td>\n",
       "      <td>0.232045</td>\n",
       "      <td>0.463085</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>20.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>24.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>28.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>50.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8 rows Ã— 46 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       pregnancy_patient_age_in_years  pregnancy_risk_factor_1  \\\n",
       "count                    22468.000000             22468.000000   \n",
       "mean                        24.190716                 0.112293   \n",
       "std                          7.365705                 0.315734   \n",
       "min                          0.000000                 0.000000   \n",
       "25%                         20.000000                 0.000000   \n",
       "50%                         24.000000                 0.000000   \n",
       "75%                         28.000000                 0.000000   \n",
       "max                         50.000000                 1.000000   \n",
       "\n",
       "       pregnancy_risk_factor_2  pregnancy_risk_factor_3  \\\n",
       "count             22468.000000             22468.000000   \n",
       "mean                  0.060397                 0.008679   \n",
       "std                   0.238226                 0.092758   \n",
       "min                   0.000000                 0.000000   \n",
       "25%                   0.000000                 0.000000   \n",
       "50%                   0.000000                 0.000000   \n",
       "75%                   0.000000                 0.000000   \n",
       "max                   1.000000                 1.000000   \n",
       "\n",
       "       pregnancy_risk_factor_4  pregnancy_risk_factor_5  \\\n",
       "count             22468.000000             22468.000000   \n",
       "mean                  0.021364                 0.009347   \n",
       "std                   0.144597                 0.096227   \n",
       "min                   0.000000                 0.000000   \n",
       "25%                   0.000000                 0.000000   \n",
       "50%                   0.000000                 0.000000   \n",
       "75%                   0.000000                 0.000000   \n",
       "max                   1.000000                 1.000000   \n",
       "\n",
       "       pregnancy_risk_factor_6  pregnancy_danger_signs_1  \\\n",
       "count             22468.000000              22468.000000   \n",
       "mean                  0.008323                  0.058127   \n",
       "std                   0.090852                  0.233989   \n",
       "min                   0.000000                  0.000000   \n",
       "25%                   0.000000                  0.000000   \n",
       "50%                   0.000000                  0.000000   \n",
       "75%                   0.000000                  0.000000   \n",
       "max                   1.000000                  1.000000   \n",
       "\n",
       "       pregnancy_danger_signs_2  pregnancy_danger_signs_3  ...        fuel_2  \\\n",
       "count              22468.000000              22468.000000  ...  22468.000000   \n",
       "mean                   0.008724                  0.019717  ...      0.869058   \n",
       "std                    0.092994                  0.139029  ...      0.337344   \n",
       "min                    0.000000                  0.000000  ...      0.000000   \n",
       "25%                    0.000000                  0.000000  ...      1.000000   \n",
       "50%                    0.000000                  0.000000  ...      1.000000   \n",
       "75%                    0.000000                  0.000000  ...      1.000000   \n",
       "max                    1.000000                  1.000000  ...      1.000000   \n",
       "\n",
       "        education_1   education_2   education_3   education_4   education_5  \\\n",
       "count  22468.000000  22468.000000  22468.000000  22468.000000  22468.000000   \n",
       "mean       0.019405      0.095113      0.254584      0.115453      0.348718   \n",
       "std        0.137948      0.293378      0.435637      0.319575      0.476575   \n",
       "min        0.000000      0.000000      0.000000      0.000000      0.000000   \n",
       "25%        0.000000      0.000000      0.000000      0.000000      0.000000   \n",
       "50%        0.000000      0.000000      0.000000      0.000000      0.000000   \n",
       "75%        0.000000      0.000000      1.000000      0.000000      1.000000   \n",
       "max        1.000000      1.000000      1.000000      1.000000      1.000000   \n",
       "\n",
       "        education_6       water_1       water_2       water_3  \n",
       "count  22468.000000  22468.000000  22468.000000  22468.000000  \n",
       "mean       0.125690      0.156133      0.057103      0.311421  \n",
       "std        0.331507      0.362990      0.232045      0.463085  \n",
       "min        0.000000      0.000000      0.000000      0.000000  \n",
       "25%        0.000000      0.000000      0.000000      0.000000  \n",
       "50%        0.000000      0.000000      0.000000      0.000000  \n",
       "75%        0.000000      0.000000      0.000000      1.000000  \n",
       "max        1.000000      1.000000      1.000000      1.000000  \n",
       "\n",
       "[8 rows x 46 columns]"
      ]
     },
     "execution_count": 205,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X.describe(include = 'all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 206,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>facility_delivery</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>22468.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>0.866610</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>0.340003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       facility_delivery\n",
       "count       22468.000000\n",
       "mean            0.866610\n",
       "std             0.340003\n",
       "min             0.000000\n",
       "25%             1.000000\n",
       "50%             1.000000\n",
       "75%             1.000000\n",
       "max             1.000000"
      ]
     },
     "execution_count": 206,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y1.describe(include = 'all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
